<?xml version="1.0" encoding="utf-8"?>
<abapGit version="v1.0.0" serializer="LCL_OBJECT_SFPI" serializer_version="v1.0.0">
 <asx:abap version="1.0" xmlns:asx="http://www.sap.com/abapxml">
  <asx:values>
   <VERSION>1</VERSION>
   <TYPE/>
   <INTERFACE href="#o1"/>
   <INTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>S</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>E</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>V</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>1</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>K</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>N</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>G</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>I</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>P</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>H</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>J</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>O</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>F</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>R</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>U</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>L</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>C</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
    <FPINTERFACET>
     <NAME/>
     <STATE/>
     <LANGUAGE>B</LANGUAGE>
     <ID/>
     <TEXT/>
    </FPINTERFACET>
   </INTERFACET>
  </asx:values>
  <asx:heap xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:abap="http://www.sap.com/abapxml/types/built-in" xmlns:cls="http://www.sap.com/abapxml/classes/global" xmlns:dic="http://www.sap.com/abapxml/types/dictionary">
   <cls:CL_FP_INTERFACE_DATA id="o1">
    <CL_FP_INTERFACE_DATA classVersion="1">
     <CODING href="#o5"/>
     <PARAMETERS href="#o4"/>
     <GLOBAL_DEFINITIONS href="#o3"/>
     <REFERENCE_FIELDS href="#o2"/>
     <XSD_DEFINITIONS/>
    </CL_FP_INTERFACE_DATA>
   </cls:CL_FP_INTERFACE_DATA>
   <cls:CL_FP_REFERENCE_FIELDS id="o2">
    <CL_FP_INTERFACE_DATA_CHANGED classVersion="1">
     <INTERFACE_DATA href="#o1"/>
    </CL_FP_INTERFACE_DATA_CHANGED>
    <CL_FP_REFERENCE_FIELDS classVersion="1">
     <REFERENCE_FIELDS/>
    </CL_FP_REFERENCE_FIELDS>
   </cls:CL_FP_REFERENCE_FIELDS>
   <cls:CL_FP_GLOBAL_DEFINITIONS id="o3">
    <CL_FP_INTERFACE_DATA_CHANGED classVersion="1">
     <INTERFACE_DATA href="#o1"/>
    </CL_FP_INTERFACE_DATA_CHANGED>
    <CL_FP_GLOBAL_DEFINITIONS classVersion="1">
     <GLOBAL_DATA>
      <SFPGDATA>
       <NAME>GV_FOOTER</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_EXCHANGE</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_GST</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_FAX</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_TEL</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_RESTOCK</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_VBELN</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>VBELN</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>LV_VBTYP</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>VBTYP</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_SHIPTO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ADDRESS</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_BILLTO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ADDRESS</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_FKART</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>FKART</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_REMITTO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ADDRESS_REMIT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_ADDRESS1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>SZAD_FIELD-ADDR_SHORT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_ADDRESS2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>SZAD_FIELD-ADDR_SHORT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_REMITT</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_REMITT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_CUST</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_CUSTOMER</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_CUST1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_CUSTOMER</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_PURCHASE</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_PURCHASE</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_ITEM</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ITEM</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_ITEM</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ITEM_T</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_VBPA</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>VBPA</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_ADRNR1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>AD_ADDRNUM</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_ADRNR2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>AD_ADDRNUM</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_ADRNR3</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>AD_ADDRNUM</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_ADRNR4</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>AD_ADDRNUM</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_ADRNR5</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>AD_ADDRNUM</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_VBRK</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>VBRK</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_COMPANY</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_REMITT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_VBRP</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>VBRP</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_SALES</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_SALES</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_LIPS</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_LIPS</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_LIPS</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_LIPS_T</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_HEAD</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TDLINE</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_KOMV</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KOMV</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_TAX</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_HC</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_FC</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_DG</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_TOTAL</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_FC_HC</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_SUB1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_SUB</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_ITEM1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ITEM1</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_ITEM1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ITEM1_T</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_LAND</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>LLAND</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_CONTACT</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>Z_MVALUE_HIGH</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_NAME</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TDOBNAME</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_IMAGE_BIN2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>XSTRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>C_BMP2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL>&apos;images/bmp&apos;</DEFAULTVAL>
       <CONSTANT>X</CONSTANT>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_IMAGE_BIN</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>XSTRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>C_BMP</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL>&apos;images/bmp&apos;</DEFAULTVAL>
       <CONSTANT>X</CONSTANT>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_PRODUCTION</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>BOOLEAN</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_STRING1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_STRING2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GWA_STRING</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_HTEXT</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TDLINE</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_PAYMENT_TEXT</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TDOBNAME</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_SHIP_FROM</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR100</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_TAX2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_SUB2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_TOTAL2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_FC2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_HC2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_DG2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_COUNTRY</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>LANDX</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_CUKY</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR7</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_INVOICE</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>VBELN</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_NOTAXIND</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR4</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_LINES</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_LINES</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_FINTOT</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_SHIPTO_ADD</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_BILLTO_ADD</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_REMITTO_ADD</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_SALESORD</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_SALESORD_2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_REFERENCE</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_REFERENCE_2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_TAXSUMM</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_T_TAX</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>I_FEDTAX</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TLINET</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_THEAD</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>THEAD</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_PROMO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_PO_TXT</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_PO_TXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_SOCL</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_SOCL</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_ITEM_LABEL</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_LABEL</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_SALESORD_1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_SALESORD_2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_SALESORD_3</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_REFERENCE_1</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_REFERENCE_2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_STDTXT</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_IC</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_DC</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>KBETR</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_IC2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_DC2</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>CHAR20</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_ADD_DATA</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ADD_DATA</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_ADD_SHIPTO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ADD_DATA</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>WA_ADD_BILLTO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>TY_ADD_DATA</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_GSTREGNO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_FEIN</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_COREGNO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
      <SFPGDATA>
       <NAME>GV_FINAL_REGNO</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>STRING</TYPENAME>
       <DEFAULTVAL/>
       <CONSTANT/>
      </SFPGDATA>
     </GLOBAL_DATA>
     <TYPES>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>************************************************************************</FPCLINE>
      <FPCLINE>* PROGRAM    :  ZOTC0014_INVOICE_FORM_BILLING1                         *</FPCLINE>
      <FPCLINE>* TITLE      :  Invoce Form Billing Driver Program                     *</FPCLINE>
      <FPCLINE>* DEVELOPER  :  NIRAJ SHARMA                                           *</FPCLINE>
      <FPCLINE>* OBJECT TYPE:  Interface (Form)                                       *</FPCLINE>
      <FPCLINE>* SAP RELEASE:  SAP ECC 6.0                                            *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* WRICEF ID:  OTC_FDD_0014_US_Invoice_Form_Billing</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* DESCRIPTION: SHORT DESCRIPTION OF FUNCTIONALITY                      *</FPCLINE>
      <FPCLINE>* Invoice Form Billing Via T-COdes VF31/VF02/VF03                      *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* MODIFICATION HISTORY:                                                *</FPCLINE>
      <FPCLINE>*======================================================================*</FPCLINE>
      <FPCLINE>* DATE        USER      TRANSPORT  DESCRIPTION                         *</FPCLINE>
      <FPCLINE>* =========== ========  ========== ====================================*</FPCLINE>
      <FPCLINE>* 13-MAR-2012 NSHARMA1  E1DK901196 INITIAL DEVELOPMENT                 *</FPCLINE>
      <FPCLINE>* 24-SEP-2014 ADEY      E2DK905111 D2_OTC_FDD_0014 :                   *</FPCLINE>
      <FPCLINE>*                                  Addition of new fields and VAT      *</FPCLINE>
      <FPCLINE>*                                  details for US and Canada           *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 12-JAN-2015 ADEY      E2DK905111 D2_OTC_FDD_0014 : Defect#2022/CR_337*</FPCLINE>
      <FPCLINE>*                                  Additional changes to print billing *</FPCLINE>
      <FPCLINE>*                                  plan dates and No Tax Indicator in  *</FPCLINE>
      <FPCLINE>*                                  layout                              *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 20-FEB-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#3035/CR_482*</FPCLINE>
      <FPCLINE>*                                  1. Remove Ship date from layout     *</FPCLINE>
      <FPCLINE>*                                  2. BOM Component printing based on  *</FPCLINE>
      <FPCLINE>*                                     Distribution Channel and Invoice *</FPCLINE>
      <FPCLINE>*                                     type                             *</FPCLINE>
      <FPCLINE>*                                  3. French translation population    *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 17-MAR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#4850       *</FPCLINE>
      <FPCLINE>*                                  Purchase Order ID mapping changed   *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 17-MAR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : CR_D2_531_532     *</FPCLINE>
      <FPCLINE>*                                  1. Append Header Text of &apos;Z014&apos;     *</FPCLINE>
      <FPCLINE>*                                  2. Append Line Item Text of &apos;Z014&apos;  *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 07-MAY-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5935       *</FPCLINE>
      <FPCLINE>*                                  Unit price and Extended price at    *</FPCLINE>
      <FPCLINE>*                                  item level will be printed from     *</FPCLINE>
      <FPCLINE>*                                  KONV table for &apos;ZNET&apos; condition type*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 05-AUG-2015 PDEBARU E2DK914494   D2_OTC_FDD_0014 : Defect#8835       *</FPCLINE>
      <FPCLINE>*                                  PO BOX to be printed instead of     *</FPCLINE>
      <FPCLINE>*                                  street address in Bill To &amp; Ship To *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 08-Dec-2015 MGARG    E2DK916297  D2_OTC_FDD_0014 : Defect#326 fixed  *</FPCLINE>
      <FPCLINE>*                                  Footer issue,Address adjustment acc *</FPCLINE>
      <FPCLINE>*                                  to envelope,</FPCLINE>
      <FPCLINE>*                                  Added logic for conditiontype &quot;ZCFI&quot;*</FPCLINE>
      <FPCLINE>*                                  Logic for insuarnce charges and doc *</FPCLINE>
      <FPCLINE>*                                  charges                             *</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>* 17-Aug-2016 AMOHAPA  E2DK918662  D2_OTC_FDD_0014_Defect#1919         *</FPCLINE>
      <FPCLINE>*                                  Restocking Fees has been added for  *</FPCLINE>
      <FPCLINE>*                                  Billing Type &apos;ZG2&apos; and &apos;ZRE&apos; and    *</FPCLINE>
      <FPCLINE>*                                  condition type &apos;ZRST&apos;.</FPCLINE>
      <FPCLINE>*                                  For company code 3000 singapore Tax *</FPCLINE>
      <FPCLINE>*                                  invoice print Telephone,fax  number,*</FPCLINE>
      <FPCLINE>*                                  Tax Indicator &amp; percentage and      *</FPCLINE>
      <FPCLINE>*                                  Exchange Rate.                      *</FPCLINE>
      <FPCLINE>*                                  In Bill to Partner Attn To:Accounts *</FPCLINE>
      <FPCLINE>*                                  Payable Team has been added.        *</FPCLINE>
      <FPCLINE>* 29-Dec-2017  U102006  E1DK933466 Defect#4461 Remit to address was not*</FPCLINE>
      <FPCLINE>*                                  coming properly due to type mismatch*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>********  Structure for Form **************</FPCLINE>
      <FPCLINE/>
      <FPCLINE>TYPES : BEGIN OF ty_address,</FPCLINE>
      <FPCLINE>        name1      TYPE ad_name1 , &quot; Name 1</FPCLINE>
      <FPCLINE>        name2      TYPE ad_name2 , &quot; Name 2</FPCLINE>
      <FPCLINE>        name3      TYPE ad_name3 , &quot; Name 3</FPCLINE>
      <FPCLINE>        name4      TYPE ad_name4 , &quot; Name 4</FPCLINE>
      <FPCLINE>        city1	     TYPE ad_city1 , &quot; City</FPCLINE>
      <FPCLINE>        city2	     TYPE ad_city2 , &quot; District</FPCLINE>
      <FPCLINE>        post_code1 TYPE	ad_pstcd1,</FPCLINE>
      <FPCLINE>*---&gt; Begin of change by PDEBARU for Defect# 8835</FPCLINE>
      <FPCLINE>        post_code2 TYPE ad_pstcd2, &quot; PO Box postal Code</FPCLINE>
      <FPCLINE>*&lt;--- End of change by PDEBARU for Defect# 8835</FPCLINE>
      <FPCLINE>* &lt;--- Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        po_box     TYPE ad_pobx  , &quot; PO Box</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        street     TYPE ad_street, &quot; Street</FPCLINE>
      <FPCLINE>        house_num1 TYPE	ad_hsnm1 , &quot; House Number</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        house_num2 TYPE	ad_hsnm1 , &quot; House number supplement</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        str_suppl1 TYPE ad_strspp1, &quot; Street 2</FPCLINE>
      <FPCLINE>        str_suppl2 TYPE ad_strspp2, &quot; Street 3</FPCLINE>
      <FPCLINE>        str_suppl3 TYPE ad_strspp3, &quot; Street 4</FPCLINE>
      <FPCLINE>        building   TYPE ad_bldng,   &quot; Building (Number or Code)</FPCLINE>
      <FPCLINE>        floor      TYPE ad_floor,   &quot; Floor in building</FPCLINE>
      <FPCLINE>        roomnumber TYPE ad_roomnum, &quot; Room or Appartment Number</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        country    TYPE land1    , &quot; Country Key</FPCLINE>
      <FPCLINE>        region     TYPE regio    , &quot; Region (State, Province, County)</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        tel_number TYPE ad_tlnmbr1, &quot; First telephone no.: dialling code+number</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        kunnr      TYPE kunnr    , &quot;Ship to / Bill to Customer</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        END OF ty_address,</FPCLINE>
      <FPCLINE>*--&gt; Begin of insert done by U102006 for Defect# 4461 on 29-Dec-2017</FPCLINE>
      <FPCLINE>        BEGIN OF ty_address_remit,</FPCLINE>
      <FPCLINE>        name1      TYPE ad_name1 ,  &quot; Name 1</FPCLINE>
      <FPCLINE>        name2      TYPE ad_name2 ,  &quot; Name 2</FPCLINE>
      <FPCLINE>        name3      TYPE ad_name3 ,  &quot; Name 3</FPCLINE>
      <FPCLINE>        name4      TYPE ad_name4 ,  &quot; Name 4</FPCLINE>
      <FPCLINE>        city1	     TYPE ad_city1 ,  &quot; City</FPCLINE>
      <FPCLINE>        city2	     TYPE ad_city2 ,  &quot; District</FPCLINE>
      <FPCLINE>        post_code1 TYPE	ad_pstcd1,  &quot; PO Box postal Code</FPCLINE>
      <FPCLINE>        post_code2 TYPE ad_pstcd2,  &quot; PO Box postal Code</FPCLINE>
      <FPCLINE>        po_box     TYPE ad_pobx  ,  &quot; PO Box</FPCLINE>
      <FPCLINE>        street     TYPE ad_street,  &quot; Street</FPCLINE>
      <FPCLINE>        house_num1 TYPE	ad_hsnm1 ,  &quot; House Number</FPCLINE>
      <FPCLINE>        house_num2 TYPE	ad_hsnm1 ,  &quot; House number supplement</FPCLINE>
      <FPCLINE>        country    TYPE land1    ,  &quot; Country Key</FPCLINE>
      <FPCLINE>        region     TYPE regio    ,  &quot; Region (State, Province, County)</FPCLINE>
      <FPCLINE>        tel_number TYPE ad_tlnmbr1, &quot; First telephone no.: dialling code+number</FPCLINE>
      <FPCLINE>        END OF ty_address_remit,</FPCLINE>
      <FPCLINE>*&lt;-- End of insert done by U102006 for Defect# 4461 on 29-Dec-2017</FPCLINE>
      <FPCLINE>        BEGIN OF ty_remitt,</FPCLINE>
      <FPCLINE>        name1 TYPE ad_name1,      &quot; Name 1</FPCLINE>
      <FPCLINE>        city1	TYPE ad_city1,</FPCLINE>
      <FPCLINE>        city2	TYPE ad_city2,</FPCLINE>
      <FPCLINE>        street  TYPE ad_street,   &quot; Street</FPCLINE>
      <FPCLINE>        house_num1 TYPE	ad_hsnm1,</FPCLINE>
      <FPCLINE>        END OF ty_remitt,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_customer    ,</FPCLINE>
      <FPCLINE>        kunrg     TYPE kunrg    , &quot; Payer</FPCLINE>
      <FPCLINE>        kunrg_txt TYPE tdline   , &quot; Payer Text</FPCLINE>
      <FPCLINE>        vbeln     TYPE vbeln    , &quot; Invoice Number</FPCLINE>
      <FPCLINE>        vbeln_txt TYPE tdline   , &quot; Invoice number Text</FPCLINE>
      <FPCLINE>        fkdat     TYPE fkdat    , &quot; Billing date for billing index and printout</FPCLINE>
      <FPCLINE>        fkdat_txt TYPE tdline   , &quot; Billing date Text</FPCLINE>
      <FPCLINE>        name1     TYPE ad_name1 , &quot; Name 1</FPCLINE>
      <FPCLINE>        name1_txt TYPE tdline   , &quot; Name Text</FPCLINE>
      <FPCLINE>        inco1     TYPE inco1    , &quot; Incoterms (Part 1)</FPCLINE>
      <FPCLINE>        inco1_txt TYPE tdline   , &quot; Incoterms Text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>*       lfdat     TYPE lfdat_v  ,  &quot; Delivery Date</FPCLINE>
      <FPCLINE>*       lfdat_txt TYPE tdline   ,  &quot; Delivery Date Text</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        END OF ty_customer,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_purchase     ,</FPCLINE>
      <FPCLINE>        bstnk_vf  TYPE bstkd     , &quot; Customer purchase order number</FPCLINE>
      <FPCLINE>        city1	    TYPE ad_city1  , &quot; City</FPCLINE>
      <FPCLINE>        city2	    TYPE ad_city2  , &quot; District</FPCLINE>
      <FPCLINE>        region    TYPE regio     , &quot; Region (State, Province, County)</FPCLINE>
      <FPCLINE>        zterm     TYPE dzterm_bez, &quot; Description of terms of payment</FPCLINE>
      <FPCLINE>        ernam     TYPE name1_gp  , &quot; Name 1</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        zzcaseref TYPE z_caseref , &quot; Case Ref No</FPCLINE>
      <FPCLINE>        land1     TYPE lland     , &quot; Country of Destination</FPCLINE>
      <FPCLINE>        vgbel     TYPE vgbel     , &quot; Reference document number</FPCLINE>
      <FPCLINE>        tdline    TYPE tdline    , &quot; Standard text for Header</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        END OF ty_purchase,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_sales,</FPCLINE>
      <FPCLINE>        vbeln TYPE vbeln,           &quot; Sales and Distribution Document Number</FPCLINE>
      <FPCLINE>        erdat TYPE erdat,           &quot; Date on Which Record Was Created</FPCLINE>
      <FPCLINE>        name1 TYPE ad_name1,        &quot; Name 1</FPCLINE>
      <FPCLINE>        tel_number TYPE ad_tlnmbr1, &quot; First telephone no.: dialling code+number</FPCLINE>
      <FPCLINE>        END OF ty_sales,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_lips,</FPCLINE>
      <FPCLINE>        vbeln TYPE vbeln,           &quot; Sales and Distribution Document Number</FPCLINE>
      <FPCLINE>        posnr TYPE posnr,           &quot; Item number of the SD document</FPCLINE>
      <FPCLINE>        lfimg TYPE lfimg,           &quot; Actual quantity delivered (in sales units)</FPCLINE>
      <FPCLINE>        kpein TYPE kpein,           &quot; Condition pricing unit</FPCLINE>
      <FPCLINE>        END OF ty_lips,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_item    ,</FPCLINE>
      <FPCLINE>        matnr   TYPE matnr  ,       &quot; Material Number</FPCLINE>
      <FPCLINE>        uecha   TYPE uecha  ,       &quot; Higher-Level Item of Batch Split Item</FPCLINE>
      <FPCLINE>        charg   TYPE char18 ,       &quot; Charg of type CHAR18</FPCLINE>
      <FPCLINE>        lfimg   TYPE lfimg  ,       &quot; Actual quantity delivered (in sales units)</FPCLINE>
      <FPCLINE>        fkimg   TYPE fkimg  ,       &quot; Actual Invoiced Quantity</FPCLINE>
      <FPCLINE>        meins   TYPE meins  ,       &quot; Base Unit of Measure</FPCLINE>
      <FPCLINE>        arktx   TYPE arktx  ,       &quot; Short text for sales order item</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        kpein   TYPE kbetr  , &quot; Actual quantity delivered (in sales units)</FPCLINE>
      <FPCLINE>        ext     TYPE kbetr ,  &quot; Actual quantity delivered (in sales units)</FPCLINE>
      <FPCLINE>*        kpein   TYPE lfimg  ,       &quot; Actual quantity delivered (in sales units)</FPCLINE>
      <FPCLINE>*        ext     TYPE lfimg  ,       &quot; Actual quantity delivered (in sales units)</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        zcfi    TYPE arktx  ,        &quot; CFI Disounts</FPCLINE>
      <FPCLINE>        flag    TYPE flag   ,        &quot; BOM Item - &apos;X&apos; / Others - &apos; &apos;</FPCLINE>
      <FPCLINE>        bom     TYPE flag   ,        &quot; BOM Header/Item flag</FPCLINE>
      <FPCLINE>        bommat  TYPE matnr  ,        &quot; Material Number of BOM Header</FPCLINE>
      <FPCLINE>        tdline  TYPE wcb_tdline_tab, &quot; Line Item texts</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        END OF ty_item      ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_item1    ,</FPCLINE>
      <FPCLINE>        mat_bat  TYPE char18  , &quot; Bat of type CHAR18</FPCLINE>
      <FPCLINE>        lfimg    TYPE char18  , &quot; Lfimg of type CHAR18</FPCLINE>
      <FPCLINE>        fkimg    TYPE char18  , &quot; Fkimg of type CHAR18</FPCLINE>
      <FPCLINE>        meins    TYPE char3   , &quot; Meins of type CHAR3</FPCLINE>
      <FPCLINE>        arktx    TYPE arktx   , &quot; Material description</FPCLINE>
      <FPCLINE>        kpein    TYPE char20  , &quot; Kpein of type CHAR20</FPCLINE>
      <FPCLINE>        ext      TYPE char20  , &quot; Ext of type CHAR20</FPCLINE>
      <FPCLINE>        bomhdr   TYPE flag    , &quot; BOM Header flag</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>        uecha    TYPE uecha   , &quot; Higher-Level Item of Batch Split Item</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        invqty   TYPE fkimg   , &quot; Actual Invoiced Quantity</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        extdqty TYPE kbetr, &quot; Rate (condition amount or percentage)</FPCLINE>
      <FPCLINE>*        extdqty  TYPE lfimg   ,       &quot; Actual quantity delivered (in sales units)</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        tdline   TYPE wcb_tdline_tab, &quot; Line Item texts</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        END OF ty_item1       ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_objk,</FPCLINE>
      <FPCLINE>        obknr TYPE objknr,    &quot; Object list number</FPCLINE>
      <FPCLINE>        obzae TYPE objza,     &quot; Object list counters</FPCLINE>
      <FPCLINE>        sernr TYPE gernr,     &quot; Serial Number</FPCLINE>
      <FPCLINE>        matnr TYPE matnr,     &quot; Material Number</FPCLINE>
      <FPCLINE>        END OF ty_objk,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_vbap    ,</FPCLINE>
      <FPCLINE>        vbeln  TYPE vbeln_va, &quot; Sales Document</FPCLINE>
      <FPCLINE>        posnr  TYPE posnr_va, &quot; Sales Document Item</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        uepos	 TYPE uepos	  , &quot; Higher-level item in bill of material structures</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        zmeng  TYPE dzmeng  , &quot; Target quantity in sales units</FPCLINE>
      <FPCLINE>        kwmeng TYPE kwmeng  , &quot; Cumulative Order Quantity in Sales Units</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        stlnr	 TYPE stnum	  , &quot; Bill of material</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>        END OF ty_vbap,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_low,</FPCLINE>
      <FPCLINE>        low TYPE tvarv_val, &quot; ABAP/4: Selection value (LOW or HIGH value, external format)</FPCLINE>
      <FPCLINE>        END OF ty_low,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* CR-508 : Begin of changes : SNIGAM : 10-Jul-2013</FPCLINE>
      <FPCLINE>        BEGIN OF ty_lines,</FPCLINE>
      <FPCLINE>*CR-508</FPCLINE>
      <FPCLINE>*        tdline TYPE tdline, &quot; Text Line</FPCLINE>
      <FPCLINE>         tdline TYPE char1250, &quot; Text Line</FPCLINE>
      <FPCLINE>*CR-508</FPCLINE>
      <FPCLINE>        END OF ty_lines,</FPCLINE>
      <FPCLINE>* CR-508 : End of changes : SNIGAM : 10-Jul-2013</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Text ID for Document Header text</FPCLINE>
      <FPCLINE>        BEGIN OF ty_txtid ,</FPCLINE>
      <FPCLINE>        tdid TYPE tdid    , &quot;Text ID</FPCLINE>
      <FPCLINE>        END OF ty_txtid   ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Delivery numbers</FPCLINE>
      <FPCLINE>        BEGIN OF ty_delv      ,</FPCLINE>
      <FPCLINE>        obknr   TYPE objknr   , &quot;Object list number</FPCLINE>
      <FPCLINE>        lief_nr TYPE vbeln_vl , &quot;Delivery</FPCLINE>
      <FPCLINE>        posnr   TYPE posnr_vl , &quot;Delivery Item</FPCLINE>
      <FPCLINE>        END OF ty_delv        ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Serial Numbers for Delivery</FPCLINE>
      <FPCLINE>        BEGIN OF ty_ser01     ,</FPCLINE>
      <FPCLINE>        obknr	  TYPE objknr	  , &quot;Object list number</FPCLINE>
      <FPCLINE>        lief_nr	TYPE vbeln_vl	, &quot;Delivery</FPCLINE>
      <FPCLINE>        posnr	  TYPE posnr_vl	, &quot;Delivery Item</FPCLINE>
      <FPCLINE>        END OF ty_ser01       ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Billing Document Item</FPCLINE>
      <FPCLINE>        BEGIN OF ty_vbrp         ,</FPCLINE>
      <FPCLINE>        vbeln	     TYPE vbeln_vf , &quot; Billing Document</FPCLINE>
      <FPCLINE>        posnr      TYPE posnr_vf , &quot; Billing item</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>        vgbel	     TYPE vgbel    , &quot; Document number of the reference document</FPCLINE>
      <FPCLINE>        vgpos	     TYPE vgpos    , &quot; Item number of the reference item</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>        aubel	     TYPE vbeln_va , &quot; Sales Document</FPCLINE>
      <FPCLINE>        aupos	     TYPE posnr_va , &quot; Sales Document Item</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>        kowrr      TYPE kowrr    , &quot; Statistical values</FPCLINE>
      <FPCLINE>        mwsbp      TYPE mwsbp    , &quot; Tax amount in document currency</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>        zzquoteref TYPE z_itemref, &quot; Legacy Qtn Ref</FPCLINE>
      <FPCLINE>        END OF ty_vbrp           ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Sales Organization/City/Language</FPCLINE>
      <FPCLINE>        BEGIN OF ty_socl   ,</FPCLINE>
      <FPCLINE>        vkorg  TYPE vkorg  , &quot; Sales Organization</FPCLINE>
      <FPCLINE>        land1  TYPE lland  , &quot; Country of Destination</FPCLINE>
      <FPCLINE>        lang1  TYPE spras  , &quot; Language Key 1</FPCLINE>
      <FPCLINE>        lang2  TYPE spras  , &quot; Language Key 2</FPCLINE>
      <FPCLINE>        END OF ty_socl     ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Item labels</FPCLINE>
      <FPCLINE>        BEGIN OF ty_label ,</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>        shipto       TYPE tdline  , &quot;Ship to Text</FPCLINE>
      <FPCLINE>        billto       TYPE tdline  , &quot;Bill to Text</FPCLINE>
      <FPCLINE>        invoice      TYPE tdline  , &quot;Invoice Text</FPCLINE>
      <FPCLINE>        plsremit     TYPE tdline  , &quot;Please remit to Text</FPCLINE>
      <FPCLINE>        question     TYPE tdline  , &quot;Question call Text</FPCLINE>
      <FPCLINE>        payment      TYPE tdline  , &quot;Invoice Payment Text</FPCLINE>
      <FPCLINE>        mat_batch_fr TYPE tdline  , &quot;Material/Batch/Serial number Text</FPCLINE>
      <FPCLINE>        order_qty_fr TYPE tdline  , &quot;Order quantity Text</FPCLINE>
      <FPCLINE>        ship_qty_fr  TYPE tdline  , &quot;Ship quantity Text</FPCLINE>
      <FPCLINE>        unit_fr      TYPE tdline  , &quot;Unit Text</FPCLINE>
      <FPCLINE>        desc_fr      TYPE tdline  , &quot;Material Description Text</FPCLINE>
      <FPCLINE>        unit_pr_fr   TYPE tdline  , &quot;Unit price Text</FPCLINE>
      <FPCLINE>        extnd_pr_fr  TYPE tdline  , &quot;Extended price Text</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>        mat_batch_sn TYPE tdline  , &quot;Material/Batch/Serial number Text</FPCLINE>
      <FPCLINE>        order_qty    TYPE tdline  , &quot;Order quantity Text</FPCLINE>
      <FPCLINE>        ship_qty     TYPE tdline  , &quot;Ship quantity Text</FPCLINE>
      <FPCLINE>        unit         TYPE tdline  , &quot;Unit Text</FPCLINE>
      <FPCLINE>        description  TYPE tdline  , &quot;Material Description Text</FPCLINE>
      <FPCLINE>        unit_price   TYPE tdline  , &quot;Unit price Text</FPCLINE>
      <FPCLINE>        extnd_price  TYPE tdline  , &quot;Extended price Text</FPCLINE>
      <FPCLINE>        END OF ty_label   ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Application object ID</FPCLINE>
      <FPCLINE>        BEGIN OF ty_tdobject ,</FPCLINE>
      <FPCLINE>        id_z012 TYPE tdid    , &quot; Texts: Application Object - &apos;Z012&apos;</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_CR_D2_531_532 by ADEY</FPCLINE>
      <FPCLINE>        id_z014 TYPE tdid    , &quot; Texts: Application Object - &apos;Z014&apos;</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_CR_D2_531_532 by ADEY</FPCLINE>
      <FPCLINE>        id_z015 TYPE tdid    , &quot; Texts: Application Object - &apos;Z015&apos;</FPCLINE>
      <FPCLINE>        id_z016 TYPE tdid    , &quot; Texts: Application Object - &apos;Z016&apos;</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>        zpln    TYPE mtpos   , &quot; Item category group from material master</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>        vtweg   TYPE vtweg   , &quot; Distribution Channel</FPCLINE>
      <FPCLINE>        fkart   TYPE fkart   , &quot; Billing Type</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        END OF ty_tdobject   ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Condition types from EMI tool</FPCLINE>
      <FPCLINE>        BEGIN OF ty_cond      ,</FPCLINE>
      <FPCLINE>        cond_xr1  TYPE kscha  , &quot; Condition type - &apos;XR1&apos;</FPCLINE>
      <FPCLINE>        tax_xr1   TYPE char3  , &quot; Percentage type - &apos;GST&apos;/&apos;HST&apos;/&apos;PST&apos;/&apos;QST&apos;</FPCLINE>
      <FPCLINE>        perc_xr1  TYPE char10 , &quot; Percentage value</FPCLINE>
      <FPCLINE>        sum_xr1   TYPE kbetr  , &quot; Summed up value for Condition type - &apos;XR1&apos;</FPCLINE>
      <FPCLINE>        cond_xr2  TYPE kscha  , &quot; Condition type - &apos;XR2&apos;</FPCLINE>
      <FPCLINE>        tax_xr2   TYPE char3  , &quot; Percentage type - &apos;GST&apos;/&apos;HST&apos;/&apos;PST&apos;/&apos;QST&apos;</FPCLINE>
      <FPCLINE>        perc_xr2  TYPE char10 , &quot; Percentage value</FPCLINE>
      <FPCLINE>        sum_xr2   TYPE kbetr  , &quot; Summed up value for Condition type - &apos;XR2&apos;</FPCLINE>
      <FPCLINE>        cond_xr3  TYPE kscha  , &quot; Condition type - &apos;XR3&apos;</FPCLINE>
      <FPCLINE>        tax_xr3   TYPE char3  , &quot; Percentage type - &apos;GST&apos;/&apos;HST&apos;/&apos;PST&apos;/&apos;QST&apos;</FPCLINE>
      <FPCLINE>        perc_xr3  TYPE char10 , &quot; Percentage value</FPCLINE>
      <FPCLINE>        sum_xr3   TYPE kbetr  , &quot; Summed up value for Condition type - &apos;XR3&apos;</FPCLINE>
      <FPCLINE>        cond_zcfi TYPE kscha  , &quot; Condition type - &apos;ZCFI&apos;</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE>        cond_znet TYPE kscha  , &quot; Condition type - &apos;ZNET&apos;</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE>        END OF ty_cond        ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Percentage and condition</FPCLINE>
      <FPCLINE>        BEGIN OF ty_perc_cond ,</FPCLINE>
      <FPCLINE>        cond   TYPE kscha     , &quot; Condition type</FPCLINE>
      <FPCLINE>        region TYPE regio     , &quot; Region (State, Province, County)</FPCLINE>
      <FPCLINE>        taxtxt TYPE char10    , &quot; Percentage for GST/PST/HST/QST</FPCLINE>
      <FPCLINE>        END OF ty_perc_cond   ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Percentage and condition to be printed</FPCLINE>
      <FPCLINE>        BEGIN OF ty_tax      ,</FPCLINE>
      <FPCLINE>        taxtxt  TYPE char13  , &quot; Tax Text for Condition type</FPCLINE>
      <FPCLINE>        perc    TYPE char15  , &quot; Percentage for GST/PST/HST/QST</FPCLINE>
      <FPCLINE>        amnt    TYPE char15  , &quot; Summed up value</FPCLINE>
      <FPCLINE>        END OF ty_tax        ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Purchase Order Header text</FPCLINE>
      <FPCLINE>        BEGIN OF ty_po_txt       ,</FPCLINE>
      <FPCLINE>        po_txt    TYPE tdline    , &quot;Purchase Order ID Text</FPCLINE>
      <FPCLINE>        bstnk_vf  TYPE bstkd     , &quot;Customer purchase order number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE>*       case_txt  TYPE tdline    , &quot;Case ID Text</FPCLINE>
      <FPCLINE>*       caseref   TYPE z_caseref , &quot;Case Ref No</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ship_txt  TYPE tdline    , &quot;Ship from Text</FPCLINE>
      <FPCLINE>        ship_frm  TYPE char100   , &quot;Ship from date</FPCLINE>
      <FPCLINE>        pmt_txt   TYPE tdline    , &quot;Payment terms Text</FPCLINE>
      <FPCLINE>        zterm     TYPE dzterm_bez, &quot;Description of terms of payment</FPCLINE>
      <FPCLINE>        END OF ty_po_txt         ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Standard text with values</FPCLINE>
      <FPCLINE>        BEGIN OF ty_stdtxt,</FPCLINE>
      <FPCLINE>        text TYPE tdline  , &quot;Standard text</FPCLINE>
      <FPCLINE>        val  TYPE char256 , &quot;Value</FPCLINE>
      <FPCLINE>        END OF ty_stdtxt  ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Sales Data for Material</FPCLINE>
      <FPCLINE>        BEGIN OF ty_mvke,</FPCLINE>
      <FPCLINE>        matnr TYPE matnr, &quot; Material Number</FPCLINE>
      <FPCLINE>        END OF ty_mvke  ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Billing Plan: Dates</FPCLINE>
      <FPCLINE>        BEGIN OF ty_fplt ,</FPCLINE>
      <FPCLINE>        fplnr	TYPE fplnr , &quot; Billing plan number / invoicing plan number</FPCLINE>
      <FPCLINE>        fpltr	TYPE fpltr , &quot; Item for billing plan/invoice plan/payment cards</FPCLINE>
      <FPCLINE>        fkdat TYPE bfdat , &quot; Settlement date for deadline</FPCLINE>
      <FPCLINE>        nfdat TYPE nfdat , &quot; Settlement date for deadline</FPCLINE>
      <FPCLINE>        END OF ty_fplt   ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for Sales Document: Business Data</FPCLINE>
      <FPCLINE>        BEGIN OF ty_vbkd ,</FPCLINE>
      <FPCLINE>        vbeln TYPE vbeln ,   &quot;Sales and Distribution Document Number</FPCLINE>
      <FPCLINE>        posnr	TYPE posnr ,   &quot;Item number of the SD document</FPCLINE>
      <FPCLINE>        bstkd	TYPE bstkd , 	 &quot;Customer purchase order number</FPCLINE>
      <FPCLINE>        END OF ty_vbkd   ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Structure for SD document: Delivery: Item data</FPCLINE>
      <FPCLINE>        BEGIN OF ty_batch   ,</FPCLINE>
      <FPCLINE>        vbeln TYPE vbeln_vl , &quot; Delivery</FPCLINE>
      <FPCLINE>        posnr TYPE posnr_vl , &quot; Delivery Item</FPCLINE>
      <FPCLINE>        uecha TYPE uecha    , &quot; Higher-Level Item of Batch Split Item</FPCLINE>
      <FPCLINE>        END OF ty_batch,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* --&gt; Begin of Change for Defect #8548</FPCLINE>
      <FPCLINE>        BEGIN OF ty_mara,</FPCLINE>
      <FPCLINE>          matnr TYPE matnr, &quot; Material Number</FPCLINE>
      <FPCLINE>          mtart TYPE mtart, &quot; Material Type</FPCLINE>
      <FPCLINE>        END   OF ty_mara,</FPCLINE>
      <FPCLINE>* &lt;-- End   of Change for Defect #8548</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* --&gt; Begin of Change for Defect #8616</FPCLINE>
      <FPCLINE>        BEGIN OF ty_auart,</FPCLINE>
      <FPCLINE>          auart TYPE auart, &quot; Sales Document Type</FPCLINE>
      <FPCLINE>        END   OF ty_auart,</FPCLINE>
      <FPCLINE>* &lt;-- End   of Change for Defect #8616</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        BEGIN OF ty_bukrs,</FPCLINE>
      <FPCLINE>          bukrs TYPE bukrs,</FPCLINE>
      <FPCLINE>          END OF ty_bukrs.</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>TYPES : ty_t_txtid     TYPE STANDARD TABLE OF ty_txtid        INITIAL SIZE 0, &quot;Header Text ID</FPCLINE>
      <FPCLINE>        ty_t_stdtxt    TYPE STANDARD TABLE OF ty_stdtxt       INITIAL SIZE 0, &quot;Final Total</FPCLINE>
      <FPCLINE>        ty_t_constant  TYPE STANDARD TABLE OF zdev_enh_status INITIAL SIZE 0, &quot;Enhancement Status</FPCLINE>
      <FPCLINE>        ty_t_vbap      TYPE STANDARD TABLE OF ty_vbap         INITIAL SIZE 0, &quot;Sales order item details</FPCLINE>
      <FPCLINE>        ty_t_vbrp      TYPE STANDARD TABLE OF ty_vbrp         INITIAL SIZE 0, &quot;Billing Document Item Data</FPCLINE>
      <FPCLINE>        ty_t_perc_cond TYPE STANDARD TABLE OF ty_perc_cond    INITIAL SIZE 0, &quot;Percentage/Condition types</FPCLINE>
      <FPCLINE>        ty_t_tax       TYPE STANDARD TABLE OF ty_tax          INITIAL SIZE 0, &quot;Percentage/Condition types</FPCLINE>
      <FPCLINE>        ty_t_objk      TYPE STANDARD TABLE OF ty_objk         INITIAL SIZE 0, &quot;Plant Maintenance Object List</FPCLINE>
      <FPCLINE>        ty_t_delv      TYPE STANDARD TABLE OF ty_delv         INITIAL SIZE 0, &quot;Delivery for Serial number</FPCLINE>
      <FPCLINE>        ty_t_ser01     TYPE STANDARD TABLE OF ty_ser01        INITIAL SIZE 0, &quot;Serial Numbers for Delivery</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>        ty_t_mvke      TYPE STANDARD TABLE OF ty_mvke        INITIAL SIZE 0, &quot;Sales Data for Material</FPCLINE>
      <FPCLINE>        ty_t_fplt      TYPE STANDARD TABLE OF ty_fplt        INITIAL SIZE 0, &quot;Serial Numbers for Delivery</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE>        ty_t_vbkd      TYPE STANDARD TABLE OF ty_vbkd        INITIAL SIZE 0, &quot;Sales Document: Business Data</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>        ty_t_batch     TYPE STANDARD TABLE OF ty_batch       INITIAL SIZE 0, &quot;SD document: Delivery: Item data</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ty_t_auart     TYPE STANDARD TABLE OF ty_auart, &quot; Defect 8616</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ty_lips_t  TYPE TABLE OF ty_lips,</FPCLINE>
      <FPCLINE>        ty_item1_t TYPE TABLE OF ty_item1,</FPCLINE>
      <FPCLINE>        ty_item_t  TYPE TABLE OF ty_item,</FPCLINE>
      <FPCLINE>        ty_string  TYPE TABLE OF string,</FPCLINE>
      <FPCLINE>        ty_t_lines TYPE TABLE OF ty_lines,              &quot; Added Under CR-508</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>       BEGIN OF ty_add_data,</FPCLINE>
      <FPCLINE>          line1 TYPE string, &quot;Print std text line</FPCLINE>
      <FPCLINE>          line2 TYPE string, &quot;Print std text line</FPCLINE>
      <FPCLINE>          line3 TYPE string, &quot;Print std text line</FPCLINE>
      <FPCLINE>          line4 TYPE string, &quot;Print std text line</FPCLINE>
      <FPCLINE>          line5 TYPE string, &quot;Print std text line</FPCLINE>
      <FPCLINE>          line6 TYPE string, &quot;Print std text line</FPCLINE>
      <FPCLINE>          line7 TYPE string, &quot;Print std text line</FPCLINE>
      <FPCLINE>          line8 TYPE string, &quot;Print std text line</FPCLINE>
      <FPCLINE>        END OF ty_add_data,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        BEGIN OF ty_t001z,</FPCLINE>
      <FPCLINE>          bukrs TYPE bukrs,</FPCLINE>
      <FPCLINE>          party TYPE party,</FPCLINE>
      <FPCLINE>          paval TYPE paval,</FPCLINE>
      <FPCLINE>          END OF ty_t001z,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          ty_t_bukrs TYPE TABLE OF ty_bukrs.</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>**Structure declartion for FKART range table</FPCLINE>
      <FPCLINE>TYPES:     BEGIN OF ty_fkart,</FPCLINE>
      <FPCLINE>           sign TYPE char1,</FPCLINE>
      <FPCLINE>           option TYPE char2,</FPCLINE>
      <FPCLINE>           low    TYPE fkart,</FPCLINE>
      <FPCLINE>           high   TYPE fkart,</FPCLINE>
      <FPCLINE>           END OF ty_fkart,</FPCLINE>
      <FPCLINE>**Structure declation for KSCHL range table</FPCLINE>
      <FPCLINE>           BEGIN OF ty_kschl,</FPCLINE>
      <FPCLINE>           sign TYPE char1,</FPCLINE>
      <FPCLINE>           option TYPE char2,</FPCLINE>
      <FPCLINE>           low    TYPE kschl,</FPCLINE>
      <FPCLINE>           high   TYPE kschl,</FPCLINE>
      <FPCLINE>           END OF ty_kschl,</FPCLINE>
      <FPCLINE>**Structure declartion for FCURR range table</FPCLINE>
      <FPCLINE>           BEGIN OF ty_fcurr,</FPCLINE>
      <FPCLINE>           sign TYPE char1,</FPCLINE>
      <FPCLINE>           option TYPE char2,</FPCLINE>
      <FPCLINE>           low    TYPE FCURR_CURR,</FPCLINE>
      <FPCLINE>           high   TYPE FCURR_CURR,</FPCLINE>
      <FPCLINE>           END OF ty_fcurr,</FPCLINE>
      <FPCLINE>**Structure declartion for TCURR range table</FPCLINE>
      <FPCLINE>           BEGIN OF ty_tcurr,</FPCLINE>
      <FPCLINE>           sign TYPE char1,</FPCLINE>
      <FPCLINE>           option TYPE char2,</FPCLINE>
      <FPCLINE>           low    TYPE TCURR_CURR,</FPCLINE>
      <FPCLINE>           high   TYPE TCURR_CURR,</FPCLINE>
      <FPCLINE>           END OF ty_tcurr,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>           ty_t_fkart TYPE STANDARD TABLE OF ty_fkart INITIAL SIZE 0, &quot;Table type for ty_fkart</FPCLINE>
      <FPCLINE>           ty_t_kschl TYPE STANDARD TABLE OF ty_kschl INITIAL SIZE 0, &quot;Table type for ty_kschl</FPCLINE>
      <FPCLINE>           ty_t_fcurr TYPE STANDARD TABLE OF ty_fcurr INITIAL SIZE 0, &quot;Table type for ty_fcurr</FPCLINE>
      <FPCLINE>           ty_t_tcurr TYPE STANDARD TABLE OF ty_tcurr INITIAL SIZE 0. &quot;Table type for ty_tcurr</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
     </TYPES>
     <FIELDSYMBOLS/>
    </CL_FP_GLOBAL_DEFINITIONS>
   </cls:CL_FP_GLOBAL_DEFINITIONS>
   <cls:CL_FP_PARAMETERS id="o4">
    <CL_FP_INTERFACE_DATA_CHANGED classVersion="1">
     <INTERFACE_DATA href="#o1"/>
    </CL_FP_INTERFACE_DATA_CHANGED>
    <CL_FP_PARAMETERS classVersion="1">
     <IMPORT_PARAMETERS>
      <SFPIOPAR>
       <NAME>BIL_PRT_COM</NAME>
       <TYPING>TYPE</TYPING>
       <TYPENAME>INVOICE_S_PRT_INTERFACE</TYPENAME>
       <OPTIONAL/>
       <BYVALUE/>
       <DEFAULTVAL/>
       <STANDARD/>
       <CONSTANT/>
      </SFPIOPAR>
     </IMPORT_PARAMETERS>
     <EXPORT_PARAMETERS/>
     <TABLE_PARAMETERS/>
     <EXCEPTIONS/>
    </CL_FP_PARAMETERS>
   </cls:CL_FP_PARAMETERS>
   <cls:CL_FP_CODING id="o5">
    <CL_FP_INTERFACE_DATA_CHANGED classVersion="1">
     <INTERFACE_DATA href="#o1"/>
    </CL_FP_INTERFACE_DATA_CHANGED>
    <CL_FP_CODING classVersion="1">
     <INPUT_PARAMETERS>
      <FPPARAMETER>LV_VBTYP</FPPARAMETER>
     </INPUT_PARAMETERS>
     <OUTPUT_PARAMETERS/>
     <INITIALIZATION>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>************************************************************************</FPCLINE>
      <FPCLINE>* PROGRAM    :  ZOTC0014_INVOICE_FORM_BILLING1                         *</FPCLINE>
      <FPCLINE>* TITLE      :  Invoce Form Billing Interface                          *</FPCLINE>
      <FPCLINE>* DEVELOPER  :  NIRAJ SHARMA                                           *</FPCLINE>
      <FPCLINE>* OBJECT TYPE:  Interface (Form)                                       *</FPCLINE>
      <FPCLINE>* SAP RELEASE:  SAP ECC 6.0                                            *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* WRICEF ID:  OTC_FDD_0014_US_Invoice_Form_Billing</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* DESCRIPTION: SHORT DESCRIPTION OF FUNCTIONALITY                      *</FPCLINE>
      <FPCLINE>* Invoice Form Billing Via T-COdes VF31/VF02/VF03                      *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* MODIFICATION HISTORY:                                                *</FPCLINE>
      <FPCLINE>*======================================================================*</FPCLINE>
      <FPCLINE>* DATE        USER      TRANSPORT  DESCRIPTION                         *</FPCLINE>
      <FPCLINE>* =========== ========  ========== ====================================*</FPCLINE>
      <FPCLINE>* 13-MAR-2012 NSHARMA1  E1DK901196 INITIAL DEVELOPMENT                 *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 18-Oct-2012 RVERMA    E1DK907045 Defect# 781 - Addition of Curreny   *</FPCLINE>
      <FPCLINE>*                                  Key field in Total Amount           *</FPCLINE>
      <FPCLINE>* 26-Oct-2012 RVERMA    E1DK907045 Defect# 781 - Remove header part    *</FPCLINE>
      <FPCLINE>*                                  of follow up page from layout.      *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 26-Oct-2012 RVERMA    E1DK907045 Defect# 991 - Thousand separator    *</FPCLINE>
      <FPCLINE>*                                  missing in amount fields.           *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 26-Oct-2012 RVERMA    E1DK907045 Defect# 1116 - Ordered quantity is  *</FPCLINE>
      <FPCLINE>*                                  not printing correctly.             *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 09-Nov-2012 SBASU    E1DK907045 Defect# 1609 - Unit price/Net price at</FPCLINE>
      <FPCLINE>*                                 item level getting printed wrongly   *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 28-Nov-2012 SBASU    E1DK907044 Def # 1894 - sales UOM in line item  *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 23-Mar-2013 ADAS1    E1DK909496 CR # 313 - Add condition type ZTFR</FPCLINE>
      <FPCLINE>*                                 to calculate Handling charge by summing</FPCLINE>
      <FPCLINE>*                                 up all line items  *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 19-Apr-2013 ADAS1     E1DK909621 D#3604,CR#373- PO number is not coming for</FPCLINE>
      <FPCLINE>*                                 converted SO</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 10-Jul-2013 SNIGAM  E1DK910965  HPQC Def-508, CR-508, INC0094798</FPCLINE>
      <FPCLINE>*                                 Text from Bill-to-Party not getting</FPCLINE>
      <FPCLINE>*                                 fully Printed in the Invoic</FPCLINE>
      <FPCLINE>*                                 Tag: CR-508</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 24-SEP-2014 ADEY    E2DK905111   D2_OTC_FDD_0014 :                   *</FPCLINE>
      <FPCLINE>*                                  Addition of new fields and VAT      *</FPCLINE>
      <FPCLINE>*                                  details for US and Canada           *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 11-NOV-2014 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect# 2361      *</FPCLINE>
      <FPCLINE>*                                  Additional changes for change in    *</FPCLINE>
      <FPCLINE>*                                  layout                              *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 12-JAN-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#2022/CR_337*</FPCLINE>
      <FPCLINE>*                                  Additional changes to print billing *</FPCLINE>
      <FPCLINE>*                                  plan dates and No Tax Indicator in  *</FPCLINE>
      <FPCLINE>*                                  layout                              *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 20-FEB-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#3035/CR_482*</FPCLINE>
      <FPCLINE>*                                  1. Remove Ship date from layout     *</FPCLINE>
      <FPCLINE>*                                  2. BOM Component printing based on  *</FPCLINE>
      <FPCLINE>*                                     Distribution Channel and Invoice *</FPCLINE>
      <FPCLINE>*                                     type                             *</FPCLINE>
      <FPCLINE>*                                  3. French translation population    *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 17-MAR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#4850       *</FPCLINE>
      <FPCLINE>*                                  Purchase Order ID mapping changed   *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 17-MAR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : CR_D2_531_532     *</FPCLINE>
      <FPCLINE>*                                  1. Append Header Text of &apos;Z014&apos;     *</FPCLINE>
      <FPCLINE>*                                  2. Append Line Item Text of &apos;Z014&apos;  *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 17-APR-2015 APODDAR E2DK905111   D2_OTC_FDD_0014 : Defect # 5656     *</FPCLINE>
      <FPCLINE>*                                  Translation                         *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 07-APR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5656       *</FPCLINE>
      <FPCLINE>*                                  Formatting changes                  *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 07-APR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5683       *</FPCLINE>
      <FPCLINE>*                                  Handle Special Characters in Text ID*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 08-APR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5753       *</FPCLINE>
      <FPCLINE>*                                  &quot;NT&quot; Non-taxable item display change*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 28-APR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#6252       *</FPCLINE>
      <FPCLINE>*                                  Ship-To and Bill-To Address will be *</FPCLINE>
      <FPCLINE>*                                  printed from Sales Document: Partner*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 07-MAY-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5935       *</FPCLINE>
      <FPCLINE>*                                  Unit price and Extended price at    *</FPCLINE>
      <FPCLINE>*                                  item level will be printed from     *</FPCLINE>
      <FPCLINE>*                                  KONV table for &apos;ZNET&apos; condition type*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 24-JUN-2015 ADEY    E2DK913615   D2_OTC_FDD_0014 : Defect#5999/CR_628*</FPCLINE>
      <FPCLINE>*                                  For Subsidy case -                  *</FPCLINE>
      <FPCLINE>*                                  a. BOM Header should be printed     *</FPCLINE>
      <FPCLINE>*                                  b. Unit price and Extended price    *</FPCLINE>
      <FPCLINE>*                                     will be printed at BOM Component *</FPCLINE>
      <FPCLINE>*                                     level                            *</FPCLINE>
      <FPCLINE>*                                  c. &apos;Begin of BOM&apos; and &apos;End of BOM&apos;  *</FPCLINE>
      <FPCLINE>*                                     will be printed at start and end *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 08-JUL-2015 SMUKHER E2DK913787   D2_OTC_FDD_0014 : Defect#8548       *</FPCLINE>
      <FPCLINE>*                                  Invoice Tax not calculating properly*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 14-JUL-2015 ASK     E2DK913988   D2_OTC_FDD_0014 : Defect#8616 For   *</FPCLINE>
      <FPCLINE>*                                  ZCPR order invoice all componenet   *</FPCLINE>
      <FPCLINE>*                                  should be considered as normal item *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 22-JUL-2015 VGAUR   E2DK913988   D2_OTC_FDD_0014 : Defect# 8720 For  *</FPCLINE>
      <FPCLINE>*                                  Quantity in Batch Split materials   *</FPCLINE>
      <FPCLINE>*                                  scenario                            *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 24-JUL-2015 RNATHAK E2DK913988   D2_OTC_FDD_0014 : Defect# 8835 For  *</FPCLINE>
      <FPCLINE>*                                  Bill To - PO Box display            *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 10-Aug-2015 RNATHAK E2DK914604   D2_OTC_FDD_0014 : Defect# 8894 For  *</FPCLINE>
      <FPCLINE>*                                  Company and Remit to address fix    *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 18-Dec-2015 MGARG    E2DK916297  D2_OTC_FDD_0014 : Defect#326 fixed  *</FPCLINE>
      <FPCLINE>*                                  Footer issue,Address adjustment acc *</FPCLINE>
      <FPCLINE>*                                  to envelope,</FPCLINE>
      <FPCLINE>*                                  Added logic for conditiontype &quot;ZCFI&quot;*</FPCLINE>
      <FPCLINE>*                                  Logic for insuarnce charges and doc *</FPCLINE>
      <FPCLINE>*                                  charges                             *</FPCLINE>
      <FPCLINE>* 17-Aug-2016 AMOHAPA  E2DK918662  D2_OTC_FDD_0014_Defect#1919         *</FPCLINE>
      <FPCLINE>*                                  Restocking Fees has been added for  *</FPCLINE>
      <FPCLINE>*                                  Billing Type &apos;ZG2&apos; and &apos;ZRE&apos; and    *</FPCLINE>
      <FPCLINE>*                                  condition type &apos;ZRST&apos;.</FPCLINE>
      <FPCLINE>*                                  For company code 3000 singapore Tax *</FPCLINE>
      <FPCLINE>*                                  invoice print Telephone,fax  number,*</FPCLINE>
      <FPCLINE>*                                  Tax Indicator &amp; percentage and      *</FPCLINE>
      <FPCLINE>*                                  Exchange Rate.                      *</FPCLINE>
      <FPCLINE>*                                  In Bill to Partner Attn To:Accounts *</FPCLINE>
      <FPCLINE>*                                  Payable Team has been added,if it is*</FPCLINE>
      <FPCLINE>*                                  maintained in customer master       *</FPCLINE>
      <FPCLINE>* 02-May-2019 Ram      E2DK923696  D3_OTC_FDD_0014_Customer Invoice Form</FPCLINE>
      <FPCLINE>*                                  PCR# 604 Defect# 8904               *</FPCLINE>
      <FPCLINE>*                                  Addiding Customer Master Material no*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 18-May-2019 U105235  E2DK923986   D3_OTC_FDD_0088 : Defect# 9572     *</FPCLINE>
      <FPCLINE>*                                   Proforma invoice changes for US and*</FPCLINE>
      <FPCLINE>*                                   EU regions                         *</FPCLINE>
      <FPCLINE>* 24-Jun-2019 U105322  E2DK923696  D3_OTC_FDD_0088 : Defect# 8904      *</FPCLINE>
      <FPCLINE>*                                  Customer Master Material text is    *</FPCLINE>
      <FPCLINE>*                                  getting cleared.                    *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 30-Sep-2019 U105235  E2DK927081   Defect#10637 proforma invoice is   *</FPCLINE>
      <FPCLINE>*                                   failing becoz of the change in the *</FPCLINE>
      <FPCLINE>*                                   billing type                       *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 17-Oct-2019 RNATHAK  E2DK927557   Defect#10787 INC0522539-01         *</FPCLINE>
      <FPCLINE>*                                   TAX not printing on Canada Invoices*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>constants :</FPCLINE>
      <FPCLINE>lc_we       type char2      value &apos;WE&apos;,                                 &quot; We of type CHAR2</FPCLINE>
      <FPCLINE>                                                                        &quot; We of type CHAR2</FPCLINE>
      <FPCLINE>lc_re       type char2      value &apos;RE&apos;,                                 &quot; Re of type CHAR2</FPCLINE>
      <FPCLINE>                                                                        &quot; Re of type CHAR2</FPCLINE>
      <FPCLINE>lc_rg       type char2      value &apos;RG&apos;,                                 &quot; Rg of type CHAR2</FPCLINE>
      <FPCLINE>                                                                        &quot; Rg of type CHAR2</FPCLINE>
      <FPCLINE>lc_m        type char1      value &apos;M&apos;,                                  &quot; M of type CHAR1</FPCLINE>
      <FPCLINE>                                                                        &quot; M of type CHAR1</FPCLINE>
      <FPCLINE>lc_o        type char1      value &apos;O&apos;,                                  &quot; O of type CHAR1</FPCLINE>
      <FPCLINE>                                                                        &quot; O of type CHAR1</FPCLINE>
      <FPCLINE>lc_p        type char1      value &apos;P&apos;,                                  &quot; P of type CHAR1</FPCLINE>
      <FPCLINE>                                                                        &quot; P of type CHAR1</FPCLINE>
      <FPCLINE>lc_z1       type char2      value &apos;Z1&apos;,                                 &quot; Z1 of type CHAR2</FPCLINE>
      <FPCLINE>                                                                        &quot; Z1 of type CHAR2</FPCLINE>
      <FPCLINE>lc_invoice  type tdobname   value &apos;ZOTC_INVOICE&apos;,                       &quot; Name</FPCLINE>
      <FPCLINE>                                                                        &quot;&apos;Invoice&apos;,</FPCLINE>
      <FPCLINE>lc_credit   type tdobname   value &apos;ZOTC_CREDIT_MEMO&apos;,                   &quot; Name</FPCLINE>
      <FPCLINE>                                                                        &quot; Name</FPCLINE>
      <FPCLINE>lc_debit    type tdobname   value &apos;ZOTC_DEBIT_MEMO&apos;,                    &quot; Name</FPCLINE>
      <FPCLINE>                                                                        &quot; Name</FPCLINE>
      <FPCLINE>lc_d        type char1      value &apos;D&apos;,                                  &quot; D of type CHAR1</FPCLINE>
      <FPCLINE>                                                                        &quot; D of type CHAR1</FPCLINE>
      <FPCLINE>lc_comma    type char1      value &apos;,&apos;,                                  &quot; Comma of type CHAR1</FPCLINE>
      <FPCLINE>                                                                        &quot; Comma of type CHAR1</FPCLINE>
      <FPCLINE>lc_dcomma   type char2      value &apos;,,&apos;,                                 &quot; Dcomma of type CHAR2</FPCLINE>
      <FPCLINE>                                                                        &quot; Dcomma of type CHAR2</FPCLINE>
      <FPCLINE>lc_zfrc     type char4      value &apos;ZFRC&apos;,                               &quot; Zfrc of type CHAR4</FPCLINE>
      <FPCLINE>                                                                        &quot; Zfrc of type CHAR4</FPCLINE>
      <FPCLINE>lc_zhdl     type char4      value &apos;ZHDL&apos;,                               &quot; Zhdl of type CHAR4</FPCLINE>
      <FPCLINE>                                                                        &quot; Zhdl of type CHAR4</FPCLINE>
      <FPCLINE>lc_zdng     type char4      value &apos;ZDNG&apos;,                               &quot; Zdng of type CHAR4</FPCLINE>
      <FPCLINE>                                                                        &quot; Zdng of type CHAR4</FPCLINE>
      <FPCLINE>lc_erf      type char3      value &apos;ERF&apos;,                                &quot; Erf of type CHAR3</FPCLINE>
      <FPCLINE>                                                                        &quot; Erf of type CHAR3</FPCLINE>
      <FPCLINE>lc_zb00     type char4      value &apos;ZB00&apos;,                               &quot; Zb00 of type CHAR4</FPCLINE>
      <FPCLINE>                                                                        &quot; Zb00 of type CHAR4</FPCLINE>
      <FPCLINE>lc_vkorg    type vkorg      value &apos;1000&apos;,                               &quot; Sales Organization</FPCLINE>
      <FPCLINE>                                                                        &quot; Sales Organization</FPCLINE>
      <FPCLINE>lc_vtweg    type vtweg      value &apos;10&apos;,                                 &quot; Distribution Channel</FPCLINE>
      <FPCLINE>                                                                        &quot; Distribution Channel</FPCLINE>
      <FPCLINE>lc_mactive  type ain_epc_active_ind value &apos;X&apos;,                          &quot; Active or Inactive Indicator</FPCLINE>
      <FPCLINE>                                                                        &quot; Active or Inactive Indicator</FPCLINE>
      <FPCLINE>lc_option   type rmsae_option       value &apos;EQ&apos;,                         &quot; Selection Option</FPCLINE>
      <FPCLINE>                                                                        &quot; Selection Option</FPCLINE>
      <FPCLINE>lc_minus    type char1              value &apos;-&apos;,                          &quot; Minus of type CHAR1</FPCLINE>
      <FPCLINE>                                                                        &quot; Minus of type CHAR1</FPCLINE>
      <FPCLINE>lc_program  type programm      value &apos;ZOTCP0014O_INVOICE_FORM&apos;,         &quot; ABAP Program Name</FPCLINE>
      <FPCLINE>                                                                        &quot; ABAP Program Name</FPCLINE>
      <FPCLINE>lc_graphics    type tdobjectgr value &apos;GRAPHICS&apos;,                        &quot; SAPscript Graphics Management: Application object</FPCLINE>
      <FPCLINE>                                                                        &quot; SAPscript Graphics Management: Application object</FPCLINE>
      <FPCLINE>lc_draft_image type tdobname   value &apos;ZOTC_DRAFT&apos;,                      &quot; Name</FPCLINE>
      <FPCLINE>                                                                        &quot; Name</FPCLINE>
      <FPCLINE>lc_logo_image  type tdobname   value &apos;ZBIORAD_LOGO&apos;,                    &quot; Name</FPCLINE>
      <FPCLINE>                                                                        &quot; Name</FPCLINE>
      <FPCLINE>lc_image_id    type tdidgr     value &apos;BMAP&apos;,                            &quot; SAPscript Graphics Management: ID</FPCLINE>
      <FPCLINE>                                                                        &quot; SAPscript Graphics Management: ID</FPCLINE>
      <FPCLINE>lc_image_type  type tdbtype    value &apos;BCOL&apos;,</FPCLINE>
      <FPCLINE>lc_prod_name   type rvari_vnam value &apos;ZPRODUCTION&apos;,                     &quot; ABAP: Name of Variant Variable</FPCLINE>
      <FPCLINE>                                                                        &quot; ABAP: Name of Variant Variable</FPCLINE>
      <FPCLINE>lc_en   type spras value &apos;E&apos;,                                           &quot; Language Key</FPCLINE>
      <FPCLINE>                                                                        &quot; language</FPCLINE>
      <FPCLINE>lc_obj  type tdobject value &apos;VBBK&apos;,                                     &quot; Texts: Application Object</FPCLINE>
      <FPCLINE>                                                                        &quot; Object type</FPCLINE>
      <FPCLINE>lc_id   type tdid value &apos;Z006&apos;,                                         &quot; Text ID</FPCLINE>
      <FPCLINE>                                                                        &quot; Object ID, requested by Sachin to use Z006 instead of Z009</FPCLINE>
      <FPCLINE>lc_kinak type kinak value space,                                        &quot; Condition is inactive</FPCLINE>
      <FPCLINE>                                                                        &quot; Condition is inactive</FPCLINE>
      <FPCLINE>lc_koaid type koaid value &apos;B&apos;,                                          &quot; Condition class</FPCLINE>
      <FPCLINE>                                                                        &quot; Condition class</FPCLINE>
      <FPCLINE>lc_kntyp type kntyp value &apos;G&apos;,                                          &quot; Condition category (examples: tax, freight, price, cost)</FPCLINE>
      <FPCLINE>                                                                        &quot; Condition category (examples: tax, freight, price, cost)</FPCLINE>
      <FPCLINE>lc_ap    type parvw value &apos;AP&apos;,                                         &quot; Partner Function</FPCLINE>
      <FPCLINE>                                                                        &quot; Partner Function</FPCLINE>
      <FPCLINE>lc_address_type type szad_field-addr_type value &apos;1&apos;,</FPCLINE>
      <FPCLINE>lc_credit_card  type dzterm_bez value &apos;Credit Card&apos;,                    &quot; Description of terms of payment</FPCLINE>
      <FPCLINE>                                                                        &quot; Description of terms of payment</FPCLINE>
      <FPCLINE>lc_us           type ad_ctry_fr value  &apos;US&apos;,                            &quot; Sender country for address formatting</FPCLINE>
      <FPCLINE>                                                                        &quot; Sender country for address formatting</FPCLINE>
      <FPCLINE>lc_prog         type rvari_vnam value &apos;ZOTC0014_INVOICE_FORM_BILLING&apos;,  &quot; ABAP: Name of Variant Variable</FPCLINE>
      <FPCLINE>                                                                        &quot; ABAP: Name of Variant Variable</FPCLINE>
      <FPCLINE>lc_prog2        type rvari_vnam value &apos;ZOTC0014_INVOICE_FORM_BILLING1&apos;, &quot; ABAP: Name of Variant Variable</FPCLINE>
      <FPCLINE>                                                                        &quot; ABAP: Name of Variant Variable</FPCLINE>
      <FPCLINE>lc_payment_text  type tdobname value &apos;ZOTC_INVOICE_PAYMENT_TEXT&apos;,       &quot; Name</FPCLINE>
      <FPCLINE>                                                                        &quot; Name</FPCLINE>
      <FPCLINE>lc_payment_text2 type tdobname value &apos;ZOTC_INVOICE_PAYMENT_TEXT2&apos;,      &quot; Name</FPCLINE>
      <FPCLINE>                                                                        &quot; Name</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Begin of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE>lc_colon        type char01 value &apos;:&apos;, &quot;Colon</FPCLINE>
      <FPCLINE>*&amp;--End of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE>lc_ztfr         type kschl  value &apos;ZTFR&apos;, &quot; ADD ADAS1 CR#313</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>lc_bomhdr   type char1     value &apos;H&apos;                  , &quot;BOM Header</FPCLINE>
      <FPCLINE>lc_bomitm   type char1     value &apos;I&apos;                  , &quot;BOM Item</FPCLINE>
      <FPCLINE>lc_fedtax   type tdobname  value &apos;ZOTC_0014_FEDTAXID&apos; , &quot;Subtotal</FPCLINE>
      <FPCLINE>lc_cfi      type tdobname  value &apos;ZOTC_0014_CFIDISC&apos;  , &quot;CFI Discount</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>lc_notax    type tdobname  value &apos;ZOTC_0014_NOTAX&apos;    , &quot;No Tax Indicator</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>lc_uecha    type uecha     value &apos;009000&apos;             , &quot;Dummy Higher-Level Item of Batch Split Item</FPCLINE>
      <FPCLINE>lc_bomitm_l type flag      value &apos;L&apos;                  , &quot;Last BOM Component</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>lc_star     type char3     value &apos;***&apos;                , &quot;Material number</FPCLINE>
      <FPCLINE>lc_begin    type char15    value &apos;Begin of BOM&apos;       , &quot;Start of BOM</FPCLINE>
      <FPCLINE>lc_end      type char15    value &apos;End of BOM&apos;         , &quot;End of BOM</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>lc_hdr_id   type tdid      value &apos;Z009&apos;               , &quot;Object ID - &apos;Z009&apos;</FPCLINE>
      <FPCLINE>lc_id_std   type tdid      value &apos;ST&apos;                 , &quot;Text ID</FPCLINE>
      <FPCLINE>lc_text     type tdobject  value &apos;TEXT&apos;               , &quot;Texts: application object</FPCLINE>
      <FPCLINE>lc_undrscr  type char1     value &apos;_&apos;                  , &quot;Underscore</FPCLINE>
      <FPCLINE>lc_opn      type char2     value &apos; (&apos;                 , &quot;Open bracket</FPCLINE>
      <FPCLINE>lc_cls      type char1     value &apos;)&apos;                  , &quot;Closing bracket</FPCLINE>
      <FPCLINE>lc_nast     type char30    value &apos;(RSNAST00)NAST&apos;,      &quot;Nast table access</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>lc_fein        type tdobname  value &apos;ZOTC_0014_FEIN&apos;,      &quot; Name</FPCLINE>
      <FPCLINE>lc_gstreg      type tdobname  value &apos;ZOTC_0014_RST&apos;,       &quot; Name</FPCLINE>
      <FPCLINE>lc_comreg      type tdobname  value &apos;ZOTC_0014_COREG&apos;,     &quot; Name</FPCLINE>
      <FPCLINE>lc_remitto_sgp type tdobname  value &apos;ZOTC_0014_REMIT_SGP&apos;, &quot; Name</FPCLINE>
      <FPCLINE>lc_zins        type kschl     value &apos;ZINS&apos;,                &quot; Condition Type</FPCLINE>
      <FPCLINE>lc_zdoc        type kschl     value &apos;ZDOC&apos;,                &quot; Condition Type</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*----&gt;Begin of Change Defect# 8904</FPCLINE>
      <FPCLINE>lc_cmir        type tdobname  value &apos;ZOTC_0014_CMIR&apos;.      &quot; SO10 Text Name - Defect# 8904</FPCLINE>
      <FPCLINE>*----&gt;End of Change Defect# 8904</FPCLINE>
      <FPCLINE/>
      <FPCLINE>data :  lv_kkber   type kkber,                  &quot; Credit Control Area</FPCLINE>
      <FPCLINE>        lv_low     type tvarv_val,              &quot; ABAP/4: Selection value (LOW or HIGH value, external format)</FPCLINE>
      <FPCLINE>        lv_sbgrp   type sbgrp_cm,               &quot; Credit representative group for credit management</FPCLINE>
      <FPCLINE>        lv_obknr   type objknr,                 &quot; Object list number</FPCLINE>
      <FPCLINE>        lv_sernr   type sernr,                  &quot; BOM explosion number</FPCLINE>
      <FPCLINE>        lv_temp    type char20,                 &quot; Temp of type CHAR20</FPCLINE>
      <FPCLINE>        li_objk    type ty_t_objk,</FPCLINE>
      <FPCLINE>        li_komv    type standard table of komv, &quot; Pricing Communications-Condition Record</FPCLINE>
      <FPCLINE>        li_vbpa    type standard table of vbpa, &quot; Sales Document: Partner</FPCLINE>
      <FPCLINE>        lv_prod    type sysysid,                &quot; Name of the SAP System</FPCLINE>
      <FPCLINE>        lv_tempvalue type kbetr,                &quot; Rate (condition amount or percentage)</FPCLINE>
      <FPCLINE>        li_low     type standard table of ty_low,</FPCLINE>
      <FPCLINE>        li_low2    type standard table of ty_low,</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        li_komv_tmp type standard table of komv,  &quot; Pricing Communications-Condition Record</FPCLINE>
      <FPCLINE>        li_t001z    type standard table of ty_t001z,</FPCLINE>
      <FPCLINE>        li_lines    type standard table of tline, &quot; SAPscript: Text Lines</FPCLINE>
      <FPCLINE>        lv_gstregno type stceg,                   &quot; VAT Registration Number</FPCLINE>
      <FPCLINE>        lv_coregno  type paval,                   &quot; Parameter value</FPCLINE>
      <FPCLINE>        lv_fein     type paval,                   &quot; Parameter value</FPCLINE>
      <FPCLINE>        li_fein_com type ty_t_bukrs,</FPCLINE>
      <FPCLINE>        li_regno_com type ty_t_bukrs,</FPCLINE>
      <FPCLINE>        lwa_txtval  type ty_stdtxt,</FPCLINE>
      <FPCLINE>        lv_party_coreg type party,                &quot;   &apos;CGIID1&apos;,              &quot; Parameter type</FPCLINE>
      <FPCLINE>        lv_party_fein  type party,                &quot; &apos;WT_TAX&apos;,              &quot; Parameter type</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        lv_name    type tdobname, &quot;  Name of the object as delivery</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>*        li_vbap    TYPE STANDARD TABLE OF ty_vbap, &quot; For quantity ordered</FPCLINE>
      <FPCLINE>        li_txtid     type ty_t_txtid ,     &quot;Header Text ID</FPCLINE>
      <FPCLINE>        li_txtlines  type ty_t_lines ,     &quot;Header Text Lines</FPCLINE>
      <FPCLINE>        li_vbap      type ty_t_vbap  ,     &quot;Sales Document: Item Data</FPCLINE>
      <FPCLINE>        li_vbrp      type ty_t_vbrp  ,     &quot;Billing Document : Item Data</FPCLINE>
      <FPCLINE>        li_perc_cond type ty_t_perc_cond , &quot;Percentage/Condition</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE>        li_vbkd      type ty_t_vbkd  , &quot;Sales Document: Business Data</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>        li_lips      type ty_t_batch , &quot;SD document: Delivery: Item data</FPCLINE>
      <FPCLINE>        li_ser01     type ty_t_ser01 , &quot;Serial Numbers for Delivery</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>        li_fplt      type ty_t_fplt  , &quot;Billing Plan: Dates</FPCLINE>
      <FPCLINE>        lwa_notax    type ty_stdtxt  , &quot;No Tax Indicator</FPCLINE>
      <FPCLINE>        lwa_fplt     type ty_fplt    , &quot;Billing Plan: Dates</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>        lwa_cfitxt   type ty_stdtxt  , &quot;Standard text with value</FPCLINE>
      <FPCLINE>        lwa_tdobj    type ty_tdobject, &quot;Standatd text object</FPCLINE>
      <FPCLINE>        lwa_t001z    type t001z      , &quot;Additional Specifications for Company Code</FPCLINE>
      <FPCLINE>        lwa_cond     type ty_cond    , &quot;Condition type</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE>        lwa_item1    type ty_item1   , &quot;Final output</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE>        lv_nastspras type spras      , &quot;Language Key</FPCLINE>
      <FPCLINE>        lv_ca        type lland      , &quot;Canada</FPCLINE>
      <FPCLINE>        lv_us        type lland      , &quot;USA</FPCLINE>
      <FPCLINE>        lv_aubel     type vbeln_vauf , &quot;Order</FPCLINE>
      <FPCLINE>        lv_aupos     type posnr_va   , &quot;Sales Document Item</FPCLINE>
      <FPCLINE>        lv_vbeln     type vbeln      , &quot;Sales and Distribution Document Number</FPCLINE>
      <FPCLINE>        lv_posnr     type posnr      , &quot;Item number of the SD document</FPCLINE>
      <FPCLINE>        lv_vbelnpos  type tdobname   , &quot;Billing document number and Item number</FPCLINE>
      <FPCLINE>        lv_flag      type flag       , &quot;Flag check</FPCLINE>
      <FPCLINE>        lv_bom       type char1      , &quot;Non BOM / BOM Header / BOM Item</FPCLINE>
      <FPCLINE>        lv_value     type char20     , &quot;Value</FPCLINE>
      <FPCLINE>        lv_cfi2      type char20     , &quot;CFI Discount</FPCLINE>
      <FPCLINE>        lv_advpmt    type wrbtr      , &quot;Advance payment</FPCLINE>
      <FPCLINE>        lv_advpmt2   type char20     , &quot;Advance payment</FPCLINE>
      <FPCLINE>        lv_fintot    type kbetr      , &quot;Final total</FPCLINE>
      <FPCLINE>        lv_fintot2   type char20     , &quot;Final total</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>        lv_kwert1    type kwert      , &quot;Condition value for XR1</FPCLINE>
      <FPCLINE>        lv_kwert2    type kwert      , &quot;Condition value for XR2</FPCLINE>
      <FPCLINE>        lv_kwert3    type kwert      , &quot;Condition value for XR3</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>        lv_uecha     type uecha      ,    &quot;Dummy Higher-Level Item of Batch Split Item</FPCLINE>
      <FPCLINE>        lv_uecha_bom type uecha      ,    &quot;Dummy Higher-Level Item of Batch Split Item for BOM</FPCLINE>
      <FPCLINE>        lv_tabix     type int2       ,    &quot;Current line number</FPCLINE>
      <FPCLINE>        lv_lief_nr   type vbeln_vl   ,    &quot;Delivery</FPCLINE>
      <FPCLINE>        lv_posnr_vl  type posnr_vl   ,    &quot;Delivery Item</FPCLINE>
      <FPCLINE>        lv_bommat    type matnr      ,    &quot;Material Number</FPCLINE>
      <FPCLINE>        lv_next      type int2       ,    &quot;Next record line number</FPCLINE>
      <FPCLINE>        li_bomhdrtxt type wcb_tdline_tab, &quot; Text Line</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>        lv_subsidiary type flag      , &quot; General Flag</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>        lv_mwsbp      type mwsbp , &quot; Tax amount in document currency</FPCLINE>
      <FPCLINE>        lv_zcfi       type arktx , &quot; Short text for sales order item</FPCLINE>
      <FPCLINE>        lv_strlen     type int2  , &quot; String length</FPCLINE>
      <FPCLINE>        lv_last       type int2  , &quot; Last line</FPCLINE>
      <FPCLINE>        lv_bom_stlnr  type stnum , &quot; Bill of material</FPCLINE>
      <FPCLINE>        lv_bom_posnr  type uepos.  &quot; Higher-level item in bill of material structures</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#8548 by SMUKHER</FPCLINE>
      <FPCLINE>data:  lv_tax   type kbetr, &quot; Tax to be Calculated</FPCLINE>
      <FPCLINE>       lv_mtart type mtart, &quot; Material Type</FPCLINE>
      <FPCLINE>       li_mara  type standard table of ty_mara.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#8548 by SMUKHER</FPCLINE>
      <FPCLINE/>
      <FPCLINE>data : li_auart type ty_t_auart, &quot; Order Type Internal Table Defect 8616</FPCLINE>
      <FPCLINE>       lv_auart type auart,      &quot; Order Type Defect 8616</FPCLINE>
      <FPCLINE>       lv_kdmat type knmt-kdmat. &quot; Customer Material Number Defect# 8904</FPCLINE>
      <FPCLINE/>
      <FPCLINE>field-symbols :</FPCLINE>
      <FPCLINE>  &lt;lwa_item_detail&gt; type invoice_s_prt_item_detail, &quot; Items Detail for PDF Print</FPCLINE>
      <FPCLINE>  &lt;lwa_vbpa&gt;  type vbpa,                            &quot; Sales Document: Partner</FPCLINE>
      <FPCLINE>  &lt;lwa_lips&gt;  type ty_lips,</FPCLINE>
      <FPCLINE>  &lt;lwa_item&gt;  type ty_item,</FPCLINE>
      <FPCLINE>  &lt;lwa_komv&gt;  type komv,                            &quot; Pricing Communications-Condition Record</FPCLINE>
      <FPCLINE>  &lt;lwa_objk&gt;  type ty_objk,</FPCLINE>
      <FPCLINE>  &lt;lwa_item1&gt; type ty_item1,</FPCLINE>
      <FPCLINE>  &lt;lwa_item1_temp&gt; type ty_item1, &quot;Added for Defect# 8904</FPCLINE>
      <FPCLINE>  &lt;lwa_low&gt;   type ty_low,</FPCLINE>
      <FPCLINE>  &lt;lwa_low2&gt;  type ty_low,</FPCLINE>
      <FPCLINE>  &lt;lwa_vbap&gt;  type ty_vbap,                         &quot; For quantity ordered</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>  &lt;lfs_txtid&gt;  type ty_txtid    , &quot; Header Text ID</FPCLINE>
      <FPCLINE>  &lt;lfs_percon&gt; type ty_perc_cond, &quot; Percentage/Condition combination</FPCLINE>
      <FPCLINE>  &lt;lfs_vbrp&gt;   type ty_vbrp     , &quot; Billing Document</FPCLINE>
      <FPCLINE>  &lt;lfs_nast&gt;   type nast        , &quot; Message Status</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>  &lt;lfs_fplt&gt;   type ty_fplt     , &quot; Billing Plan: Dates</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE>  &lt;lfs_vbkd&gt;   type ty_vbkd     , &quot; Sales Document: Business Data</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>  &lt;lfs_item1&gt;   type ty_item1, &quot; Item table</FPCLINE>
      <FPCLINE>  &lt;lfs_ser01&gt;   type ty_ser01, &quot; Serial number</FPCLINE>
      <FPCLINE>  &lt;lfs_lips&gt;    type ty_batch, &quot; Batch split from Delivery</FPCLINE>
      <FPCLINE>  &lt;lwa_bomitem&gt; type ty_item , &quot; Item table</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>  &lt;lfs_bomhdr&gt; type ty_item , &quot; Item line</FPCLINE>
      <FPCLINE>  &lt;lfs_item&gt;   type ty_vbrp,  &quot; BOM Item</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>&lt;lfs_lines&gt;    type tline, &quot; SAPscript: Text Lines</FPCLINE>
      <FPCLINE>&lt;lfs_t001z&gt;    type ty_t001z.</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>data:  lv_restock       type kwert,                      &quot;Local variable for restock value</FPCLINE>
      <FPCLINE>       lv_fax           type char20,                     &quot;Local variable for fax number(singapore)</FPCLINE>
      <FPCLINE>       lv_tel           type char20,                     &quot;Local variable for telephone number(singapore)</FPCLINE>
      <FPCLINE>       li_fkart         type standard table of ty_fkart, &quot;Local internal table for storing billing type value from EMI</FPCLINE>
      <FPCLINE>       lv_tel_emi       type char20,                     &quot;Local variable for fax number coming from emi</FPCLINE>
      <FPCLINE>       lv_fax_emi       type char20,                     &quot;Local variable for telephone number coming from emi</FPCLINE>
      <FPCLINE>       li_kschl         type standard table of ty_kschl, &quot;Local internal table for storing condition type value from EMI</FPCLINE>
      <FPCLINE>       lv_gjahr         type gjahr,                      &quot;Local variable for fiscal year</FPCLINE>
      <FPCLINE>       lv_kurrf         type kurrf.                      &quot;Local constant for Exchange rate</FPCLINE>
      <FPCLINE/>
      <FPCLINE>constants: lc_tel   type tdobname  value &apos;ZOTC_0014_TEL&apos;, &quot;SAP script for &apos;TEL&apos;</FPCLINE>
      <FPCLINE>           lc_fax   type tdobname  value &apos;ZOTC_0014_FAX&apos;. &quot;SAP script for &apos;FAX&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>assign (lc_nast) to &lt;lfs_nast&gt;.</FPCLINE>
      <FPCLINE>lv_nastspras = &lt;lfs_nast&gt;-spras.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5656 by APODDAR</FPCLINE>
      <FPCLINE>lv_vbtyp = bil_prt_com-head_detail-vbdkr-vbtyp.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5656 by APODDAR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---Begin of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>*storing the billing type field value in a global variable which can be used later</FPCLINE>
      <FPCLINE>    gv_fkart = bil_prt_com-head_detail-vbdkr-fkart.</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>* Logic for Header...</FPCLINE>
      <FPCLINE>if bil_prt_com-head_detail-vbdkr-vbtyp = lc_m.</FPCLINE>
      <FPCLINE>  gv_name = lc_invoice.</FPCLINE>
      <FPCLINE>endif. &quot; IF bil_prt_com-head_detail-vbdkr-vbtyp = lc_m</FPCLINE>
      <FPCLINE>if bil_prt_com-head_detail-vbdkr-vbtyp = lc_o.</FPCLINE>
      <FPCLINE>  gv_name = lc_credit.</FPCLINE>
      <FPCLINE>endif. &quot; IF bil_prt_com-head_detail-vbdkr-vbtyp = lc_o</FPCLINE>
      <FPCLINE>if bil_prt_com-head_detail-vbdkr-vbtyp = lc_p.</FPCLINE>
      <FPCLINE>  gv_name = lc_debit.</FPCLINE>
      <FPCLINE>endif. &quot; IF bil_prt_com-head_detail-vbdkr-vbtyp = lc_p</FPCLINE>
      <FPCLINE/>
      <FPCLINE>lv_name = bil_prt_com-head_detail-vbdkr-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* CR-508 : Begin of changes : SNIGAM : 10-Jul-2013</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* The code to display the Document Header text is placed</FPCLINE>
      <FPCLINE>* inside the Subroutine - POPULATE_HEADER_TEXT. Please</FPCLINE>
      <FPCLINE>* find the changes there.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>* CR-508 : End of changes : SNIGAM : 10-Jul-2013</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching partner data...</FPCLINE>
      <FPCLINE>select *</FPCLINE>
      <FPCLINE>  from vbpa &quot; Sales Document: Partner</FPCLINE>
      <FPCLINE>  into table li_vbpa</FPCLINE>
      <FPCLINE> where vbeln = bil_prt_com-head_detail-vbdkr-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Ship to Address details</FPCLINE>
      <FPCLINE>  perform f_get_address  using lc_we</FPCLINE>
      <FPCLINE>                               li_vbpa</FPCLINE>
      <FPCLINE>                      changing wa_shipto</FPCLINE>
      <FPCLINE>                               gv_adrnr1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  read table li_vbpa</FPCLINE>
      <FPCLINE>   assigning &lt;lwa_vbpa&gt;</FPCLINE>
      <FPCLINE>    with key parvw = lc_ap.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    select</FPCLINE>
      <FPCLINE>    single name1      &quot; Name 1</FPCLINE>
      <FPCLINE>           tel_number &quot; First telephone no.: dialling code+number</FPCLINE>
      <FPCLINE>      from adrc       &quot; Addresses (Business Address Services)</FPCLINE>
      <FPCLINE>      into (wa_sales-name1     ,</FPCLINE>
      <FPCLINE>            wa_sales-tel_number)</FPCLINE>
      <FPCLINE>     where addrnumber = &lt;lwa_vbpa&gt;-adrnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Bill to Address details</FPCLINE>
      <FPCLINE>  perform f_get_address  using lc_re</FPCLINE>
      <FPCLINE>                               li_vbpa</FPCLINE>
      <FPCLINE>                      changing wa_billto</FPCLINE>
      <FPCLINE>                               gv_adrnr2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching sales person...</FPCLINE>
      <FPCLINE>  read table li_vbpa</FPCLINE>
      <FPCLINE>   assigning &lt;lwa_vbpa&gt;</FPCLINE>
      <FPCLINE>    with key parvw = lc_z1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    select</FPCLINE>
      <FPCLINE>    single name1 &quot; Name 1</FPCLINE>
      <FPCLINE>      from kna1  &quot; General Data in Customer Master</FPCLINE>
      <FPCLINE>      into wa_purchase-ernam</FPCLINE>
      <FPCLINE>     where kunnr = &lt;lwa_vbpa&gt;-kunnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching adress numbers</FPCLINE>
      <FPCLINE>  select</FPCLINE>
      <FPCLINE>  single adrnr &quot; Address</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        stceg &quot;VAT Registration Number</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>    from t001 &quot; Company Codes</FPCLINE>
      <FPCLINE>    into (gv_adrnr3,</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>    lv_gstregno)</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>   where bukrs = bil_prt_com-head_detail-vbdkr-bukrs.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  select</FPCLINE>
      <FPCLINE>  single adrnr &quot; Address</FPCLINE>
      <FPCLINE>    from t049l &quot; Lockboxes at our House Banks</FPCLINE>
      <FPCLINE>    into gv_adrnr4</FPCLINE>
      <FPCLINE>   where bukrs = bil_prt_com-head_detail-vbdkr-bukrs.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>* Fetch the Address details based on the Address number</FPCLINE>
      <FPCLINE>    select name1      &quot; Name 1</FPCLINE>
      <FPCLINE>           name2      &quot; Name 2</FPCLINE>
      <FPCLINE>           name3      &quot; Name 3</FPCLINE>
      <FPCLINE>           name4      &quot; Name 4</FPCLINE>
      <FPCLINE>           city1      &quot; City</FPCLINE>
      <FPCLINE>           city2      &quot; District</FPCLINE>
      <FPCLINE>           post_code1 &quot; City postal code</FPCLINE>
      <FPCLINE>           post_code2 &quot; Po Box post code &quot; Defect 8894</FPCLINE>
      <FPCLINE>           po_box     &quot; PO Box</FPCLINE>
      <FPCLINE>           street     &quot; Street</FPCLINE>
      <FPCLINE>           house_num1 &quot; House Number</FPCLINE>
      <FPCLINE>           house_num2 &quot; House number supplement</FPCLINE>
      <FPCLINE>           country    &quot; Country Key</FPCLINE>
      <FPCLINE>           region     &quot; Region (State, Province, County)</FPCLINE>
      <FPCLINE>           tel_number &quot; First telephone no.: dialling code+number</FPCLINE>
      <FPCLINE>        up to 1 rows</FPCLINE>
      <FPCLINE>      from adrc       &quot; Addresses (Business Address Services)</FPCLINE>
      <FPCLINE>      into wa_remitto</FPCLINE>
      <FPCLINE>     where addrnumber = gv_adrnr4.</FPCLINE>
      <FPCLINE>    endselect.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if sy-subrc is initial.</FPCLINE>
      <FPCLINE>    endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>wa_purchase-land1 = bil_prt_com-head_detail-vbdkr-land1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching customer data ...</FPCLINE>
      <FPCLINE>*SELECT SINGLE bstnk_vf FROM vbrk INTO wa_purchase-bstnk_vf</FPCLINE>
      <FPCLINE>*              WHERE vbeln = bil_prt_com-head_detail-vbdkr-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch Billing Document: Header Data</FPCLINE>
      <FPCLINE>select</FPCLINE>
      <FPCLINE>single zzcaseref &quot;Case Ref No</FPCLINE>
      <FPCLINE>  from vbrk      &quot;Billing Document: Header Data</FPCLINE>
      <FPCLINE>  into wa_purchase-zzcaseref</FPCLINE>
      <FPCLINE> where vbeln = bil_prt_com-head_detail-vbdkr-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*IF sy-subrc = 0. &quot; DEL ADAS1 D#3604</FPCLINE>
      <FPCLINE>* BOC ADD ADAS1 D#3604 CR#373</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Billing Document Item data</FPCLINE>
      <FPCLINE>  select vbeln &quot; Billing Document</FPCLINE>
      <FPCLINE>         posnr &quot; Billing item</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>         vgbel &quot; Document number of the reference document</FPCLINE>
      <FPCLINE>         vgpos &quot; Item number of the reference item</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>         aubel &quot; Sales Document</FPCLINE>
      <FPCLINE>         aupos &quot; Sales Document Item</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>         kowrr &quot; Statistical values</FPCLINE>
      <FPCLINE>         mwsbp &quot; Tax amount in document currency</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>         zzquoteref &quot; Legacy Qtn Ref</FPCLINE>
      <FPCLINE>    from vbrp       &quot; Billing Document: Item Data</FPCLINE>
      <FPCLINE>    into table li_vbrp</FPCLINE>
      <FPCLINE>   where vbeln = bil_prt_com-head_detail-vbdkr-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Sort records by comparing Billing Document and Item number</FPCLINE>
      <FPCLINE>    sort li_vbrp by vgbel</FPCLINE>
      <FPCLINE>                    vgpos.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch SD document: Delivery: Item data</FPCLINE>
      <FPCLINE>    select vbeln                  &quot; Delivery</FPCLINE>
      <FPCLINE>           posnr                  &quot; Delivery Item</FPCLINE>
      <FPCLINE>           uecha                  &quot; Higher-Level Item of Batch Split Item</FPCLINE>
      <FPCLINE>      from lips                   &quot; SD document: Delivery: Item data</FPCLINE>
      <FPCLINE>      into table li_lips</FPCLINE>
      <FPCLINE>       for all entries in li_vbrp</FPCLINE>
      <FPCLINE>     where vbeln = li_vbrp-vgbel  &quot;Delivery number</FPCLINE>
      <FPCLINE>       and posnr = li_vbrp-vgpos. &quot;Item number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if sy-subrc is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Sort records by comparing Reference document number and item number</FPCLINE>
      <FPCLINE>      sort li_lips by vbeln</FPCLINE>
      <FPCLINE>                      posnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Sort records by comparing the Sales document and Item number</FPCLINE>
      <FPCLINE>    sort li_vbrp by aubel</FPCLINE>
      <FPCLINE>                    aupos.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Get the Language from NACE Control Settings</FPCLINE>
      <FPCLINE>clear wa_thead.</FPCLINE>
      <FPCLINE>wa_thead-tdid     = lc_id_std. &quot;Value - &apos;ST&apos;</FPCLINE>
      <FPCLINE>wa_thead-tdobject = lc_text. &quot;Value - &apos;TEXT&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>clear wa_socl.</FPCLINE>
      <FPCLINE>wa_socl-vkorg = bil_prt_com-head_detail-vbdkr-vkorg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>condense wa_billto-region no-gaps.</FPCLINE>
      <FPCLINE>* Retrieve the country values maintained in the EMI tool</FPCLINE>
      <FPCLINE>perform f_get_emi_values  changing lv_us        &quot;Country - USA</FPCLINE>
      <FPCLINE>                                   lv_ca        &quot;Country - Canada</FPCLINE>
      <FPCLINE>                                   wa_socl      &quot;Sales Organization/City/Language combination</FPCLINE>
      <FPCLINE>                                   lwa_cond     &quot;Condition type</FPCLINE>
      <FPCLINE>                                   lwa_tdobj    &quot;Texts: Application Object</FPCLINE>
      <FPCLINE>                                   li_txtid     &quot;Header Text IDs</FPCLINE>
      <FPCLINE>                                   li_perc_cond &quot;Percentage/Condition</FPCLINE>
      <FPCLINE>                                   lv_mtart     &quot; Material type  &quot; Defect 8548</FPCLINE>
      <FPCLINE>                                   li_auart     &quot; Order Type &quot; Defect 8616</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                   li_fein_com  &quot;FEIN required comp</FPCLINE>
      <FPCLINE>                                   li_regno_com &quot; REGNO required com</FPCLINE>
      <FPCLINE>                                   lv_party_coreg</FPCLINE>
      <FPCLINE>                                   lv_party_fein</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                    li_fkart</FPCLINE>
      <FPCLINE>                                    lv_tel_emi</FPCLINE>
      <FPCLINE>                                    lv_fax_emi</FPCLINE>
      <FPCLINE>                                    li_kschl.</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Begin of Code changes - Defect 10637 - U105235 - Sep 30- 2019</FPCLINE>
      <FPCLINE>*for the proforma invoice related to distribution channel 90 and billing type ZF2</FPCLINE>
      <FPCLINE>*the data was not printed correctly because of the change in the billing type value</FPCLINE>
      <FPCLINE>*in the above form</FPCLINE>
      <FPCLINE>   lwa_tdobj-fkart  = bil_prt_com-head_detail-vbdkr-fkart.</FPCLINE>
      <FPCLINE>*End of Code changes - Defect 10637 - U105235 - Sep 30- 2019</FPCLINE>
      <FPCLINE/>
      <FPCLINE>wa_thead-tdspras = lv_nastspras. &quot;Language as per control setup</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching condition data...</FPCLINE>
      <FPCLINE>select *</FPCLINE>
      <FPCLINE>  from konv &quot; Conditions (Transaction Data)</FPCLINE>
      <FPCLINE>  into table li_komv</FPCLINE>
      <FPCLINE> where knumv = bil_prt_com-head_detail-vbdkr-knumv.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-subrc = 0.</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* There is need to keep all the records for condition type ZCFI which</FPCLINE>
      <FPCLINE>*  will used further in the program, So made a temp copy for all the records</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  li_komv_tmp[] = li_komv[].</FPCLINE>
      <FPCLINE>  sort li_komv_tmp by  knumv</FPCLINE>
      <FPCLINE>                       kposn</FPCLINE>
      <FPCLINE>                       kschl.</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Delete all the conditions whether the Condition type is</FPCLINE>
      <FPCLINE>* having the value of &apos;Inactive&apos;. Please find in the domain KINAK.</FPCLINE>
      <FPCLINE>  delete li_komv where kinak is not initial</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE>                   and kschl ne lwa_cond-cond_znet. &quot;Condition type - &apos;ZNET&apos;</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>*Exchnage rate value is coming from VBRK-KURRF</FPCLINE>
      <FPCLINE>if  bil_prt_com-head_detail-vbdkr-kurrf is not initial.</FPCLINE>
      <FPCLINE>  lv_kurrf = bil_prt_com-head_detail-vbdkr-kurrf.</FPCLINE>
      <FPCLINE>endif. &quot; IF bil_prt_com-head_detail-vbdkr-kurrf IS NOT INITIAL</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>if li_txtid is not initial.</FPCLINE>
      <FPCLINE>  loop at li_txtid assigning &lt;lfs_txtid&gt;.</FPCLINE>
      <FPCLINE>* Fetch the Document Header text</FPCLINE>
      <FPCLINE>    perform populate_header_text    using &lt;lfs_txtid&gt; &quot;Text ID - &apos;Z006&apos;/&apos;Z009&apos;/&apos;Z014&apos;</FPCLINE>
      <FPCLINE>                                          lv_name     &quot;Invoice number</FPCLINE>
      <FPCLINE>                                          lc_obj      &quot;Object type -&apos;VBBK&apos;</FPCLINE>
      <FPCLINE>                                          wa_socl     &quot;Languages</FPCLINE>
      <FPCLINE>                                 changing li_txtlines.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if li_txtlines is not initial.</FPCLINE>
      <FPCLINE>      append lines of li_txtlines to i_lines.</FPCLINE>
      <FPCLINE>    endif. &quot; IF li_txtlines IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    clear li_txtlines.</FPCLINE>
      <FPCLINE>  endloop. &quot; LOOP AT li_txtid ASSIGNING &lt;lfs_txtid&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  unassign &lt;lfs_txtid&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endif. &quot; IF li_txtid IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Additional Specifications for Company Code</FPCLINE>
      <FPCLINE>select</FPCLINE>
      <FPCLINE>  bukrs       &quot; Company Code</FPCLINE>
      <FPCLINE>  party       &quot; Parameter type</FPCLINE>
      <FPCLINE>  paval       &quot; Parameter value</FPCLINE>
      <FPCLINE>   from t001z &quot; Additional Specifications for Company Code</FPCLINE>
      <FPCLINE>   into table li_t001z</FPCLINE>
      <FPCLINE>  where bukrs = bil_prt_com-head_detail-vbdkr-bukrs.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-subrc is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** Populate FEIN</FPCLINE>
      <FPCLINE>  read table li_fein_com with key bukrs = bil_prt_com-head_detail-vbdkr-bukrs</FPCLINE>
      <FPCLINE>  transporting no fields.</FPCLINE>
      <FPCLINE>  if sy-subrc is initial.</FPCLINE>
      <FPCLINE>    read table li_t001z assigning &lt;lfs_t001z&gt;  with key party = lv_party_fein.</FPCLINE>
      <FPCLINE>    if sy-subrc is initial.</FPCLINE>
      <FPCLINE>      lv_fein = &lt;lfs_t001z&gt;-paval.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      clear lwa_txtval.</FPCLINE>
      <FPCLINE>* populate Standard text</FPCLINE>
      <FPCLINE>      perform f_populate_text_val  using lc_fein</FPCLINE>
      <FPCLINE>                                         lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         lv_fein</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         lv_nastspras</FPCLINE>
      <FPCLINE>                               changing lwa_txtval.</FPCLINE>
      <FPCLINE>      if lwa_txtval is not initial.</FPCLINE>
      <FPCLINE>        concatenate lwa_txtval-text lwa_txtval-val into gv_fein</FPCLINE>
      <FPCLINE>        separated by space.</FPCLINE>
      <FPCLINE>      endif. &quot; IF lwa_txtval IS NOT INITIAL</FPCLINE>
      <FPCLINE>    endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Only For Singapore company code</FPCLINE>
      <FPCLINE>**Co Reg No for selecetd comp(3000)</FPCLINE>
      <FPCLINE>read table li_regno_com with key bukrs = bil_prt_com-head_detail-vbdkr-bukrs</FPCLINE>
      <FPCLINE>transporting no fields.</FPCLINE>
      <FPCLINE>if sy-subrc is initial.</FPCLINE>
      <FPCLINE>  read table li_t001z assigning &lt;lfs_t001z&gt; with key party = lv_party_coreg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc is initial.</FPCLINE>
      <FPCLINE>    lv_coregno = &lt;lfs_t001z&gt;-paval.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    clear lwa_txtval.</FPCLINE>
      <FPCLINE>* populate Standard text</FPCLINE>
      <FPCLINE>    perform f_populate_text_val  using lc_comreg</FPCLINE>
      <FPCLINE>                                       lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                       lv_coregno</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       lv_nastspras</FPCLINE>
      <FPCLINE>                              changing lwa_txtval.</FPCLINE>
      <FPCLINE>    if lwa_txtval is not initial.</FPCLINE>
      <FPCLINE>      concatenate lwa_txtval-text lwa_txtval-val into gv_coregno</FPCLINE>
      <FPCLINE>      separated by space.</FPCLINE>
      <FPCLINE>    endif. &quot; IF lwa_txtval IS NOT INITIAL</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>**GSt Reg No</FPCLINE>
      <FPCLINE>  if lv_gstregno is not initial.</FPCLINE>
      <FPCLINE>    clear lwa_txtval.</FPCLINE>
      <FPCLINE>* Populate standard text</FPCLINE>
      <FPCLINE>    perform f_populate_text_val  using lc_gstreg</FPCLINE>
      <FPCLINE>                                      lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                      lv_gstregno</FPCLINE>
      <FPCLINE>                                      space</FPCLINE>
      <FPCLINE>                                      lv_nastspras</FPCLINE>
      <FPCLINE>                             changing lwa_txtval.</FPCLINE>
      <FPCLINE>    if lwa_txtval is not initial.</FPCLINE>
      <FPCLINE>      concatenate lwa_txtval-text lwa_txtval-val into gv_gstregno</FPCLINE>
      <FPCLINE>      separated by space.</FPCLINE>
      <FPCLINE>    endif. &quot; IF lwa_txtval IS NOT INITIAL</FPCLINE>
      <FPCLINE>  endif. &quot; IF lv_gstregno IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  clear lwa_txtval.</FPCLINE>
      <FPCLINE>* Populate standard text and value for telephone number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  lv_tel = lv_tel_emi.</FPCLINE>
      <FPCLINE>  perform f_populate_text_val  using lc_tel</FPCLINE>
      <FPCLINE>                                    lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                    lv_tel</FPCLINE>
      <FPCLINE>                                    space</FPCLINE>
      <FPCLINE>                                    lv_nastspras</FPCLINE>
      <FPCLINE>                           changing lwa_txtval.</FPCLINE>
      <FPCLINE>  if lwa_txtval is not initial.</FPCLINE>
      <FPCLINE>    concatenate lwa_txtval-text lwa_txtval-val into gv_tel</FPCLINE>
      <FPCLINE>    separated by space.</FPCLINE>
      <FPCLINE>  endif. &quot; IF lwa_txtval IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  clear lwa_txtval.</FPCLINE>
      <FPCLINE>* Populate standard text and value for fax number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  lv_fax = lv_fax_emi.</FPCLINE>
      <FPCLINE>  perform f_populate_text_val  using lc_fax</FPCLINE>
      <FPCLINE>                                    lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                    lv_fax</FPCLINE>
      <FPCLINE>                                    space</FPCLINE>
      <FPCLINE>                                    lv_nastspras</FPCLINE>
      <FPCLINE>                           changing lwa_txtval.</FPCLINE>
      <FPCLINE>  if lwa_txtval is not initial.</FPCLINE>
      <FPCLINE>    concatenate lwa_txtval-text lwa_txtval-val into gv_fax</FPCLINE>
      <FPCLINE>    separated by space.</FPCLINE>
      <FPCLINE>  endif. &quot; IF lwa_txtval IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if gv_gstregno is initial and gv_coregno is not initial.</FPCLINE>
      <FPCLINE>    gv_final_regno = gv_coregno.</FPCLINE>
      <FPCLINE>  else. &quot; ELSE -&gt; IF gv_gstregno IS INITIAL AND gv_coregno IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    concatenate gv_gstregno gv_coregno into gv_final_regno</FPCLINE>
      <FPCLINE>     separated by  cl_abap_char_utilities=&gt;cr_lf.</FPCLINE>
      <FPCLINE>  endif. &quot; IF gv_gstregno IS INITIAL AND gv_coregno IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>  if  gv_tel is not initial and gv_fax is not initial.</FPCLINE>
      <FPCLINE>    concatenate gv_tel gv_fax into gv_tel separated by space.</FPCLINE>
      <FPCLINE>    concatenate gv_tel cl_abap_char_utilities=&gt;cr_lf cl_abap_char_utilities=&gt;cr_lf</FPCLINE>
      <FPCLINE>    gv_final_regno into gv_final_regno.</FPCLINE>
      <FPCLINE>  endif. &quot; IF gv_tel IS NOT INITIAL AND gv_fax IS NOT INITIAL</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if wa_socl-land1 eq lv_ca. &quot;For Canada Invoice only</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Standard Text for the Condition type &apos;ZCFI&apos;</FPCLINE>
      <FPCLINE>  perform f_populate_text_val  using lc_cfi &quot;CFI Discount</FPCLINE>
      <FPCLINE>                                     space</FPCLINE>
      <FPCLINE>                                     space</FPCLINE>
      <FPCLINE>                                     space</FPCLINE>
      <FPCLINE>                                     lv_nastspras</FPCLINE>
      <FPCLINE>                            changing lwa_cfitxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Additional Specifications for Company Code</FPCLINE>
      <FPCLINE>*  SELECT *     &quot;All fields</FPCLINE>
      <FPCLINE>*    FROM t001z &quot; Additional Specifications for Company Code</FPCLINE>
      <FPCLINE>*      UP TO 1 ROWS</FPCLINE>
      <FPCLINE>*    INTO lwa_t001z</FPCLINE>
      <FPCLINE>*   WHERE bukrs = bil_prt_com-head_detail-vbdkr-bukrs.</FPCLINE>
      <FPCLINE>*  ENDSELECT.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF lwa_t001z-paval IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*      PERFORM f_populate_text_val  USING lc_fedtax &quot;Federal Tax</FPCLINE>
      <FPCLINE>*                                         lc_colon  &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>*                                         lwa_t001z-paval</FPCLINE>
      <FPCLINE>*                                         space</FPCLINE>
      <FPCLINE>*                                         lv_nastspras</FPCLINE>
      <FPCLINE>*                                CHANGING wa_federal_tax.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF lwa_t001z-paval IS NOT INITIAL</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Get the Standard text</FPCLINE>
      <FPCLINE>  call function &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>    exporting</FPCLINE>
      <FPCLINE>      id                      = lc_id_std &quot;Value - &apos;ST&apos;</FPCLINE>
      <FPCLINE>      language                = lv_nastspras</FPCLINE>
      <FPCLINE>*--&gt;Begin of Delete for D3_OTC_FDD_0014_Defect# 10787(INC0522539-01) by RNATHAK on 17-Oct-2019</FPCLINE>
      <FPCLINE>*      name                    = lc_cmir &quot;CMIR</FPCLINE>
      <FPCLINE>*&lt;--End of Delete for D3_OTC_FDD_0014_Defect# 10787(INC0522539-01) by RNATHAK on 17-Oct-2019</FPCLINE>
      <FPCLINE>*--&gt;Begin of Insert for D3_OTC_FDD_0014_Defect# 10787(INC0522539-01) by RNATHAK on 17-Oct-2019</FPCLINE>
      <FPCLINE>       name                    = lc_fedtax</FPCLINE>
      <FPCLINE>*&lt;--End of Insert for D3_OTC_FDD_0014_Defect# 10787(INC0522539-01) by RNATHAK on 17-Oct-2019</FPCLINE>
      <FPCLINE>      object                  = lc_text   &quot;Value - &apos;TEXT&apos;</FPCLINE>
      <FPCLINE>    tables</FPCLINE>
      <FPCLINE>      lines                   = i_fedtax</FPCLINE>
      <FPCLINE>    exceptions</FPCLINE>
      <FPCLINE>      id                      = 1</FPCLINE>
      <FPCLINE>      language                = 2</FPCLINE>
      <FPCLINE>      name                    = 3</FPCLINE>
      <FPCLINE>      not_found               = 4</FPCLINE>
      <FPCLINE>      object                  = 5</FPCLINE>
      <FPCLINE>      reference_check         = 6</FPCLINE>
      <FPCLINE>      wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>      others                  = 8.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endif. &quot; IF wa_socl-land1 EQ lv_ca</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* BOC ADD ADAS1 D#3604 CR#373</FPCLINE>
      <FPCLINE>if wa_purchase-bstnk_vf is initial.</FPCLINE>
      <FPCLINE>  wa_purchase-bstnk_vf = bil_prt_com-head_detail-vbdkr-bstnk.</FPCLINE>
      <FPCLINE>* EOC ADD ADAS1 D#3604 CR#373</FPCLINE>
      <FPCLINE>endif. &quot; IF wa_purchase-bstnk_vf IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Begin of Change dated 20-Jun-2012</FPCLINE>
      <FPCLINE>if bil_prt_com-head_detail-vbdkr-rplnr is not initial.</FPCLINE>
      <FPCLINE>  wa_purchase-zterm = lc_credit_card.</FPCLINE>
      <FPCLINE>else. &quot; ELSE -&gt; IF bil_prt_com-head_detail-vbdkr-rplnr IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  select</FPCLINE>
      <FPCLINE>  single vtext                        &quot; Description of terms of payment</FPCLINE>
      <FPCLINE>    into wa_purchase-zterm from tvzbt &quot; Customers: Terms of Payment Texts</FPCLINE>
      <FPCLINE>   where spras = sy-langu</FPCLINE>
      <FPCLINE>     and zterm = bil_prt_com-head_detail-vbdkr-zterm.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endif. &quot; IF bil_prt_com-head_detail-vbdkr-rplnr IS NOT INITIAL</FPCLINE>
      <FPCLINE>*End of Change dated 20-Jun-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>wa_cust-kunrg = bil_prt_com-head_detail-vbdkr-kunrg.</FPCLINE>
      <FPCLINE>wa_cust-vbeln = bil_prt_com-head_detail-vbdkr-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Start of change on 31/07/2012...</FPCLINE>
      <FPCLINE>*** Supressing Leading Zeros from Customer number and Invoice...</FPCLINE>
      <FPCLINE>call function &apos;CONVERSION_EXIT_ALPHA_OUTPUT&apos;</FPCLINE>
      <FPCLINE>  exporting</FPCLINE>
      <FPCLINE>    input  = wa_cust-kunrg</FPCLINE>
      <FPCLINE>  importing</FPCLINE>
      <FPCLINE>    output = wa_cust-kunrg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>call function &apos;CONVERSION_EXIT_ALPHA_OUTPUT&apos;</FPCLINE>
      <FPCLINE>  exporting</FPCLINE>
      <FPCLINE>    input  = wa_cust-vbeln</FPCLINE>
      <FPCLINE>  importing</FPCLINE>
      <FPCLINE>    output = wa_cust-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* End of change on 31/07/2012...</FPCLINE>
      <FPCLINE/>
      <FPCLINE>wa_cust-fkdat = bil_prt_com-head_detail-vbdkr-fkdat.</FPCLINE>
      <FPCLINE>wa_cust-inco1 = bil_prt_com-head_detail-vbdkr-inco1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>select</FPCLINE>
      <FPCLINE>single vtext &quot; Description of the shipping conditions</FPCLINE>
      <FPCLINE>  from tvsbt &quot; Shipping Conditions: Texts</FPCLINE>
      <FPCLINE>  into wa_cust-name1</FPCLINE>
      <FPCLINE> where vsbed = bil_prt_com-head_detail-vbdkr-vsbed</FPCLINE>
      <FPCLINE>   and spras = bil_prt_com-head_detail-vbdkr-spras_vko.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching sales and purchase data ...</FPCLINE>
      <FPCLINE>read table bil_prt_com-item_detail</FPCLINE>
      <FPCLINE> assigning &lt;lwa_item_detail&gt;</FPCLINE>
      <FPCLINE>     index 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** Fetching serial data...</FPCLINE>
      <FPCLINE>*  SELECT obknr &quot; Object list number</FPCLINE>
      <FPCLINE>*    FROM ser01 &quot; Document Header for Serial Numbers for Delivery</FPCLINE>
      <FPCLINE>*    INTO lv_obknr</FPCLINE>
      <FPCLINE>*      UP TO 1 ROWS</FPCLINE>
      <FPCLINE>*   WHERE lief_nr = &lt;lwa_item_detail&gt;-vbdpr-vgbel.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDSELECT.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    SELECT obknr &quot; Object list number</FPCLINE>
      <FPCLINE>*           obzae &quot; Object list counters</FPCLINE>
      <FPCLINE>*           sernr &quot; Serial Number</FPCLINE>
      <FPCLINE>*           matnr &quot; Material Number</FPCLINE>
      <FPCLINE>*      FROM objk  &quot; Plant Maintenance Object List</FPCLINE>
      <FPCLINE>*      INTO TABLE li_objk</FPCLINE>
      <FPCLINE>*     WHERE obknr = lv_obknr.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Serial numbers for the Corresponding material</FPCLINE>
      <FPCLINE>  perform f_populate_serialnum     using bil_prt_com-item_detail</FPCLINE>
      <FPCLINE>                                changing li_objk</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>                                         li_ser01.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  select</FPCLINE>
      <FPCLINE>  single vbeln &quot; Sales Document</FPCLINE>
      <FPCLINE>         erdat &quot; Date on Which Record Was Created</FPCLINE>
      <FPCLINE>         auart &quot; Order Type Defect 8616</FPCLINE>
      <FPCLINE>         kkber &quot; Credit Control Area</FPCLINE>
      <FPCLINE>    from vbak  &quot; Sales Document: Header Data</FPCLINE>
      <FPCLINE>    into (wa_sales-vbeln, wa_sales-erdat,lv_auart, lv_kkber)</FPCLINE>
      <FPCLINE>   where vbeln = &lt;lwa_item_detail&gt;-vbdpr-vbeln_vauf.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE>*&lt;---Begin of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>*storing the Sales Order number into an global variable which is used later to display</FPCLINE>
      <FPCLINE>clear gv_vbeln.</FPCLINE>
      <FPCLINE>gv_vbeln = wa_sales-vbeln.</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Sales Document Item Details</FPCLINE>
      <FPCLINE>    select vbeln &quot; Sales Document</FPCLINE>
      <FPCLINE>           posnr &quot; Sales Document Item</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>           uepos &quot; Higher-level item in bill of material structures</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>           zmeng  &quot; Target quantity in sales units</FPCLINE>
      <FPCLINE>           kwmeng &quot; Cumulative Order Quantity in Sales Units</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>           stlnr &quot; Bill of material</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>      from vbap &quot; Sales Document: Item Data</FPCLINE>
      <FPCLINE>      into table li_vbap</FPCLINE>
      <FPCLINE>     where vbeln = wa_sales-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if sy-subrc = 0.</FPCLINE>
      <FPCLINE>*&amp;--Begin of Changes for Defect#1116 on 26-Oct-2012</FPCLINE>
      <FPCLINE>      sort li_vbap by vbeln</FPCLINE>
      <FPCLINE>                      posnr.</FPCLINE>
      <FPCLINE>*&amp;--End of Changes for Defect#1116 on 26-Oct-2012</FPCLINE>
      <FPCLINE>    endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    read table li_vbpa</FPCLINE>
      <FPCLINE>     assigning &lt;lwa_vbpa&gt;</FPCLINE>
      <FPCLINE>      with key parvw = lc_rg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      select</FPCLINE>
      <FPCLINE>      single sbgrp &quot; Credit representative group for credit management</FPCLINE>
      <FPCLINE>        into lv_sbgrp</FPCLINE>
      <FPCLINE>        from knkk  &quot; Customer master credit management: Control area data</FPCLINE>
      <FPCLINE>       where kunnr = &lt;lwa_vbpa&gt;-kunnr</FPCLINE>
      <FPCLINE>         and kkber = lv_kkber.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching contact number for credit rep ...</FPCLINE>
      <FPCLINE>        select</FPCLINE>
      <FPCLINE>        single mvalue2          &quot; Select Options: Value High</FPCLINE>
      <FPCLINE>          from zotc_prc_control &quot; OTC Process Team Control Table</FPCLINE>
      <FPCLINE>          into gv_contact</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE>*        WHERE vkorg    = lc_vkorg</FPCLINE>
      <FPCLINE>*          AND vtweg    = lc_vtweg</FPCLINE>
      <FPCLINE/>
      <FPCLINE>         where vkorg    = bil_prt_com-head_detail-vbdkr-vkorg</FPCLINE>
      <FPCLINE>           and vtweg    = bil_prt_com-head_detail-vbdkr-vtweg</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>           and mprogram = lc_program</FPCLINE>
      <FPCLINE>           and mactive  = lc_mactive</FPCLINE>
      <FPCLINE>           and soption  = lc_option</FPCLINE>
      <FPCLINE>           and mvalue1  = lv_sbgrp.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>    endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching adress number for customer...</FPCLINE>
      <FPCLINE>*  SELECT</FPCLINE>
      <FPCLINE>*  SINGLE lfdat &quot; Delivery Date</FPCLINE>
      <FPCLINE>*    FROM likp  &quot; SD Document: Delivery Header Data</FPCLINE>
      <FPCLINE>*    INTO wa_cust-lfdat</FPCLINE>
      <FPCLINE>*   WHERE vbeln = &lt;lwa_item_detail&gt;-vbdpr-vgbel.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  select</FPCLINE>
      <FPCLINE>  single adrnr &quot; Address</FPCLINE>
      <FPCLINE>    from t001w &quot; Plants/Branches</FPCLINE>
      <FPCLINE>    into gv_adrnr5</FPCLINE>
      <FPCLINE>   where werks = &lt;lwa_item_detail&gt;-vbdpr-werks.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    select</FPCLINE>
      <FPCLINE>    single city1  &quot; City</FPCLINE>
      <FPCLINE>           city2  &quot; District</FPCLINE>
      <FPCLINE>           region &quot; Region (State, Province, County)</FPCLINE>
      <FPCLINE>      from adrc   &quot; Addresses (Business Address Services)</FPCLINE>
      <FPCLINE>      into (wa_purchase-city1,</FPCLINE>
      <FPCLINE>            wa_purchase-city2,</FPCLINE>
      <FPCLINE>            wa_purchase-region)</FPCLINE>
      <FPCLINE>     where addrnumber = gv_adrnr5.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      concatenate wa_purchase-city1</FPCLINE>
      <FPCLINE>                  wa_purchase-city2</FPCLINE>
      <FPCLINE>                  wa_purchase-region</FPCLINE>
      <FPCLINE>             into gv_ship_from</FPCLINE>
      <FPCLINE>                  separated by lc_comma.</FPCLINE>
      <FPCLINE>      condense gv_ship_from.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      replace all occurrences of lc_dcomma in gv_ship_from with lc_comma.</FPCLINE>
      <FPCLINE>    endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Begin of change on 26/07/2012</FPCLINE>
      <FPCLINE>select low    &quot; ABAP/4: Selection value (LOW or HIGH value, external format)</FPCLINE>
      <FPCLINE>  from tvarvc &quot; Table of Variant Variables (Client-Specific)</FPCLINE>
      <FPCLINE>  into table li_low</FPCLINE>
      <FPCLINE> where name = lc_prog.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-subrc = 0.</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>select low    &quot; ABAP/4: Selection value (LOW or HIGH value, external format)</FPCLINE>
      <FPCLINE>  from tvarvc &quot; Table of Variant Variables (Client-Specific)</FPCLINE>
      <FPCLINE>  into table li_low2</FPCLINE>
      <FPCLINE> where name = lc_prog2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-subrc = 0.</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* End of change on 26/07/2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* --&gt; Begin of Change for Defect 8548</FPCLINE>
      <FPCLINE>* SELECT Material Type from MARA for all items</FPCLINE>
      <FPCLINE>if bil_prt_com-item_detail[] is not initial.</FPCLINE>
      <FPCLINE>  select matnr     &quot; Material Number</FPCLINE>
      <FPCLINE>         mtart     &quot; Material Type</FPCLINE>
      <FPCLINE>         from mara &quot; General Material Data</FPCLINE>
      <FPCLINE>         into table li_mara</FPCLINE>
      <FPCLINE>         for all entries in bil_prt_com-item_detail</FPCLINE>
      <FPCLINE>         where matnr = bil_prt_com-item_detail-vbdpr-matnr.</FPCLINE>
      <FPCLINE>  if sy-subrc = 0.</FPCLINE>
      <FPCLINE>    sort li_mara by matnr mtart.</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>endif. &quot; IF bil_prt_com-item_detail[] IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;-- End of Change for Defect 8548</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the billing plan dates</FPCLINE>
      <FPCLINE>perform f_billing_plan_dates    using bil_prt_com-item_detail &quot;Item Detail for Print</FPCLINE>
      <FPCLINE>                                      bil_prt_com-head_detail &quot;Header Details for Print</FPCLINE>
      <FPCLINE>                                      lwa_tdobj-zpln          &quot;Item category - &apos;ZPLN&apos;</FPCLINE>
      <FPCLINE>                             changing li_fplt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>perform f_populate_text_val  using lc_notax     &quot;No Tax Indicator</FPCLINE>
      <FPCLINE>                                   space        &quot;No colon</FPCLINE>
      <FPCLINE>                                   space        &quot;No value</FPCLINE>
      <FPCLINE>                                   space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                   lv_nastspras &quot;Message Status</FPCLINE>
      <FPCLINE>                          changing lwa_notax.   &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if bil_prt_com-head_detail-vbdkr-vtweg eq lwa_tdobj-vtweg and</FPCLINE>
      <FPCLINE>   bil_prt_com-head_detail-vbdkr-fkart eq lwa_tdobj-fkart.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  lv_subsidiary = abap_true.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endif. &quot; IF bil_prt_com-head_detail-vbdkr-vtweg EQ lwa_tdobj-vtweg AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if wa_sales-vbeln is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Customer purchase order number</FPCLINE>
      <FPCLINE>  select vbeln &quot; Sales and Distribution Document Number</FPCLINE>
      <FPCLINE>         posnr &quot; Item number of the SD document</FPCLINE>
      <FPCLINE>         bstkd &quot; Customer purchase order number</FPCLINE>
      <FPCLINE>    from vbkd  &quot; Sales Document: Business Data</FPCLINE>
      <FPCLINE>    into table li_vbkd</FPCLINE>
      <FPCLINE>   where vbeln = wa_sales-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Sort records</FPCLINE>
      <FPCLINE>    sort li_vbkd by vbeln  &quot;SD Document Number</FPCLINE>
      <FPCLINE>                    posnr. &quot;Item number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the first record to get the Customer Purchase Order ID</FPCLINE>
      <FPCLINE>    read table li_vbkd</FPCLINE>
      <FPCLINE>     assigning &lt;lfs_vbkd&gt;</FPCLINE>
      <FPCLINE>         index 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lfs_vbkd&gt; is assigned.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Customer Purchase Order ID</FPCLINE>
      <FPCLINE>      clear wa_purchase-bstnk_vf.</FPCLINE>
      <FPCLINE>      wa_purchase-bstnk_vf = &lt;lfs_vbkd&gt;-bstkd.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    endif. &quot; IF &lt;lfs_vbkd&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>endif. &quot; IF wa_sales-vbeln IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#4850 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>lv_uecha = lc_uecha. &quot;Value - &apos;009000&apos;</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>clear gv_fc.</FPCLINE>
      <FPCLINE>loop at bil_prt_com-item_detail assigning &lt;lwa_item_detail&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  at new vbdpr-matnr.</FPCLINE>
      <FPCLINE>    wa_item-arktx = &lt;lwa_item_detail&gt;-vbdpr-arktx.</FPCLINE>
      <FPCLINE>  endat.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Begin of Changes for Defect#1116 on 26-Oct-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*  READ TABLE li_low ASSIGNING  &lt;lwa_low&gt;</FPCLINE>
      <FPCLINE>*  WITH KEY low = bil_prt_com-head_detail-vbdkr-fkart.</FPCLINE>
      <FPCLINE>*  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*    READ TABLE li_vbap ASSIGNING &lt;lwa_vbap&gt;</FPCLINE>
      <FPCLINE>*         WITH KEY posnr = &lt;lwa_item_detail&gt;-vbdpr-posnr.</FPCLINE>
      <FPCLINE>*    IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*      wa_item-lfimg = &lt;lwa_vbap&gt;-zmeng.</FPCLINE>
      <FPCLINE>*    ENDIF.</FPCLINE>
      <FPCLINE>*  ELSE.</FPCLINE>
      <FPCLINE>*    READ TABLE li_vbap ASSIGNING &lt;lwa_vbap&gt;</FPCLINE>
      <FPCLINE>*         WITH KEY posnr = &lt;lwa_item_detail&gt;-vbdpr-posnr.</FPCLINE>
      <FPCLINE>*    IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*      wa_item-lfimg = &lt;lwa_vbap&gt;-kwmeng.</FPCLINE>
      <FPCLINE>*    ENDIF.</FPCLINE>
      <FPCLINE>*  ENDIF.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  read table li_vbap</FPCLINE>
      <FPCLINE>   assigning &lt;lwa_vbap&gt;</FPCLINE>
      <FPCLINE>    with key vbeln = &lt;lwa_item_detail&gt;-vbdpr-vbeln_vauf</FPCLINE>
      <FPCLINE>             posnr = &lt;lwa_item_detail&gt;-vbdpr-posnr_vauf</FPCLINE>
      <FPCLINE>             binary search.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc eq 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>* In D2 there will be transactions with BOM (Bill of materials)</FPCLINE>
      <FPCLINE>* and sales bundles. These transactions were not in D1.Business</FPCLINE>
      <FPCLINE>* has confirmed only BOM header needs to be printed on invoice</FPCLINE>
      <FPCLINE>* not components. Based on the following logic this item is not</FPCLINE>
      <FPCLINE>* a BOM/Sales bundle Header so excluded from printing.</FPCLINE>
      <FPCLINE>    if &lt;lwa_vbap&gt;-stlnr is not initial. &quot;BOM</FPCLINE>
      <FPCLINE>      if &lt;lwa_vbap&gt;-uepos is not initial. &quot;Item</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* --&gt; Begin of Change for Defect 8616</FPCLINE>
      <FPCLINE>*    For ZCPR order Type invoice do not flag the components</FPCLINE>
      <FPCLINE>*    as BOM Item. Binary search avoided as small internal table</FPCLINE>
      <FPCLINE>        read table li_auart with key auart = lv_auart</FPCLINE>
      <FPCLINE>                            transporting no fields.</FPCLINE>
      <FPCLINE>        if sy-subrc ne 0.</FPCLINE>
      <FPCLINE>* &lt;-- End of Change for Defect 8616</FPCLINE>
      <FPCLINE>******BOM ITEM******</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          wa_item-flag = abap_true.</FPCLINE>
      <FPCLINE>          wa_item-bom = lv_bom = lc_bomitm. &quot;BOM Item</FPCLINE>
      <FPCLINE>          wa_item-bommat = lv_bommat.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          if lv_subsidiary eq abap_true.</FPCLINE>
      <FPCLINE>            clear wa_item-flag.</FPCLINE>
      <FPCLINE>          endif. &quot; IF lv_subsidiary EQ abap_true</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>        endif. &quot; IF sy-subrc NE 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      else. &quot; ELSE -&gt; IF &lt;lwa_vbap&gt;-uepos IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>******BOM HEADER******</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* BOM Header should be printed for Subsidy case where the Distribution</FPCLINE>
      <FPCLINE>* channel is &apos;90&apos; and Invoice type is &apos;ZF2&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*        IF lv_subsidiary EQ abap_true.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** If the Distribution channel is &apos;90&apos; and Invoice type is &apos;ZF2&apos; then</FPCLINE>
      <FPCLINE>** skip this BOM Header record to be printed</FPCLINE>
      <FPCLINE>*          CONTINUE.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*        ENDIF. &quot; IF lv_subsidiary EQ abap_true</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Begin of Change for Defect 8548</FPCLINE>
      <FPCLINE>        read table li_mara with key matnr = &lt;lwa_item_detail&gt;-vbdpr-matnr</FPCLINE>
      <FPCLINE>                                    mtart = lv_mtart</FPCLINE>
      <FPCLINE>                           binary search</FPCLINE>
      <FPCLINE>                           transporting no fields.</FPCLINE>
      <FPCLINE>        if sy-subrc = 0.</FPCLINE>
      <FPCLINE>* End of change for Defect 8548</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          wa_item-bom = lv_bom = lc_bomhdr. &quot;BOM Header</FPCLINE>
      <FPCLINE>          clear lv_bommat.</FPCLINE>
      <FPCLINE>          lv_bommat = &lt;lwa_item_detail&gt;-vbdpr-matnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          if wa_socl-land1 eq lv_ca. &quot;For Canada Invoice only</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch item from Invoice details</FPCLINE>
      <FPCLINE>            unassign &lt;lfs_vbrp&gt;.</FPCLINE>
      <FPCLINE>            read table li_vbrp</FPCLINE>
      <FPCLINE>             assigning &lt;lfs_vbrp&gt;</FPCLINE>
      <FPCLINE>              with key vbeln = bil_prt_com-head_detail-vbdkr-vbeln</FPCLINE>
      <FPCLINE>                       posnr = &lt;lwa_item_detail&gt;-vbdpr-posnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            if &lt;lfs_vbrp&gt; is assigned.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>              if &lt;lfs_vbrp&gt;-kowrr is not initial. &quot;Statistical value check</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the value of Bill of Material for &quot;NT&quot; printing</FPCLINE>
      <FPCLINE>                clear : lv_bom_stlnr,</FPCLINE>
      <FPCLINE>                        lv_bom_posnr,</FPCLINE>
      <FPCLINE>                        lv_mwsbp.</FPCLINE>
      <FPCLINE>                lv_bom_stlnr = &lt;lwa_vbap&gt;-stlnr.</FPCLINE>
      <FPCLINE>                lv_bom_posnr = &lt;lwa_vbap&gt;-posnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>                unassign &lt;lfs_bomhdr&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>              endif. &quot; IF &lt;lfs_vbrp&gt;-kowrr IS NOT INITIAL</FPCLINE>
      <FPCLINE>            endif. &quot; IF &lt;lfs_vbrp&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>          endif. &quot; IF wa_socl-land1 EQ lv_ca</FPCLINE>
      <FPCLINE>        endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF &lt;lwa_vbap&gt;-uepos IS NOT INITIAL</FPCLINE>
      <FPCLINE>    else. &quot; ELSE -&gt; IF &lt;lwa_vbap&gt;-stlnr IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>******STAND ALONE COMPONENT******</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      clear : lv_bom_stlnr,</FPCLINE>
      <FPCLINE>              lv_bom_posnr,</FPCLINE>
      <FPCLINE>              lv_mwsbp    ,</FPCLINE>
      <FPCLINE>              lv_zcfi     ,</FPCLINE>
      <FPCLINE>              lv_bommat   ,</FPCLINE>
      <FPCLINE>              lv_bom.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      unassign &lt;lfs_bomhdr&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch item from Invoice details</FPCLINE>
      <FPCLINE>      unassign &lt;lfs_vbrp&gt;.</FPCLINE>
      <FPCLINE>      read table li_vbrp</FPCLINE>
      <FPCLINE>       assigning &lt;lfs_vbrp&gt;</FPCLINE>
      <FPCLINE>        with key vbeln = bil_prt_com-head_detail-vbdkr-vbeln</FPCLINE>
      <FPCLINE>                 posnr = &lt;lwa_item_detail&gt;-vbdpr-posnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if &lt;lfs_vbrp&gt; is assigned.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch item for Batch split scenario</FPCLINE>
      <FPCLINE>        unassign &lt;lfs_lips&gt;.</FPCLINE>
      <FPCLINE>        read table li_lips</FPCLINE>
      <FPCLINE>         assigning &lt;lfs_lips&gt;</FPCLINE>
      <FPCLINE>          with key vbeln = &lt;lfs_vbrp&gt;-vgbel</FPCLINE>
      <FPCLINE>                   posnr = &lt;lfs_vbrp&gt;-vgpos</FPCLINE>
      <FPCLINE>                   binary search.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        if &lt;lfs_lips&gt; is assigned.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          if &lt;lfs_lips&gt;-uecha is not initial.</FPCLINE>
      <FPCLINE>            wa_item-uecha = &lt;lfs_lips&gt;-uecha. &quot;Higher-Level Item of Batch Split Item</FPCLINE>
      <FPCLINE>          else. &quot; ELSE -&gt; IF &lt;lfs_lips&gt;-uecha IS NOT INITIAL</FPCLINE>
      <FPCLINE>            lv_uecha = lv_uecha + 1.</FPCLINE>
      <FPCLINE>            wa_item-uecha = lv_uecha.</FPCLINE>
      <FPCLINE>          endif. &quot; IF &lt;lfs_lips&gt;-uecha IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        else. &quot; ELSE -&gt; IF &lt;lfs_lips&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          wa_item-uecha = lv_uecha.</FPCLINE>
      <FPCLINE>          lv_uecha = lv_uecha + 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        endif. &quot; IF &lt;lfs_lips&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>      endif. &quot; IF &lt;lfs_vbrp&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    endif. &quot; IF &lt;lwa_vbap&gt;-stlnr IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc EQ 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--End of Changes for Defect#1116 on 26-Oct-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* CR#313 - Freight Charge will be calculated based on Condition type</FPCLINE>
      <FPCLINE>*          ZTFR instead of Subtotal4</FPCLINE>
      <FPCLINE>* BOC DEL ADAS1 CR#313</FPCLINE>
      <FPCLINE>*  gv_fc = gv_fc + &lt;lwa_item_detail&gt;-vbdpr-kzwi4.</FPCLINE>
      <FPCLINE>* BOC DEL ADAS1 CR#313</FPCLINE>
      <FPCLINE>  if wa_item-flag is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    read table li_low</FPCLINE>
      <FPCLINE>     assigning &lt;lwa_low&gt;</FPCLINE>
      <FPCLINE>      with key low = bil_prt_com-head_detail-vbdkr-fkart.</FPCLINE>
      <FPCLINE>    if &lt;lwa_vbap&gt; is assigned.</FPCLINE>
      <FPCLINE>      if sy-subrc eq 0.</FPCLINE>
      <FPCLINE>        wa_item-lfimg = &lt;lwa_vbap&gt;-zmeng.</FPCLINE>
      <FPCLINE>      else. &quot; ELSE -&gt; IF sy-subrc EQ 0</FPCLINE>
      <FPCLINE>        wa_item-lfimg = &lt;lwa_vbap&gt;-kwmeng.</FPCLINE>
      <FPCLINE>      endif. &quot; IF sy-subrc EQ 0</FPCLINE>
      <FPCLINE>    endif. &quot; if &lt;lwa_vbap&gt; is ASSIGNED</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    wa_item-fkimg = &lt;lwa_item_detail&gt;-vbdpr-fkimg.</FPCLINE>
      <FPCLINE>*   wa_item-meins = &lt;lwa_item_detail&gt;-vbdpr-meins. &quot; Commented by SBASU Def # 1894</FPCLINE>
      <FPCLINE>    wa_item-meins = &lt;lwa_item_detail&gt;-vbdpr-vrkme. &quot; Added by SBASU Def # 1894</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*    gv_sub = gv_sub + &lt;lwa_item_detail&gt;-vbdpr-kzwi1</FPCLINE>
      <FPCLINE>*                              + &lt;lwa_item_detail&gt;-vbdpr-kzwi3. &quot; Sub Total</FPCLINE>
      <FPCLINE>*    gv_sub1 = gv_sub.</FPCLINE>
      <FPCLINE>*    WRITE gv_sub1 TO gv_sub1 UNIT &lt;lwa_item_detail&gt;-vbdpr-meins.</FPCLINE>
      <FPCLINE>*    gv_sub = gv_sub1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if lv_subsidiary is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Exclude the BOM Header Price from aggregation in case of Subsidiary</FPCLINE>
      <FPCLINE>      if wa_item-bom ne lc_bomhdr. &quot;Only BOM Item and Stand Alone Item</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        gv_sub = gv_sub + &lt;lwa_item_detail&gt;-vbdpr-kzwi1</FPCLINE>
      <FPCLINE>                        + &lt;lwa_item_detail&gt;-vbdpr-kzwi3. &quot; Sub Total</FPCLINE>
      <FPCLINE>        gv_sub1 = gv_sub.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        write gv_sub1</FPCLINE>
      <FPCLINE>           to gv_sub1</FPCLINE>
      <FPCLINE>         unit &lt;lwa_item_detail&gt;-vbdpr-meins.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        gv_sub = gv_sub1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF wa_item-bom NE lc_bomhdr</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    else. &quot; ELSE -&gt; IF lv_subsidiary IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      gv_sub = gv_sub + &lt;lwa_item_detail&gt;-vbdpr-kzwi1</FPCLINE>
      <FPCLINE>                      + &lt;lwa_item_detail&gt;-vbdpr-kzwi3. &quot; Sub Total</FPCLINE>
      <FPCLINE>      gv_sub1 = gv_sub.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      write gv_sub1</FPCLINE>
      <FPCLINE>         to gv_sub1</FPCLINE>
      <FPCLINE>       unit &lt;lwa_item_detail&gt;-vbdpr-meins.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      gv_sub = gv_sub1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    endif. &quot; IF lv_subsidiary IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Begin of change SBASU Def 1617</FPCLINE>
      <FPCLINE>*  LOOP AT li_komv ASSIGNING &lt;lwa_komv&gt; WHERE kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>*                                       AND   kinak = lc_kinak</FPCLINE>
      <FPCLINE>*                                       AND   koaid = lc_koaid</FPCLINE>
      <FPCLINE>*                                       AND   kstat = space.</FPCLINE>
      <FPCLINE>*    IF &lt;lwa_komv&gt;-kntyp NE lc_kntyp.&quot; AND wa_item-lfimg IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*      wa_item-kpein = &lt;lwa_komv&gt;-kwert + &lt;lwa_item_detail&gt;-vbdpr-kzwi3 .&quot;/ wa_item-lfimg.</FPCLINE>
      <FPCLINE>*    ENDIF.</FPCLINE>
      <FPCLINE>*  ENDLOOP.</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628</FPCLINE>
      <FPCLINE>*    wa_item-kpein = &lt;lwa_item_detail&gt;-vbdpr-kzwi1.  &quot; Defect 5999</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628</FPCLINE>
      <FPCLINE>*End of change SBASU Def 1617</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Begin of change SBASU Defect 1609</FPCLINE>
      <FPCLINE>*  IF wa_item-lfimg IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*    wa_item-kpein = wa_item-kpein / wa_item-lfimg.</FPCLINE>
      <FPCLINE>*  ENDIF.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*    IF wa_item-fkimg IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*      wa_item-kpein = wa_item-kpein / wa_item-fkimg.</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF wa_item-fkimg IS NOT INITIAL</FPCLINE>
      <FPCLINE>**End of change SBASU Defect 1609</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    wa_item-ext = wa_item-kpein * wa_item-fkimg.</FPCLINE>
      <FPCLINE>    if li_komv is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Condition value for the Condition type - &apos;ZNET&apos;</FPCLINE>
      <FPCLINE>      unassign &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>      read table li_komv</FPCLINE>
      <FPCLINE>       assigning &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>        with key knumv = bil_prt_com-head_detail-vbdkr-knumv</FPCLINE>
      <FPCLINE>                 kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>                 kschl = lwa_cond-cond_znet.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if &lt;lwa_komv&gt; is assigned.</FPCLINE>
      <FPCLINE>        wa_item-kpein = &lt;lwa_komv&gt;-kbetr. &quot;Unit price</FPCLINE>
      <FPCLINE>        wa_item-ext   = &lt;lwa_komv&gt;-kwert. &quot;Extended price</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628</FPCLINE>
      <FPCLINE>      else. &quot; ELSE -&gt; IF &lt;lwa_komv&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>        wa_item-kpein = &lt;lwa_item_detail&gt;-vbdpr-kzwi1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        if wa_item-fkimg is not initial.</FPCLINE>
      <FPCLINE>          wa_item-kpein = wa_item-kpein / wa_item-fkimg.</FPCLINE>
      <FPCLINE>        endif. &quot; IF wa_item-fkimg IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        wa_item-ext = wa_item-kpein * wa_item-fkimg.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF &lt;lwa_komv&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    endif. &quot; IF li_komv IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>    if wa_socl-land1 eq lv_ca. &quot;For Canada Invoice only</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*      IF li_komv IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Fetch the Condition value for the Condition type - &apos;ZCFI&apos;</FPCLINE>
      <FPCLINE>*        UNASSIGN &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>*        READ TABLE li_komv</FPCLINE>
      <FPCLINE>*-----&gt;End of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>      if li_komv_tmp is not initial.</FPCLINE>
      <FPCLINE>        unassign &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>        read table li_komv_tmp</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>         assigning &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>          with key knumv = bil_prt_com-head_detail-vbdkr-knumv</FPCLINE>
      <FPCLINE>                   kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>                   kschl = lwa_cond-cond_zcfi</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>              binary search.</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*        IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>*           &lt;lwa_komv&gt;-kwert IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*-----&gt;End of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        if &lt;lwa_komv&gt; is assigned.</FPCLINE>
      <FPCLINE>          if &lt;lwa_komv&gt;-kwert is not initial.</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Currency conversion for CFI Discount</FPCLINE>
      <FPCLINE>            write &lt;lwa_komv&gt;-kwert</FPCLINE>
      <FPCLINE>               to lv_cfi2</FPCLINE>
      <FPCLINE>                  currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>            condense lv_cfi2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Concatenate the text and value for the &apos;ZCFI&apos;</FPCLINE>
      <FPCLINE>            concatenate lc_opn &quot;Value - &apos;(&apos;</FPCLINE>
      <FPCLINE>                        lv_cfi2</FPCLINE>
      <FPCLINE>                        lc_cls &quot;Value - &apos;)&apos;</FPCLINE>
      <FPCLINE>                   into lv_cfi2.</FPCLINE>
      <FPCLINE>            condense lv_cfi2 no-gaps.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            concatenate lwa_cfitxt-text</FPCLINE>
      <FPCLINE>                        lv_cfi2</FPCLINE>
      <FPCLINE>                   into wa_item-zcfi</FPCLINE>
      <FPCLINE>                        separated by space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          endif. &quot; IF &lt;lwa_komv&gt;-kwert IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        endif. &quot; IF &lt;lwa_komv&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Fetch the Condition value for the Condition type - &apos;XR1&apos;</FPCLINE>
      <FPCLINE>*        UNASSIGN &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>*        CLEAR lv_kwert1.</FPCLINE>
      <FPCLINE>*        READ TABLE li_komv</FPCLINE>
      <FPCLINE>*         ASSIGNING &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>*          WITH KEY knumv = bil_prt_com-head_detail-vbdkr-knumv</FPCLINE>
      <FPCLINE>*                   kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>*                   kschl = lwa_cond-cond_xr1.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*        IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>*           sy-subrc = 0.</FPCLINE>
      <FPCLINE>*          lv_kwert1 = &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>*        ENDIF. &quot; IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Fetch the Condition value for the Condition type - &apos;XR2&apos;</FPCLINE>
      <FPCLINE>*        UNASSIGN &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>*        CLEAR lv_kwert2.</FPCLINE>
      <FPCLINE>*        READ TABLE li_komv</FPCLINE>
      <FPCLINE>*         ASSIGNING &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>*          WITH KEY knumv = bil_prt_com-head_detail-vbdkr-knumv</FPCLINE>
      <FPCLINE>*                   kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>*                   kschl = lwa_cond-cond_xr2.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*        IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>*           sy-subrc = 0.</FPCLINE>
      <FPCLINE>*          lv_kwert2 = &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>*        ENDIF. &quot; IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Fetch the Condition value for the Condition type - &apos;XR3&apos;</FPCLINE>
      <FPCLINE>*        UNASSIGN &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>*        CLEAR lv_kwert3.</FPCLINE>
      <FPCLINE>*        READ TABLE li_komv</FPCLINE>
      <FPCLINE>*         ASSIGNING &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>*          WITH KEY knumv = bil_prt_com-head_detail-vbdkr-knumv</FPCLINE>
      <FPCLINE>*                   kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>*                   kschl = lwa_cond-cond_xr3.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*        IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>*           sy-subrc = 0.</FPCLINE>
      <FPCLINE>*          lv_kwert3 = &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>*        ENDIF. &quot; IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the summed up values for all the Condition types -</FPCLINE>
      <FPCLINE>** &apos;XR1&apos;, &apos;XR2&apos; and &apos;XR3&apos;</FPCLINE>
      <FPCLINE>*        lv_kwert1 = lv_kwert1 + lv_kwert2 + lv_kwert3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*        IF lv_kwert1 IS INITIAL AND</FPCLINE>
      <FPCLINE>*           lwa_notax-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*          IF wa_item-zcfi IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*            CONCATENATE wa_item-zcfi</FPCLINE>
      <FPCLINE>*                        lwa_notax-text+0(4) &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE>*                   INTO wa_item-zcfi</FPCLINE>
      <FPCLINE>*                        SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*          ELSE. &quot; ELSE -&gt; IF wa_item-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE>*            wa_item-zcfi = lwa_notax-text+0(4). &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE>*          ENDIF. &quot; IF wa_item-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE>*        ENDIF. &quot; IF lv_kwert1 IS INITIAL AND</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF li_komv_tmp IS NOT INITIAL</FPCLINE>
      <FPCLINE>    endif. &quot; IF wa_socl-land1 EQ lv_ca</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF wa_item-flag IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if wa_socl-land1 eq lv_ca.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch item from Invoice details</FPCLINE>
      <FPCLINE>    unassign &lt;lfs_item&gt;.</FPCLINE>
      <FPCLINE>    read table li_vbrp</FPCLINE>
      <FPCLINE>     assigning &lt;lfs_item&gt;</FPCLINE>
      <FPCLINE>      with key vbeln = bil_prt_com-head_detail-vbdkr-vbeln</FPCLINE>
      <FPCLINE>               posnr = &lt;lwa_item_detail&gt;-vbdpr-posnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lfs_item&gt; is assigned.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if lv_bom eq lc_bomitm. &quot;BOM Item</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        if &lt;lwa_vbap&gt;-stlnr eq lv_bom_stlnr and &quot;BOM Item related to Header</FPCLINE>
      <FPCLINE>           &lt;lwa_vbap&gt;-uepos eq lv_bom_posnr and</FPCLINE>
      <FPCLINE>           &lt;lfs_bomhdr&gt;     is assigned.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Cumulate the tax amount for the all the BOM Items</FPCLINE>
      <FPCLINE>          lv_mwsbp = &lt;lfs_item&gt;-mwsbp + lv_mwsbp.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          if lv_mwsbp is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            if &lt;lfs_bomhdr&gt;-zcfi is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>              clear &lt;lfs_bomhdr&gt;-zcfi.</FPCLINE>
      <FPCLINE>              concatenate lv_zcfi</FPCLINE>
      <FPCLINE>                          lwa_notax-text+0(4) &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE>                     into &lt;lfs_bomhdr&gt;-zcfi</FPCLINE>
      <FPCLINE>                          separated by space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            else. &quot; ELSE -&gt; IF &lt;lfs_bomhdr&gt;-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE>              &lt;lfs_bomhdr&gt;-zcfi = lwa_notax-text+0(4). &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE>              condense &lt;lfs_bomhdr&gt;-zcfi no-gaps.</FPCLINE>
      <FPCLINE>            endif. &quot; IF &lt;lfs_bomhdr&gt;-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          else. &quot; ELSE -&gt; IF lv_mwsbp IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            clear lv_strlen.</FPCLINE>
      <FPCLINE>            lv_strlen = strlen( &lt;lfs_bomhdr&gt;-zcfi ).</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            if lv_strlen gt 4.</FPCLINE>
      <FPCLINE>              &lt;lfs_bomhdr&gt;-zcfi = lv_zcfi.</FPCLINE>
      <FPCLINE>            else. &quot; ELSE -&gt; IF lv_strlen GT 4</FPCLINE>
      <FPCLINE>              clear &lt;lfs_bomhdr&gt;-zcfi.</FPCLINE>
      <FPCLINE>            endif. &quot; IF lv_strlen GT 4</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          endif. &quot; IF lv_mwsbp IS INITIAL</FPCLINE>
      <FPCLINE>        endif. &quot; IF &lt;lwa_vbap&gt;-stlnr EQ lv_bom_stlnr AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* For Subsidiary scenario individual BOM components should</FPCLINE>
      <FPCLINE>* have the check for the Tax amount</FPCLINE>
      <FPCLINE>        if lv_subsidiary eq abap_true.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          if &lt;lfs_item&gt;-mwsbp is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            if wa_item-zcfi is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>              lv_zcfi = wa_item-zcfi.</FPCLINE>
      <FPCLINE>              clear wa_item-zcfi.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>              concatenate lv_zcfi</FPCLINE>
      <FPCLINE>                          lwa_notax-text+0(4) &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE>                     into wa_item-zcfi</FPCLINE>
      <FPCLINE>                          separated by space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>              clear lv_zcfi.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            else. &quot; ELSE -&gt; IF wa_item-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE>              wa_item-zcfi = lwa_notax-text+0(4). &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE>            endif. &quot; IF wa_item-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE>          endif. &quot; IF &lt;lfs_item&gt;-mwsbp IS INITIAL</FPCLINE>
      <FPCLINE>        endif. &quot; IF lv_subsidiary EQ abap_true</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      elseif lv_bom is initial. &quot;Stand alone component</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        if &lt;lfs_item&gt;-mwsbp is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          if wa_item-zcfi is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            lv_zcfi = wa_item-zcfi.</FPCLINE>
      <FPCLINE>            clear wa_item-zcfi.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            concatenate lv_zcfi</FPCLINE>
      <FPCLINE>                        lwa_notax-text+0(4) &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE>                   into wa_item-zcfi</FPCLINE>
      <FPCLINE>                        separated by space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            clear lv_zcfi.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          else. &quot; ELSE -&gt; IF wa_item-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE>            wa_item-zcfi = lwa_notax-text+0(4). &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE>          endif. &quot; IF wa_item-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE>        endif. &quot; IF &lt;lfs_item&gt;-mwsbp IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF lv_bom EQ lc_bomitm</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lfs_item&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  endif. &quot; IF wa_socl-land1 EQ lv_ca</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Delete for D2_OTC_FDD_0014_Defect#8548 by SMUKHER</FPCLINE>
      <FPCLINE>*-------------------------</FPCLINE>
      <FPCLINE>* TAX VALUE CALCULATION *</FPCLINE>
      <FPCLINE>*-------------------------</FPCLINE>
      <FPCLINE>  if  wa_socl-land1 ne lv_ca.</FPCLINE>
      <FPCLINE>    if lv_bom is initial or  &quot;Non-BOM Material</FPCLINE>
      <FPCLINE>       lv_bom eq lc_bomitm . &quot;BOM Item</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Tax value will be added for the Non-BOM Material and BOM Item only.</FPCLINE>
      <FPCLINE>* For BOM Header this value will be excluded from summation.</FPCLINE>
      <FPCLINE>      gv_tax = gv_tax + &lt;lwa_item_detail&gt;-vbdpr-mwsbp. &quot;Tax calculation</FPCLINE>
      <FPCLINE>    endif. &quot; IF lv_bom IS INITIAL OR</FPCLINE>
      <FPCLINE>  endif. &quot; IF wa_socl-land1 NE lv_ca</FPCLINE>
      <FPCLINE>* &lt;--- End of Delete for D2_OTC_FDD_0014_Defect#8548 by SMUKHER</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#8548 by SMUKHER</FPCLINE>
      <FPCLINE>* Uncommenting the code which was previously commented for D#5753 and</FPCLINE>
      <FPCLINE>* D#2022 as the Tax Calculation was not being done properly in case</FPCLINE>
      <FPCLINE>* of BOM Headers.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if  wa_socl-land1 eq lv_ca.</FPCLINE>
      <FPCLINE>* Fetch the Condition value for the Condition type - &apos;XR1&apos;</FPCLINE>
      <FPCLINE>    unassign &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>    clear lv_kwert1.</FPCLINE>
      <FPCLINE>    read table li_komv</FPCLINE>
      <FPCLINE>     assigning &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>      with key knumv = bil_prt_com-head_detail-vbdkr-knumv</FPCLINE>
      <FPCLINE>               kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>               kschl = lwa_cond-cond_xr1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lwa_komv&gt; is assigned and</FPCLINE>
      <FPCLINE>       sy-subrc = 0.</FPCLINE>
      <FPCLINE>      lv_kwert1 = &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Condition value for the Condition type - &apos;XR2&apos;</FPCLINE>
      <FPCLINE>    unassign &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>    clear lv_kwert2.</FPCLINE>
      <FPCLINE>    read table li_komv</FPCLINE>
      <FPCLINE>     assigning &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>      with key knumv = bil_prt_com-head_detail-vbdkr-knumv</FPCLINE>
      <FPCLINE>               kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>               kschl = lwa_cond-cond_xr2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lwa_komv&gt; is assigned and</FPCLINE>
      <FPCLINE>       sy-subrc = 0.</FPCLINE>
      <FPCLINE>      lv_kwert2 = &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Condition value for the Condition type - &apos;XR3&apos;</FPCLINE>
      <FPCLINE>    unassign &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE>    clear lv_kwert3.</FPCLINE>
      <FPCLINE>    read table li_komv</FPCLINE>
      <FPCLINE>     assigning &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>      with key knumv = bil_prt_com-head_detail-vbdkr-knumv</FPCLINE>
      <FPCLINE>               kposn = &lt;lwa_item_detail&gt;-vbdpr-posnr</FPCLINE>
      <FPCLINE>               kschl = lwa_cond-cond_xr3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lwa_komv&gt; is assigned and</FPCLINE>
      <FPCLINE>       sy-subrc = 0.</FPCLINE>
      <FPCLINE>      lv_kwert3 = &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_komv&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the summed up values for all the Condition types -</FPCLINE>
      <FPCLINE>* &apos;XR1&apos;, &apos;XR2&apos; and &apos;XR3&apos;</FPCLINE>
      <FPCLINE>    lv_kwert1 = lv_kwert1 + lv_kwert2 + lv_kwert3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* TAX to be calculated is the Summed up value of all the 3</FPCLINE>
      <FPCLINE>* above condition types, where KONV-KINAK = NULL.</FPCLINE>
      <FPCLINE>    lv_tax = lv_kwert1.</FPCLINE>
      <FPCLINE>  endif. &quot; IF wa_socl-land1 EQ lv_ca</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#8548 by SMUKHER.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  wa_item-matnr = &lt;lwa_item_detail&gt;-vbdpr-matnr.</FPCLINE>
      <FPCLINE>  wa_item-charg = &lt;lwa_item_detail&gt;-vbdpr-charg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>*  wa_item-uecha = &lt;lwa_item_detail&gt;-vbdpr-uecha.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if lv_bom is initial or &quot;Non-BOM Material</FPCLINE>
      <FPCLINE>     lv_bom eq lc_bomhdr. &quot;BOM Header</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* No Line item text will be populated for the BOM Component. But</FPCLINE>
      <FPCLINE>* for the BOM Header and Non-BOM Material the Reference number will</FPCLINE>
      <FPCLINE>* be populated.</FPCLINE>
      <FPCLINE>    clear : lv_aubel,</FPCLINE>
      <FPCLINE>            lv_aupos,</FPCLINE>
      <FPCLINE>            lv_vbeln,</FPCLINE>
      <FPCLINE>            lv_posnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lv_aubel = &lt;lwa_item_detail&gt;-vbdpr-vbeln_vauf. &quot;Sales Order</FPCLINE>
      <FPCLINE>    lv_aupos = &lt;lwa_item_detail&gt;-vbdpr-posnr_vauf. &quot;Sales Document Item</FPCLINE>
      <FPCLINE>    lv_vbeln = bil_prt_com-head_detail-vbdkr-vbeln. &quot;Invoice number</FPCLINE>
      <FPCLINE>    lv_posnr = &lt;lwa_item_detail&gt;-vbdpr-posnr. &quot;Line item number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF lv_bom IS INITIAL OR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if &lt;lwa_item_detail&gt;-vbdpr-fplnr is not initial and</FPCLINE>
      <FPCLINE>     &lt;lwa_item_detail&gt;-vbdpr-fpltr is not initial and</FPCLINE>
      <FPCLINE>     li_fplt is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Billing Plan: Dates</FPCLINE>
      <FPCLINE>    unassign &lt;lfs_fplt&gt;.</FPCLINE>
      <FPCLINE>    read table li_fplt</FPCLINE>
      <FPCLINE>     assigning &lt;lfs_fplt&gt;</FPCLINE>
      <FPCLINE>      with key fplnr = &lt;lwa_item_detail&gt;-vbdpr-fplnr</FPCLINE>
      <FPCLINE>               fpltr = &lt;lwa_item_detail&gt;-vbdpr-fpltr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lfs_fplt&gt; is assigned.</FPCLINE>
      <FPCLINE>      lwa_fplt = &lt;lfs_fplt&gt;.</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lfs_fplt&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  endif. &quot; IF &lt;lwa_item_detail&gt;-vbdpr-fplnr IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the QUOTE ID</FPCLINE>
      <FPCLINE>  read table li_vbrp</FPCLINE>
      <FPCLINE>   assigning &lt;lfs_vbrp&gt;</FPCLINE>
      <FPCLINE>    with key aubel = lv_aubel</FPCLINE>
      <FPCLINE>             aupos = lv_aupos</FPCLINE>
      <FPCLINE>             binary search.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc eq 0.</FPCLINE>
      <FPCLINE>    lv_value = &lt;lfs_vbrp&gt;-zzquoteref. &quot;Quote Reference</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc EQ 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  clear : lv_vbelnpos.</FPCLINE>
      <FPCLINE>  concatenate lv_vbeln &quot;Invoice number</FPCLINE>
      <FPCLINE>              lv_posnr &quot;Line item number</FPCLINE>
      <FPCLINE>         into lv_vbelnpos.</FPCLINE>
      <FPCLINE>  condense lv_vbelnpos no-gaps.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the QUOTE ID/PROMO CODE/Line Item Text for each item</FPCLINE>
      <FPCLINE>  perform f_populate_qid_pcode_lintxt  using lv_value     &quot;Quote Reference</FPCLINE>
      <FPCLINE>                                             lwa_tdobj    &quot;Standard Text ID</FPCLINE>
      <FPCLINE>                                             lv_vbelnpos  &quot;Billing document and Line item</FPCLINE>
      <FPCLINE>                                             lv_nastspras &quot;Language Key</FPCLINE>
      <FPCLINE>                                             wa_socl      &quot;Languages</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>                                             lwa_fplt</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>                                    changing wa_item-tdline. &quot;Line Item Text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*----&gt;Begin of Change Defect# 8904</FPCLINE>
      <FPCLINE>* Select Customer Material Master from Inforecord based on line item Material.</FPCLINE>
      <FPCLINE>  select single kdmat INTO lv_kdmat  from knmt</FPCLINE>
      <FPCLINE>    where vkorg = bil_prt_com-head_detail-vbdkr-vkorg and</FPCLINE>
      <FPCLINE>          vtweg = bil_prt_com-head_detail-vbdkr-vtweg and</FPCLINE>
      <FPCLINE>          kunnr = bil_prt_com-head_detail-vbdkr-kunag and</FPCLINE>
      <FPCLINE>          matnr = &lt;lwa_item_detail&gt;-vbdpr-matnr .</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  &quot; Customer Material number found, read the text (SO10) based on language</FPCLINE>
      <FPCLINE>  if sy-subrc eq 0.</FPCLINE>
      <FPCLINE>*   Get the Standard text</FPCLINE>
      <FPCLINE>    call function &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>      exporting</FPCLINE>
      <FPCLINE>        id                      = lc_id_std</FPCLINE>
      <FPCLINE>        language                = lv_nastspras</FPCLINE>
      <FPCLINE>        name                    = lc_cmir</FPCLINE>
      <FPCLINE>        object                  = lc_text</FPCLINE>
      <FPCLINE>      tables</FPCLINE>
      <FPCLINE>        lines                   = li_lines</FPCLINE>
      <FPCLINE>      exceptions</FPCLINE>
      <FPCLINE>        id                      = 1</FPCLINE>
      <FPCLINE>        language                = 2</FPCLINE>
      <FPCLINE>        name                    = 3</FPCLINE>
      <FPCLINE>        not_found               = 4</FPCLINE>
      <FPCLINE>        object                  = 5</FPCLINE>
      <FPCLINE>        reference_check         = 6</FPCLINE>
      <FPCLINE>        wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>        others                  = 8.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    &quot;Insert the text into 1st Row of Internal Table.</FPCLINE>
      <FPCLINE>    if sy-subrc is initial.</FPCLINE>
      <FPCLINE>      loop at li_lines assigning &lt;lfs_lines&gt; .</FPCLINE>
      <FPCLINE>        lwa_txtval-val = &lt;lfs_lines&gt;-tdline.</FPCLINE>
      <FPCLINE>        concatenate lwa_txtval-val lv_kdmat INTO lwa_txtval-val SEPARATED BY space.</FPCLINE>
      <FPCLINE>        insert lwa_txtval-val INTO wa_item-tdline index 1.</FPCLINE>
      <FPCLINE>        clear lwa_txtval.</FPCLINE>
      <FPCLINE>      endloop.</FPCLINE>
      <FPCLINE>    endif.</FPCLINE>
      <FPCLINE>  endif.</FPCLINE>
      <FPCLINE>*----&gt;End of Change Defect# 8904</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  clear : lv_lief_nr,</FPCLINE>
      <FPCLINE>          lv_posnr_vl.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  lv_lief_nr   = &lt;lwa_item_detail&gt;-vbdpr-vgbel.</FPCLINE>
      <FPCLINE>  lv_posnr_vl  = &lt;lwa_item_detail&gt;-vbdpr-vgpos.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Get the Serial number</FPCLINE>
      <FPCLINE>  unassign &lt;lfs_ser01&gt;.</FPCLINE>
      <FPCLINE>  read table li_ser01</FPCLINE>
      <FPCLINE>   assigning &lt;lfs_ser01&gt;</FPCLINE>
      <FPCLINE>    with key lief_nr = lv_lief_nr</FPCLINE>
      <FPCLINE>             posnr   = lv_posnr_vl</FPCLINE>
      <FPCLINE>             binary search.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if &lt;lfs_ser01&gt; is assigned.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    loop at li_objk assigning &lt;lwa_objk&gt;</FPCLINE>
      <FPCLINE>                        where obknr = &lt;lfs_ser01&gt;-obknr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Serial numbers</FPCLINE>
      <FPCLINE>      wa_item-charg = &lt;lwa_objk&gt;-sernr.</FPCLINE>
      <FPCLINE>      lv_sernr      = &lt;lwa_objk&gt;-sernr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      append wa_item to i_item.</FPCLINE>
      <FPCLINE>      clear : wa_item-fkimg,</FPCLINE>
      <FPCLINE>              wa_item-ext.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    endloop. &quot; LOOP AT li_objk ASSIGNING &lt;lwa_objk&gt;</FPCLINE>
      <FPCLINE>  endif. &quot; IF &lt;lfs_ser01&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*  LOOP AT li_objk ASSIGNING &lt;lwa_objk&gt;</FPCLINE>
      <FPCLINE>*                      WHERE matnr = &lt;lwa_item_detail&gt;-vbdpr-matnr.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    wa_item-charg = &lt;lwa_objk&gt;-sernr.</FPCLINE>
      <FPCLINE>*    lv_sernr      = &lt;lwa_objk&gt;-sernr.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>**    wa_item-fkimg = 1.</FPCLINE>
      <FPCLINE>**    wa_item-ext = wa_item-kpein * wa_item-fkimg.</FPCLINE>
      <FPCLINE>** &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    APPEND wa_item TO i_item.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>*    CLEAR : wa_item-fkimg,</FPCLINE>
      <FPCLINE>*            wa_item-ext.</FPCLINE>
      <FPCLINE>** &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDLOOP. &quot; LOOP AT li_objk ASSIGNING &lt;lwa_objk&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if lv_sernr is initial.</FPCLINE>
      <FPCLINE>    append wa_item to i_item.</FPCLINE>
      <FPCLINE>  endif. &quot; IF lv_sernr IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Reference document number required to get the Down payment</FPCLINE>
      <FPCLINE>  if &lt;lwa_item_detail&gt;-vbdpr-vgbel is not initial and</FPCLINE>
      <FPCLINE>      wa_purchase-vgbel is initial.</FPCLINE>
      <FPCLINE>    wa_purchase-vgbel = &lt;lwa_item_detail&gt;-vbdpr-vgbel.</FPCLINE>
      <FPCLINE>  endif. &quot; IF &lt;lwa_item_detail&gt;-vbdpr-vgbel IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Begin of Changes for Defect#1116 on 26-Oct-2012</FPCLINE>
      <FPCLINE>  clear: wa_item,</FPCLINE>
      <FPCLINE>         lv_sernr.</FPCLINE>
      <FPCLINE>*&amp;--End of Changes for Defect#1116 on 26-Oct-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>  clear lwa_fplt.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>  if wa_socl-land1 eq lv_ca and &quot;For Canada Invoice only</FPCLINE>
      <FPCLINE>     lv_bom eq lc_bomhdr.       &quot;BOM Header</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lv_last = lines( i_item ).</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the last record inserted for BOM Header only</FPCLINE>
      <FPCLINE>    read table i_item</FPCLINE>
      <FPCLINE>     assigning &lt;lfs_bomhdr&gt;</FPCLINE>
      <FPCLINE>         index lv_last.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lfs_bomhdr&gt; is assigned.</FPCLINE>
      <FPCLINE>* Populate the CFI details</FPCLINE>
      <FPCLINE>      clear lv_zcfi.</FPCLINE>
      <FPCLINE>      lv_zcfi = &lt;lfs_bomhdr&gt;-zcfi.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    endif. &quot; IF &lt;lfs_bomhdr&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  endif. &quot; IF wa_socl-land1 EQ lv_ca AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#8548 by SMUKHER</FPCLINE>
      <FPCLINE>  if  wa_socl-land1 = lv_ca.</FPCLINE>
      <FPCLINE>    gv_tax = lv_tax + gv_tax.</FPCLINE>
      <FPCLINE>  endif. &quot; IF wa_socl-land1 = lv_ca</FPCLINE>
      <FPCLINE>  clear: lv_tax.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#8548 by SMUKHER</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endloop. &quot; LOOP AT bil_prt_com-item_detail ASSIGNING &lt;lwa_item_detail&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetching frieght, hadling., goods charges etc...</FPCLINE>
      <FPCLINE>clear gv_fc.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>loop at li_komv assigning &lt;lwa_komv&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* CR#313 - Freight Charge will be calculated based on Condition type</FPCLINE>
      <FPCLINE>*          ZTFR instead of Subtotal4</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* BOC ADD ADAS1 CR#313</FPCLINE>
      <FPCLINE>  if &lt;lwa_komv&gt;-kschl = lc_ztfr.</FPCLINE>
      <FPCLINE>    gv_fc = gv_fc + &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>  endif. &quot; IF &lt;lwa_komv&gt;-kschl = lc_ztfr</FPCLINE>
      <FPCLINE>* EOC ADD ADAS1 CR#313</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if &lt;lwa_komv&gt;-kschl = lc_zdng.</FPCLINE>
      <FPCLINE>    gv_dg = gv_dg + &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>  endif. &quot; IF &lt;lwa_komv&gt;-kschl = lc_zdng</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if &lt;lwa_komv&gt;-kschl = lc_zhdl.</FPCLINE>
      <FPCLINE>    gv_hc = gv_hc + &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>  endif. &quot; IF &lt;lwa_komv&gt;-kschl = lc_zhdl</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Restocking fee will be populated if only billing type is ZG2 or ZRE</FPCLINE>
      <FPCLINE>*and condition type is ZRST.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if bil_prt_com-head_detail-vbdkr-fkart in li_fkart.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lwa_komv&gt;-kschl in li_kschl.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_restock = lv_restock + &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>      if lv_restock le 0.</FPCLINE>
      <FPCLINE>*Restocking fee should always be positive</FPCLINE>
      <FPCLINE>        lv_restock = lv_restock * -1.</FPCLINE>
      <FPCLINE>      endif. &quot; IF lv_restock LE 0</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_komv&gt;-kschl IN li_kschl</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF bil_prt_com-head_detail-vbdkr-fkart IN li_fkart</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* Populate Insurance charges and Documnet charges</FPCLINE>
      <FPCLINE>  if wa_socl-land1 eq lv_us.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Get Label Insurance Charges</FPCLINE>
      <FPCLINE>    if &lt;lwa_komv&gt;-kschl = lc_zins.</FPCLINE>
      <FPCLINE>      gv_ic = gv_ic + &lt;lwa_komv&gt;-kbetr.</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_komv&gt;-kschl = lc_zins</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Get Label Document Charges</FPCLINE>
      <FPCLINE>    if &lt;lwa_komv&gt;-kschl = lc_zdoc.</FPCLINE>
      <FPCLINE>      gv_dc = gv_dc + &lt;lwa_komv&gt;-kbetr.</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_komv&gt;-kschl = lc_zdoc</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF wa_socl-land1 EQ lv_us</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if wa_socl-land1 eq lv_ca and &quot;Value - CA(Canada)</FPCLINE>
      <FPCLINE>     li_perc_cond is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the value for the Current Condition type populated from EMI tool</FPCLINE>
      <FPCLINE>    unassign &lt;lfs_percon&gt;.</FPCLINE>
      <FPCLINE>    read table li_perc_cond</FPCLINE>
      <FPCLINE>     assigning &lt;lfs_percon&gt;</FPCLINE>
      <FPCLINE>      with key cond   = &lt;lwa_komv&gt;-kschl  &quot;Condition type</FPCLINE>
      <FPCLINE>               region = wa_billto-region. &quot;Region (State, Province, Country).</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if sy-subrc is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if &lt;lwa_komv&gt;-kwert is not initial.</FPCLINE>
      <FPCLINE>        lwa_cond-sum_xr1  = lwa_cond-sum_xr1 + &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        if &lt;lwa_komv&gt;-kbetr is not initial.</FPCLINE>
      <FPCLINE>          lwa_cond-perc_xr1 = &lt;lwa_komv&gt;-kbetr / 10.</FPCLINE>
      <FPCLINE>        endif. &quot; IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>      endif. &quot; IF &lt;lwa_komv&gt;-kwert IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lwa_cond-tax_xr1  = &lt;lfs_percon&gt;-taxtxt.</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*      IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*        lwa_cond-perc_xr1 = &lt;lwa_komv&gt;-kbetr / 10.</FPCLINE>
      <FPCLINE>*      ENDIF. &quot; IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>    else. &quot; ELSE -&gt; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the value for the Current Condition type populated from EMI tool</FPCLINE>
      <FPCLINE>      unassign &lt;lfs_percon&gt;.</FPCLINE>
      <FPCLINE>      read table li_perc_cond</FPCLINE>
      <FPCLINE>       assigning &lt;lfs_percon&gt;</FPCLINE>
      <FPCLINE>        with key cond = &lt;lwa_komv&gt;-kschl.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if sy-subrc is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        case &lt;lfs_percon&gt;-cond.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          when lwa_cond-cond_xr2. &quot;Value - &apos;XR2&apos;(Maintained in EMI tool)</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            if &lt;lwa_komv&gt;-kwert is not initial.</FPCLINE>
      <FPCLINE>              lwa_cond-sum_xr2  = lwa_cond-sum_xr2 + &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>              if &lt;lwa_komv&gt;-kbetr is not initial.</FPCLINE>
      <FPCLINE>                lwa_cond-perc_xr2 = &lt;lwa_komv&gt;-kbetr / 10.</FPCLINE>
      <FPCLINE>              endif. &quot; IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>            endif. &quot; IF &lt;lwa_komv&gt;-kwert IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            lwa_cond-tax_xr2  = &lt;lfs_percon&gt;-taxtxt.</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*            IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*              lwa_cond-perc_xr2 = &lt;lwa_komv&gt;-kbetr / 10.</FPCLINE>
      <FPCLINE>*            ENDIF. &quot; IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>          when lwa_cond-cond_xr3. &quot;Value - &apos;XR3&apos;(Maintained in EMI tool)</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            if &lt;lwa_komv&gt;-kwert is not initial.</FPCLINE>
      <FPCLINE>              lwa_cond-sum_xr3  = lwa_cond-sum_xr3 + &lt;lwa_komv&gt;-kwert.</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>              if &lt;lwa_komv&gt;-kbetr is not initial.</FPCLINE>
      <FPCLINE>                lwa_cond-perc_xr3 = &lt;lwa_komv&gt;-kbetr / 10 .</FPCLINE>
      <FPCLINE>              endif. &quot; IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>            endif. &quot; IF &lt;lwa_komv&gt;-kwert IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            lwa_cond-tax_xr3  = &lt;lfs_percon&gt;-taxtxt.</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*            IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*              lwa_cond-perc_xr3 = &lt;lwa_komv&gt;-kbetr / 10 .</FPCLINE>
      <FPCLINE>*            ENDIF. &quot; IF &lt;lwa_komv&gt;-kbetr IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>          when others.</FPCLINE>
      <FPCLINE>        endcase.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>    endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>  endif. &quot; IF wa_socl-land1 EQ lv_ca AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endloop. &quot; LOOP AT li_komv ASSIGNING &lt;lwa_komv&gt;</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*SORT i_item BY matnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>if i_item is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  unassign &lt;lwa_item&gt;.</FPCLINE>
      <FPCLINE>  loop at i_item assigning &lt;lwa_item&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    clear lv_tabix.</FPCLINE>
      <FPCLINE>    lv_tabix = sy-tabix.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lwa_item&gt;-bom eq lc_bomhdr. &quot;BOM Header</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      clear : li_bomhdrtxt,</FPCLINE>
      <FPCLINE>              lv_bommat.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      clear &lt;lwa_item&gt;-tdline[].</FPCLINE>
      <FPCLINE>      lv_bommat = &lt;lwa_item&gt;-matnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate DUMMY Batch split value to restrict unneccessary grouping</FPCLINE>
      <FPCLINE>* of BOM Headers having the same Material number.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if &lt;lwa_item&gt;-uecha is initial.</FPCLINE>
      <FPCLINE>        &lt;lwa_item&gt;-uecha = lv_uecha = lv_uecha + 1.</FPCLINE>
      <FPCLINE>      endif. &quot; IF &lt;lwa_item&gt;-uecha IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    elseif &lt;lwa_item&gt;-bom eq lc_bomitm and &quot;BOM Item</FPCLINE>
      <FPCLINE>           &lt;lwa_item&gt;-bommat eq lv_bommat. &quot;Same BOM Header related</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the DUMMY Batch split number to the BOM Components related</FPCLINE>
      <FPCLINE>* to the BOM Header</FPCLINE>
      <FPCLINE>      &lt;lwa_item&gt;-uecha = lv_uecha.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      clear lv_next.</FPCLINE>
      <FPCLINE>      lv_next = lv_tabix + 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Read the next record for the BOM Item related to same</FPCLINE>
      <FPCLINE>* BOM Header</FPCLINE>
      <FPCLINE>      unassign &lt;lwa_bomitem&gt;.</FPCLINE>
      <FPCLINE>      read table i_item</FPCLINE>
      <FPCLINE>       assigning &lt;lwa_bomitem&gt;</FPCLINE>
      <FPCLINE>           index lv_next.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if &lt;lwa_bomitem&gt;        is assigned  and</FPCLINE>
      <FPCLINE>         &lt;lwa_bomitem&gt;-bom    eq lc_bomitm and</FPCLINE>
      <FPCLINE>         &lt;lwa_bomitem&gt;-bommat eq lv_bommat.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        clear &lt;lwa_item&gt;-tdline.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      else. &quot; ELSE -&gt; IF &lt;lwa_bomitem&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>* Populate the value &apos;L&apos; for the last BOM Component related to</FPCLINE>
      <FPCLINE>* same BOM Header</FPCLINE>
      <FPCLINE>        &lt;lwa_item&gt;-bom = lc_bomitm_l. &quot;Last BOM Component</FPCLINE>
      <FPCLINE>      endif. &quot; IF &lt;lwa_bomitem&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_item&gt;-bom EQ lc_bomhdr</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endloop. &quot; LOOP AT i_item ASSIGNING &lt;lwa_item&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  unassign : &lt;lwa_bomitem&gt;,</FPCLINE>
      <FPCLINE>             &lt;lwa_item&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endif. &quot; IF i_item IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>loop at i_item assigning &lt;lwa_item&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch record from final output table</FPCLINE>
      <FPCLINE>  clear wa_item1.</FPCLINE>
      <FPCLINE>  read table i_item1</FPCLINE>
      <FPCLINE>   assigning &lt;lwa_item1&gt;</FPCLINE>
      <FPCLINE>    with key mat_bat = &lt;lwa_item&gt;-matnr</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>             uecha   = &lt;lwa_item&gt;-uecha.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc ne 0.</FPCLINE>
      <FPCLINE>    if &lt;lwa_item&gt;-flag is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      call function &apos;CONVERSION_EXIT_MATN1_OUTPUT&apos;</FPCLINE>
      <FPCLINE>        exporting</FPCLINE>
      <FPCLINE>          input  = &lt;lwa_item&gt;-matnr</FPCLINE>
      <FPCLINE>        importing</FPCLINE>
      <FPCLINE>          output = &lt;lwa_item&gt;-matnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      wa_item1-mat_bat = &lt;lwa_item&gt;-matnr.</FPCLINE>
      <FPCLINE>      wa_item1-arktx   = &lt;lwa_item&gt;-arktx.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      write &lt;lwa_item&gt;-lfimg to wa_item1-lfimg unit &lt;lwa_item&gt;-meins.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      wa_item1-invqty = &lt;lwa_item&gt;-fkimg.</FPCLINE>
      <FPCLINE>      write wa_item1-invqty to wa_item1-fkimg unit &lt;lwa_item&gt;-meins.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      wa_item1-ext = wa_item1-extdqty = &lt;lwa_item&gt;-ext.</FPCLINE>
      <FPCLINE>      wa_item1-meins = &lt;lwa_item&gt;-meins.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>      wa_item1-uecha = &lt;lwa_item&gt;-uecha.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Begin of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*  wa_item1-kpein   = lv_tempvalue = &lt;lwa_item&gt;-kpein. &quot;Commented</FPCLINE>
      <FPCLINE>*  wa_item1-ext     = lv_tempvalue = &lt;lwa_item&gt;-ext.   &quot;Commented</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_tempvalue = &lt;lwa_item&gt;-kpein.</FPCLINE>
      <FPCLINE>      write lv_tempvalue</FPCLINE>
      <FPCLINE>         to wa_item1-kpein</FPCLINE>
      <FPCLINE>            currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>      condense wa_item1-kpein.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      clear lv_tempvalue.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_tempvalue = &lt;lwa_item&gt;-ext.</FPCLINE>
      <FPCLINE>      write lv_tempvalue</FPCLINE>
      <FPCLINE>         to wa_item1-ext</FPCLINE>
      <FPCLINE>            currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>      condense wa_item1-ext.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--End of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      condense : wa_item1-lfimg,</FPCLINE>
      <FPCLINE>                 wa_item1-fkimg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   Begin of change on 26/07/2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      read table li_low2</FPCLINE>
      <FPCLINE>       assigning &lt;lwa_low2&gt;</FPCLINE>
      <FPCLINE>      with key low = bil_prt_com-head_detail-vbdkr-fkart.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        if wa_item1-kpein is not initial.</FPCLINE>
      <FPCLINE>          concatenate lc_minus</FPCLINE>
      <FPCLINE>                      wa_item1-kpein</FPCLINE>
      <FPCLINE>                 into wa_item1-kpein.</FPCLINE>
      <FPCLINE>        endif. &quot; IF wa_item1-kpein IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        if wa_item1-ext is not initial.</FPCLINE>
      <FPCLINE>          concatenate lc_minus</FPCLINE>
      <FPCLINE>                      wa_item1-ext</FPCLINE>
      <FPCLINE>                 into wa_item1-ext.</FPCLINE>
      <FPCLINE>        endif. &quot; IF wa_item1-ext IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        condense : wa_item1-kpein,</FPCLINE>
      <FPCLINE>                   wa_item1-ext.</FPCLINE>
      <FPCLINE>      endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      condense : wa_item1-kpein,</FPCLINE>
      <FPCLINE>                 wa_item1-ext.</FPCLINE>
      <FPCLINE>*   End of change on 26/07/2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      if lv_subsidiary  eq abap_true and &quot;Subsidy case</FPCLINE>
      <FPCLINE>         &lt;lwa_item&gt;-bom eq lc_bomhdr.    &quot;BOM Header record</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* For BOM Header belongs to Subsidiary case where the Distribution</FPCLINE>
      <FPCLINE>* channel is &apos;90&apos; and Invoice type is &apos;ZF2&apos; only print the Material</FPCLINE>
      <FPCLINE>* number and description</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        clear : wa_item1-kpein  ,</FPCLINE>
      <FPCLINE>                wa_item1-ext    ,</FPCLINE>
      <FPCLINE>                wa_item1-tdline.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Starting caption</FPCLINE>
      <FPCLINE>        lwa_item1-mat_bat = lc_star. &quot;Value - &apos;***&apos;</FPCLINE>
      <FPCLINE>        lwa_item1-arktx   = lc_begin. &quot;Value - &apos;Begin of BoM&apos;</FPCLINE>
      <FPCLINE>        append lwa_item1 to i_item1.</FPCLINE>
      <FPCLINE>        clear lwa_item1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF lv_subsidiary EQ abap_true AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    endif. &quot; IF &lt;lwa_item&gt;-flag IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lwa_item&gt;-bom is not initial.</FPCLINE>
      <FPCLINE>      wa_item1-bomhdr = &lt;lwa_item&gt;-bom.</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_item&gt;-bom IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if wa_item1 is not initial.</FPCLINE>
      <FPCLINE>      append wa_item1 to i_item1.</FPCLINE>
      <FPCLINE>      clear wa_item1.</FPCLINE>
      <FPCLINE>    endif. &quot; IF wa_item1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lwa_item&gt;-zcfi is not initial.</FPCLINE>
      <FPCLINE>      wa_item1-arktx = &lt;lwa_item&gt;-zcfi.</FPCLINE>
      <FPCLINE>      append wa_item1 to i_item1.</FPCLINE>
      <FPCLINE>      clear wa_item1.</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_item&gt;-zcfi IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  else. &quot; ELSE -&gt; IF sy-subrc NE 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Comment for D2_OTC_FDD_0014 Defect# 8720 by VGAUR</FPCLINE>
      <FPCLINE>** ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>*    IF lv_subsidiary IS INITIAL.</FPCLINE>
      <FPCLINE>** &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>* &lt;--- End of Comment for D2_OTC_FDD_0014 Defect# 8720 by VGAUR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    if &lt;lwa_item&gt;-flag is initial. &quot;Excluded for BOM Item</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Aggregate the Quantity shipped for the same material</FPCLINE>
      <FPCLINE>      &lt;lwa_item1&gt;-invqty = &lt;lwa_item1&gt;-invqty + &lt;lwa_item&gt;-fkimg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      &lt;lwa_item1&gt;-extdqty = &lt;lwa_item1&gt;-extdqty + &lt;lwa_item&gt;-ext.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* The following population is excluded for the BOM Item</FPCLINE>
      <FPCLINE>      clear : &lt;lwa_item1&gt;-fkimg,</FPCLINE>
      <FPCLINE>              &lt;lwa_item1&gt;-ext.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      write : &lt;lwa_item1&gt;-invqty  to &lt;lwa_item1&gt;-fkimg</FPCLINE>
      <FPCLINE>                                unit &lt;lwa_item&gt;-meins  ,</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*Extended price format should be of type input currency not of decimals 2</FPCLINE>
      <FPCLINE>*                &lt;lwa_item1&gt;-extdqty TO &lt;lwa_item1&gt;-ext DECIMALS 2.</FPCLINE>
      <FPCLINE>&lt;lwa_item1&gt;-extdqty to &lt;lwa_item1&gt;-ext currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      condense : &lt;lwa_item1&gt;-ext,</FPCLINE>
      <FPCLINE>                 &lt;lwa_item1&gt;-fkimg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Comment for D2_OTC_FDD_0014 Defect# 8720 by VGAUR</FPCLINE>
      <FPCLINE>*      ENDIF. &quot; IF lv_subsidiary IS INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Comment for D2_OTC_FDD_0014 Defect# 8720 by VGAUR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_item&gt;-flag IS INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF sy-subrc NE 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if &lt;lwa_item&gt;-charg is not initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    call function &apos;CONVERSION_EXIT_GERNR_OUTPUT&apos;</FPCLINE>
      <FPCLINE>      exporting</FPCLINE>
      <FPCLINE>        input  = &lt;lwa_item&gt;-charg</FPCLINE>
      <FPCLINE>      importing</FPCLINE>
      <FPCLINE>        output = &lt;lwa_item&gt;-charg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    concatenate space</FPCLINE>
      <FPCLINE>                space</FPCLINE>
      <FPCLINE>                &lt;lwa_item&gt;-charg</FPCLINE>
      <FPCLINE>           into &lt;lwa_item&gt;-charg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    shift &lt;lwa_item&gt;-charg right deleting trailing space.</FPCLINE>
      <FPCLINE>    wa_item1-mat_bat = &lt;lwa_item&gt;-charg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF &lt;lwa_item&gt;-charg IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*  WRITE &lt;lwa_item&gt;-lfimg TO wa_item1-lfimg UNIT &lt;lwa_item&gt;-meins.</FPCLINE>
      <FPCLINE>*  WRITE &lt;lwa_item&gt;-fkimg TO wa_item1-fkimg UNIT &lt;lwa_item&gt;-meins.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  wa_item1-meins  = &lt;lwa_item&gt;-meins.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>**&amp;--Begin of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>**  wa_item1-kpein   = lv_tempvalue = &lt;lwa_item&gt;-kpein. &quot;Commented</FPCLINE>
      <FPCLINE>**  wa_item1-ext     = lv_tempvalue = &lt;lwa_item&gt;-ext.   &quot;Commented</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  lv_tempvalue = &lt;lwa_item&gt;-kpein.</FPCLINE>
      <FPCLINE>*  WRITE lv_tempvalue</FPCLINE>
      <FPCLINE>*     TO wa_item1-kpein</FPCLINE>
      <FPCLINE>*        CURRENCY bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>*  CONDENSE wa_item1-kpein.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  CLEAR lv_tempvalue.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  lv_tempvalue = &lt;lwa_item&gt;-ext.</FPCLINE>
      <FPCLINE>*  WRITE lv_tempvalue</FPCLINE>
      <FPCLINE>*     TO wa_item1-ext</FPCLINE>
      <FPCLINE>*        CURRENCY bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>*  CONDENSE wa_item1-ext.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>**&amp;--End of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  CONDENSE : wa_item1-lfimg,</FPCLINE>
      <FPCLINE>*             wa_item1-fkimg.</FPCLINE>
      <FPCLINE>**   Begin of change on 26/07/2012</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  READ TABLE li_low2</FPCLINE>
      <FPCLINE>*   ASSIGNING &lt;lwa_low2&gt;</FPCLINE>
      <FPCLINE>*  WITH KEY low = bil_prt_com-head_detail-vbdkr-fkart.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF wa_item1-kpein IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*      CONCATENATE lc_minus</FPCLINE>
      <FPCLINE>*                  wa_item1-kpein</FPCLINE>
      <FPCLINE>*             INTO wa_item1-kpein.</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF wa_item1-kpein IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF wa_item1-ext IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*      CONCATENATE lc_minus</FPCLINE>
      <FPCLINE>*                  wa_item1-ext</FPCLINE>
      <FPCLINE>*             INTO wa_item1-ext.</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF wa_item1-ext IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    CONDENSE : wa_item1-kpein,</FPCLINE>
      <FPCLINE>*               wa_item1-ext.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  CONDENSE : wa_item1-kpein,</FPCLINE>
      <FPCLINE>*             wa_item1-ext.</FPCLINE>
      <FPCLINE>**   End of change on 26/07/2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*  APPEND wa_item1 TO i_item1.</FPCLINE>
      <FPCLINE>*  CLEAR wa_item1-arktx.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>*  AT END OF matnr.</FPCLINE>
      <FPCLINE>  at end of uecha.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    if lv_subsidiary is initial.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Actual quantity conversion into base Currency format</FPCLINE>
      <FPCLINE>      if &lt;lwa_item1&gt; is assigned and</FPCLINE>
      <FPCLINE>         &lt;lwa_item&gt;-flag is initial.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* The following population is excluded for the BOM Item</FPCLINE>
      <FPCLINE>        clear : &lt;lwa_item1&gt;-fkimg,</FPCLINE>
      <FPCLINE>                &lt;lwa_item1&gt;-ext.</FPCLINE>
      <FPCLINE>        write : &lt;lwa_item1&gt;-invqty  to &lt;lwa_item1&gt;-fkimg</FPCLINE>
      <FPCLINE>                                  unit &lt;lwa_item&gt;-meins ,</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*Extended price format should be of type input currency</FPCLINE>
      <FPCLINE>*                &lt;lwa_item1&gt;-extdqty TO &lt;lwa_item1&gt;-ext DECIMALS 2.</FPCLINE>
      <FPCLINE>&lt;lwa_item1&gt;-extdqty to &lt;lwa_item1&gt;-ext currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>* &lt;lwa_item1&gt;-ext = &lt;lwa_item1&gt;-extdqty.</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>        condense : &lt;lwa_item1&gt;-ext,</FPCLINE>
      <FPCLINE>                   &lt;lwa_item1&gt;-fkimg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      endif. &quot; IF &lt;lwa_item1&gt; IS ASSIGNED AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    endif. &quot; IF lv_subsidiary IS INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    if &lt;lwa_item&gt;-tdline is not initial.</FPCLINE>
      <FPCLINE>      wa_item1-tdline[] = &lt;lwa_item&gt;-tdline[].</FPCLINE>
      <FPCLINE>    endif. &quot; IF &lt;lwa_item&gt;-tdline IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endat.</FPCLINE>
      <FPCLINE>*  ENDAT.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if wa_item1 is not initial.</FPCLINE>
      <FPCLINE>    append wa_item1 to i_item1.</FPCLINE>
      <FPCLINE>    clear wa_item1.</FPCLINE>
      <FPCLINE>  endif. &quot; IF wa_item1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  unassign &lt;lfs_item1&gt;.</FPCLINE>
      <FPCLINE>  clear wa_item1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* For BOM Header belongs to Subsidiary case where the Distribution</FPCLINE>
      <FPCLINE>* channel is &apos;90&apos; and Invoice type is &apos;ZF2&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if lv_subsidiary is not initial and</FPCLINE>
      <FPCLINE>     &lt;lwa_item&gt;-bom eq lc_bomitm_l. &quot;Value - &apos;L&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Ending caption</FPCLINE>
      <FPCLINE>    lwa_item1-mat_bat = lc_star. &quot;Value - &apos;***&apos;</FPCLINE>
      <FPCLINE>    lwa_item1-arktx   = lc_end. &quot;Value - &apos;End of BoM&apos;</FPCLINE>
      <FPCLINE>    append lwa_item1 to i_item1.</FPCLINE>
      <FPCLINE>    clear : lwa_item1,</FPCLINE>
      <FPCLINE>            lv_bom.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF lv_subsidiary IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5999/CR_628 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* If there is one entry found for No Tax Indicator then only</FPCLINE>
      <FPCLINE>* print the &quot;Non Taxable&quot; indicator at the bottom in output</FPCLINE>
      <FPCLINE>  if gv_notaxind is initial and</FPCLINE>
      <FPCLINE>     &lt;lwa_item&gt;-zcfi cs lwa_notax-text+0(4). &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    gv_notaxind = lwa_notax-text+0(4). &quot;Value - &quot;NT&quot;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  endif. &quot; IF gv_notaxind IS INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endloop. &quot; LOOP AT i_item ASSIGNING &lt;lwa_item&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY.</FPCLINE>
      <FPCLINE>loop at i_item1 assigning &lt;lwa_item1&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if &lt;lwa_item1&gt;-mat_bat is initial and</FPCLINE>
      <FPCLINE>     &lt;lwa_item1&gt;-arktx   is initial and</FPCLINE>
      <FPCLINE>     &lt;lwa_item1&gt;-tdline  is initial.</FPCLINE>
      <FPCLINE>    &lt;lwa_item1&gt;-bomhdr = abap_true.</FPCLINE>
      <FPCLINE>  endif. &quot; IF &lt;lwa_item1&gt;-mat_bat IS INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endloop. &quot; LOOP AT i_item1 ASSIGNING &lt;lwa_item1&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>delete i_item1 where bomhdr eq abap_true. &quot;Delete records</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D3_OTC_FDD_0014_Defect#8904 by RAM.</FPCLINE>
      <FPCLINE>* BOM Header text is getting cleared by earlier code and try to insert the</FPCLINE>
      <FPCLINE>* text again only for BOM Header.</FPCLINE>
      <FPCLINE>loop at i_item1 assigning &lt;lwa_item1&gt; WHERE bomhdr = lc_bomhdr.</FPCLINE>
      <FPCLINE>  if &lt;lwa_item1&gt; is assigned.</FPCLINE>
      <FPCLINE>    select single kdmat into lv_kdmat from knmt</FPCLINE>
      <FPCLINE>      where vkorg = bil_prt_com-head_detail-vbdkr-vkorg and</FPCLINE>
      <FPCLINE>            vtweg = bil_prt_com-head_detail-vbdkr-vtweg and</FPCLINE>
      <FPCLINE>            kunnr = bil_prt_com-head_detail-vbdkr-kunag and</FPCLINE>
      <FPCLINE>            matnr = &lt;lwa_item1&gt;-mat_bat .</FPCLINE>
      <FPCLINE>    if sy-subrc eq 0.</FPCLINE>
      <FPCLINE>      clear lwa_txtval.</FPCLINE>
      <FPCLINE>      perform f_populate_text_val  using lc_cmir      &quot;CMIR Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         lv_nastspras &quot;Language key</FPCLINE>
      <FPCLINE>                                changing lwa_txtval.  &quot;Standard</FPCLINE>
      <FPCLINE>      concatenate lwa_txtval-text lv_kdmat into lwa_txtval-text separated by space.</FPCLINE>
      <FPCLINE>      insert lwa_txtval-text into &lt;lwa_item1&gt;-tdline index 1.</FPCLINE>
      <FPCLINE>    endif.</FPCLINE>
      <FPCLINE>  endif.</FPCLINE>
      <FPCLINE>endloop.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D3_OTC_FDD_0014_Defect#8904 by RAM</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*gv_fc  = gv_fc  - gv_hc. &quot; Added by SBASU As KWI4 has both freight and handling</FPCLINE>
      <FPCLINE>* Calculating sub total and total....</FPCLINE>
      <FPCLINE>gv_fc_hc = gv_fc + gv_hc.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*Total should have new added charges( Insurance charges (gv_ic) and</FPCLINE>
      <FPCLINE>*document charges(gc_dc)</FPCLINE>
      <FPCLINE>*gv_total = gv_sub + gv_fc_hc + gv_dg + gv_tax.</FPCLINE>
      <FPCLINE>gv_total = gv_sub + gv_fc_hc + gv_dg + gv_tax + gv_ic + gv_dc.</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Get the Down payment details</FPCLINE>
      <FPCLINE>perform f_get_advance_payment  using bil_prt_com-head_detail-vbdkr</FPCLINE>
      <FPCLINE>                                     wa_purchase-vgbel</FPCLINE>
      <FPCLINE>                            changing lv_advpmt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>lv_fintot = gv_total - lv_advpmt.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Begin of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*gv_fc2 = gv_fc.        &quot;Commented</FPCLINE>
      <FPCLINE>*gv_hc2 = gv_hc.        &quot;Commented</FPCLINE>
      <FPCLINE>*gv_dg2 = gv_dg.        &quot;Commented</FPCLINE>
      <FPCLINE>*gv_tax2 = gv_tax.      &quot;Commented</FPCLINE>
      <FPCLINE>*gv_sub2 = gv_sub.      &quot;Commented</FPCLINE>
      <FPCLINE>*gv_total2 = gv_total.  &quot;Commented</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Begin of changes for defect# 991 on 26-Oct-2012</FPCLINE>
      <FPCLINE>*  NO GROUPING statment was there in below WRITE statements resulting</FPCLINE>
      <FPCLINE>*  in no comma for thousand separator. Now NO GROUPING statement is</FPCLINE>
      <FPCLINE>*  removed resulting in comma for thousand separator.</FPCLINE>
      <FPCLINE>*&amp;--End of changes for defect# 991 on 26-Oct-2012</FPCLINE>
      <FPCLINE>write gv_fc to gv_fc2</FPCLINE>
      <FPCLINE>            currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>condense gv_fc2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>write gv_hc to gv_hc2</FPCLINE>
      <FPCLINE>            currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>condense gv_hc2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>write gv_dg to gv_dg2</FPCLINE>
      <FPCLINE>            currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>condense gv_dg2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>write gv_tax to gv_tax2</FPCLINE>
      <FPCLINE>             currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>condense gv_tax2.</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if lv_restock is not initial.</FPCLINE>
      <FPCLINE>*Deducting Restock fee from the total value to have a better visibility about the credit value</FPCLINE>
      <FPCLINE>  gv_total = gv_total - lv_restock.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  write lv_restock to gv_restock</FPCLINE>
      <FPCLINE>                   currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  condense gv_restock.</FPCLINE>
      <FPCLINE>endif. &quot; IF lv_restock IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>if lv_kurrf is not initial.</FPCLINE>
      <FPCLINE>  write lv_kurrf to gv_exchange</FPCLINE>
      <FPCLINE>                 currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  condense gv_exchange.</FPCLINE>
      <FPCLINE>endif. &quot; IF lv_kurrf IS NOT INITIAL</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>write gv_sub to gv_sub2</FPCLINE>
      <FPCLINE>             currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>condense gv_sub2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>write gv_total to gv_total2</FPCLINE>
      <FPCLINE>               currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>condense gv_total2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--End of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>if gv_ic is not initial.</FPCLINE>
      <FPCLINE>  write gv_ic to gv_ic2</FPCLINE>
      <FPCLINE>         currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>  condense gv_ic2.</FPCLINE>
      <FPCLINE>else. &quot; ELSE -&gt; IF gv_ic IS NOT INITIAL</FPCLINE>
      <FPCLINE>  clear gv_ic2.</FPCLINE>
      <FPCLINE>endif. &quot; IF gv_ic IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if gv_dc is not initial.</FPCLINE>
      <FPCLINE>  write gv_dc to gv_dc2</FPCLINE>
      <FPCLINE>         currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>  condense gv_dc2.</FPCLINE>
      <FPCLINE>else. &quot; ELSE -&gt; IF gv_dc IS NOT INITIAL</FPCLINE>
      <FPCLINE>  clear gv_dc2.</FPCLINE>
      <FPCLINE>endif. &quot; IF gv_dc IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if gv_fc is initial.</FPCLINE>
      <FPCLINE>  clear gv_fc2.</FPCLINE>
      <FPCLINE>endif. &quot; IF gv_fc IS INITIAL</FPCLINE>
      <FPCLINE>if gv_hc is initial.</FPCLINE>
      <FPCLINE>  clear gv_hc2.</FPCLINE>
      <FPCLINE>endif. &quot; IF gv_hc IS INITIAL</FPCLINE>
      <FPCLINE>if gv_dg is initial.</FPCLINE>
      <FPCLINE>  clear gv_dg2.</FPCLINE>
      <FPCLINE>endif. &quot; IF gv_dg IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if lv_advpmt is not initial.</FPCLINE>
      <FPCLINE>* Currency conversion</FPCLINE>
      <FPCLINE>  write lv_advpmt to lv_advpmt2.</FPCLINE>
      <FPCLINE>  condense lv_advpmt2.</FPCLINE>
      <FPCLINE>endif. &quot; IF lv_advpmt IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Currency conversion</FPCLINE>
      <FPCLINE>write lv_fintot</FPCLINE>
      <FPCLINE>   to lv_fintot2</FPCLINE>
      <FPCLINE>      currency bil_prt_com-head_detail-doc_currency.</FPCLINE>
      <FPCLINE>condense lv_fintot2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>*   Begin of change on 26t/07/2012</FPCLINE>
      <FPCLINE>read table li_low2</FPCLINE>
      <FPCLINE> assigning &lt;lwa_low2&gt;</FPCLINE>
      <FPCLINE>  with key low = bil_prt_com-head_detail-vbdkr-fkart.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-subrc = 0.</FPCLINE>
      <FPCLINE>  gv_payment_text = lc_payment_text2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if gv_fc gt 0.</FPCLINE>
      <FPCLINE>    concatenate lc_minus</FPCLINE>
      <FPCLINE>                gv_fc2</FPCLINE>
      <FPCLINE>           into gv_fc2.</FPCLINE>
      <FPCLINE>  endif. &quot; IF gv_fc GT 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if gv_hc gt 0.</FPCLINE>
      <FPCLINE>    concatenate lc_minus</FPCLINE>
      <FPCLINE>                gv_hc2</FPCLINE>
      <FPCLINE>           into gv_hc2.</FPCLINE>
      <FPCLINE>  endif. &quot; IF gv_hc GT 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if gv_dg gt 0.</FPCLINE>
      <FPCLINE>    concatenate lc_minus</FPCLINE>
      <FPCLINE>                gv_dg2</FPCLINE>
      <FPCLINE>           into gv_dg2.</FPCLINE>
      <FPCLINE>  endif. &quot; IF gv_dg GT 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if gv_tax gt 0.</FPCLINE>
      <FPCLINE>    concatenate lc_minus</FPCLINE>
      <FPCLINE>                gv_tax2</FPCLINE>
      <FPCLINE>           into gv_tax2.</FPCLINE>
      <FPCLINE>  endif. &quot; IF gv_tax GT 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  if gv_sub gt 0.</FPCLINE>
      <FPCLINE>    concatenate lc_minus</FPCLINE>
      <FPCLINE>                gv_sub2</FPCLINE>
      <FPCLINE>           into gv_sub2.</FPCLINE>
      <FPCLINE>  endif. &quot; IF gv_sub GT 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if gv_total gt 0.</FPCLINE>
      <FPCLINE>    concatenate lc_minus</FPCLINE>
      <FPCLINE>                gv_total2</FPCLINE>
      <FPCLINE>           into gv_total2.</FPCLINE>
      <FPCLINE>  endif. &quot; IF gv_total GT 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if lv_advpmt gt 0. &quot;Advance payment</FPCLINE>
      <FPCLINE>    concatenate lc_minus</FPCLINE>
      <FPCLINE>                lv_advpmt2</FPCLINE>
      <FPCLINE>           into lv_advpmt2.</FPCLINE>
      <FPCLINE>    condense lv_advpmt2 no-gaps.</FPCLINE>
      <FPCLINE>  endif. &quot; IF lv_advpmt GT 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if lv_fintot gt 0. &quot;Final total</FPCLINE>
      <FPCLINE>    concatenate lc_minus</FPCLINE>
      <FPCLINE>                lv_fintot2</FPCLINE>
      <FPCLINE>           into lv_fintot2.</FPCLINE>
      <FPCLINE>    condense lv_fintot2 no-gaps.</FPCLINE>
      <FPCLINE>  endif. &quot; IF lv_fintot GT 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  condense : gv_fc2   ,</FPCLINE>
      <FPCLINE>             gv_hc2   ,</FPCLINE>
      <FPCLINE>             gv_total2,</FPCLINE>
      <FPCLINE>             gv_sub2  ,</FPCLINE>
      <FPCLINE>             gv_dg2   ,</FPCLINE>
      <FPCLINE>             gv_tax2,</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>             gv_restock,</FPCLINE>
      <FPCLINE>             gv_exchange.</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>else. &quot; ELSE -&gt; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>  gv_payment_text = lc_payment_text.</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   End of change on 26/07/2012</FPCLINE>
      <FPCLINE>*&amp;--Check Production Client</FPCLINE>
      <FPCLINE>select low    &quot; ABAP/4: Selection value (LOW or HIGH value, external format)</FPCLINE>
      <FPCLINE>  from tvarvc &quot; Table of Variant Variables (Client-Specific)</FPCLINE>
      <FPCLINE>    up to 1 rows</FPCLINE>
      <FPCLINE>  into lv_prod</FPCLINE>
      <FPCLINE> where name = lc_prod_name.</FPCLINE>
      <FPCLINE>endselect .</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-sysid = lv_prod.</FPCLINE>
      <FPCLINE>  gv_production = abap_true.</FPCLINE>
      <FPCLINE>*&amp;--If not Production client then</FPCLINE>
      <FPCLINE>*&amp;--convert watermark image to Binary format</FPCLINE>
      <FPCLINE>else. &quot; ELSE -&gt; IF sy-sysid = lv_prod</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  call method cl_ssf_xsf_utilities=&gt;get_bds_graphic_as_bmp</FPCLINE>
      <FPCLINE>    exporting</FPCLINE>
      <FPCLINE>      p_object       = lc_graphics</FPCLINE>
      <FPCLINE>      p_name         = lc_draft_image</FPCLINE>
      <FPCLINE>      p_id           = lc_image_id</FPCLINE>
      <FPCLINE>      p_btype        = lc_image_type</FPCLINE>
      <FPCLINE>    receiving</FPCLINE>
      <FPCLINE>      p_bmp          = gv_image_bin</FPCLINE>
      <FPCLINE>    exceptions</FPCLINE>
      <FPCLINE>      not_found      = 1</FPCLINE>
      <FPCLINE>      internal_error = 2</FPCLINE>
      <FPCLINE>      others         = 3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  if sy-subrc &lt;&gt; 0.</FPCLINE>
      <FPCLINE>* Display error message</FPCLINE>
      <FPCLINE>    message id sy-msgid</FPCLINE>
      <FPCLINE>          type sy-msgty</FPCLINE>
      <FPCLINE>        number sy-msgno</FPCLINE>
      <FPCLINE>          with sy-msgv1</FPCLINE>
      <FPCLINE>               sy-msgv2</FPCLINE>
      <FPCLINE>               sy-msgv3</FPCLINE>
      <FPCLINE>               sy-msgv4.</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc &lt;&gt; 0</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-sysid = lv_prod</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*** Convert Logo to Binary Format...</FPCLINE>
      <FPCLINE>call method cl_ssf_xsf_utilities=&gt;get_bds_graphic_as_bmp</FPCLINE>
      <FPCLINE>  exporting</FPCLINE>
      <FPCLINE>    p_object       = lc_graphics</FPCLINE>
      <FPCLINE>    p_name         = lc_logo_image</FPCLINE>
      <FPCLINE>    p_id           = lc_image_id</FPCLINE>
      <FPCLINE>    p_btype        = lc_image_type</FPCLINE>
      <FPCLINE>  receiving</FPCLINE>
      <FPCLINE>    p_bmp          = gv_image_bin2</FPCLINE>
      <FPCLINE>  exceptions</FPCLINE>
      <FPCLINE>    not_found      = 1</FPCLINE>
      <FPCLINE>    internal_error = 2</FPCLINE>
      <FPCLINE>    others         = 3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>if sy-subrc &lt;&gt; 0.</FPCLINE>
      <FPCLINE>* Display error message</FPCLINE>
      <FPCLINE>  message id sy-msgid</FPCLINE>
      <FPCLINE>        type sy-msgty</FPCLINE>
      <FPCLINE>      number sy-msgno</FPCLINE>
      <FPCLINE>        with sy-msgv1</FPCLINE>
      <FPCLINE>             sy-msgv2</FPCLINE>
      <FPCLINE>             sy-msgv3</FPCLINE>
      <FPCLINE>             sy-msgv4.</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc &lt;&gt; 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Assinging US to sender country becuse this form will be</FPCLINE>
      <FPCLINE>* used in US domestic purpose only...</FPCLINE>
      <FPCLINE>*gv_land = lc_us.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Begin of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE>concatenate bil_prt_com-head_detail-doc_currency &quot;Document Currency Key</FPCLINE>
      <FPCLINE>            lc_colon                             &quot;Colon</FPCLINE>
      <FPCLINE>       into gv_cuky</FPCLINE>
      <FPCLINE>       separated by space.</FPCLINE>
      <FPCLINE>*&amp;--End of changes for defect# 781 on 18-Oct-2012</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>gv_land = wa_socl-land1.</FPCLINE>
      <FPCLINE>if wa_socl-land1 eq lv_ca. &quot;Value - CA(Canada)</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the final total values</FPCLINE>
      <FPCLINE>  perform f_populate_final_total  using abap_true &quot;Canada</FPCLINE>
      <FPCLINE>                                        gv_sub2   &quot;Subtotal</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                        gv_restock</FPCLINE>
      <FPCLINE>                                        bil_prt_com-head_detail &quot;Header Details for Print</FPCLINE>
      <FPCLINE>                                        li_regno_com            &quot; REGNO required com</FPCLINE>
      <FPCLINE>                                        li_fkart</FPCLINE>
      <FPCLINE>                                        li_kschl</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                        gv_tax2 &quot;Tax</FPCLINE>
      <FPCLINE>                                        gv_fc2  &quot;Freight Charge</FPCLINE>
      <FPCLINE>                                        gv_hc2  &quot;Handling Charge</FPCLINE>
      <FPCLINE>                                        gv_dg2  &quot;Dangerous Goods Charge</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                        gv_ic2 &quot;Label Insurance charges</FPCLINE>
      <FPCLINE>                                        gv_dc2 &quot;Document charges</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                        gv_cuky    &quot;Document currency</FPCLINE>
      <FPCLINE>                                        gv_total2  &quot;Interim total</FPCLINE>
      <FPCLINE>                                        lv_advpmt2 &quot;Advance payment</FPCLINE>
      <FPCLINE>                                        lv_fintot2 &quot;Final total</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                        gv_exchange</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                        wa_socl</FPCLINE>
      <FPCLINE>                               changing i_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Customer details for the Invoice</FPCLINE>
      <FPCLINE>  perform f_fill_customer     using wa_socl</FPCLINE>
      <FPCLINE>                           changing wa_cust     &quot;Customer for US</FPCLINE>
      <FPCLINE>                                    wa_cust1    &quot;Customer Canada specific</FPCLINE>
      <FPCLINE>                                    gv_invoice. &quot;Invoice number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  clear wa_cust1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** Populate the CASE ID</FPCLINE>
      <FPCLINE>*  PERFORM f_populate_cid_ordch   USING abap_true</FPCLINE>
      <FPCLINE>*                                       lv_nastspras &quot;Message Status</FPCLINE>
      <FPCLINE>*                                       space</FPCLINE>
      <FPCLINE>*                              CHANGING i_reference.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** Populate the Purchase Order Header text</FPCLINE>
      <FPCLINE>*  PERFORM f_populate_pohdr_txt  USING abap_true</FPCLINE>
      <FPCLINE>*                                      lv_nastspras &quot;Language based on Control settings</FPCLINE>
      <FPCLINE>*                                      wa_purchase</FPCLINE>
      <FPCLINE>*                                      gv_ship_from</FPCLINE>
      <FPCLINE>*                             CHANGING wa_purchase_ca.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* If the Case Reference No(VBRK-ZZCASEREF) is empty then the values</FPCLINE>
      <FPCLINE>* for Canada will be populated in the structure maintained for US to</FPCLINE>
      <FPCLINE>* keep the display in synch</FPCLINE>
      <FPCLINE>*  IF wa_purchase_ca-caseref IS INITIAL.</FPCLINE>
      <FPCLINE>*    wa_purchase_us = wa_purchase_ca.</FPCLINE>
      <FPCLINE>*    CLEAR wa_purchase_ca.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF wa_purchase_ca-caseref IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Tax details</FPCLINE>
      <FPCLINE>  perform f_populate_tax_summary    using lwa_cond &quot;Condition summed up values</FPCLINE>
      <FPCLINE>                                 changing i_taxsumm.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>elseif wa_socl-land1 eq lv_us. &quot;Value - US(United States)</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the final total values</FPCLINE>
      <FPCLINE>  perform f_populate_final_total  using space   &quot;USA</FPCLINE>
      <FPCLINE>                                        gv_sub2 &quot;Subtotal</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                        gv_restock</FPCLINE>
      <FPCLINE>                                        bil_prt_com-head_detail &quot;Header Details for Print</FPCLINE>
      <FPCLINE>                                        li_regno_com            &quot; REGNO required com</FPCLINE>
      <FPCLINE>                                        li_fkart</FPCLINE>
      <FPCLINE>                                        li_kschl</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                        gv_tax2 &quot;Tax</FPCLINE>
      <FPCLINE>                                        gv_fc2  &quot;Freight Charge</FPCLINE>
      <FPCLINE>                                        gv_hc2  &quot;Handling Charge</FPCLINE>
      <FPCLINE>                                        gv_dg2  &quot;Dangerous Goods Charge</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                        gv_ic2 &quot;Label Insurance charges</FPCLINE>
      <FPCLINE>                                        gv_dc2 &quot;Document charges</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                        gv_cuky    &quot;Document currency</FPCLINE>
      <FPCLINE>                                        gv_total2  &quot;Interim total</FPCLINE>
      <FPCLINE>                                        lv_advpmt2 &quot;Advance payment</FPCLINE>
      <FPCLINE>                                        lv_fintot2 &quot;Final total</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                        gv_exchange</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                        wa_socl</FPCLINE>
      <FPCLINE>                               changing i_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  clear wa_promo.</FPCLINE>
      <FPCLINE>* Populate the PROMO CODE(Header Text)</FPCLINE>
      <FPCLINE>  perform f_populate_promo_code  using lv_name           &quot;Billing Document number</FPCLINE>
      <FPCLINE>                                       lwa_tdobj-id_z012 &quot;Text ID</FPCLINE>
      <FPCLINE>                                       lv_nastspras      &quot;Message Status</FPCLINE>
      <FPCLINE>                              changing wa_promo.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Customer details for the Invoice</FPCLINE>
      <FPCLINE>  perform f_fill_customer     using wa_socl</FPCLINE>
      <FPCLINE>                           changing wa_cust     &quot;Customer for US</FPCLINE>
      <FPCLINE>                                    wa_cust1    &quot;Customer Canada specific</FPCLINE>
      <FPCLINE>                                    gv_invoice. &quot;Invoice number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  clear wa_cust.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** Populate the CASE ID</FPCLINE>
      <FPCLINE>*  PERFORM f_populate_cid_ordch   USING space</FPCLINE>
      <FPCLINE>*                                       lv_nastspras &quot;Message Status</FPCLINE>
      <FPCLINE>*                                       wa_purchase-zzcaseref</FPCLINE>
      <FPCLINE>*                              CHANGING i_reference.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** Populate the Purchase Order Header text</FPCLINE>
      <FPCLINE>*  PERFORM f_populate_pohdr_txt  USING space</FPCLINE>
      <FPCLINE>*                                      lv_nastspras &quot;Language based on Control settings</FPCLINE>
      <FPCLINE>*                                      wa_purchase</FPCLINE>
      <FPCLINE>*                                      gv_ship_from</FPCLINE>
      <FPCLINE>*                             CHANGING wa_purchase_us.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>endif. &quot; IF wa_socl-land1 EQ lv_ca</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Purchase Order Header text</FPCLINE>
      <FPCLINE>perform f_populate_pohdr_txt  using wa_socl</FPCLINE>
      <FPCLINE>                                    wa_purchase</FPCLINE>
      <FPCLINE>                                    gv_ship_from</FPCLINE>
      <FPCLINE>                           changing wa_po_txt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the CASE ID</FPCLINE>
      <FPCLINE>perform f_populate_salesord_det   using wa_socl</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>                                        wa_sales</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>                                        wa_purchase-zzcaseref</FPCLINE>
      <FPCLINE>                               changing i_reference</FPCLINE>
      <FPCLINE>                                        i_salesord</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>                                        wa_salesord_1</FPCLINE>
      <FPCLINE>                                        wa_salesord_2</FPCLINE>
      <FPCLINE>                                        wa_salesord_3</FPCLINE>
      <FPCLINE>                                        wa_reference_1</FPCLINE>
      <FPCLINE>                                        wa_reference_2.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Address table for Ship to Partner</FPCLINE>
      <FPCLINE>perform f_fill_address_tab  using wa_shipto</FPCLINE>
      <FPCLINE>                                  space</FPCLINE>
      <FPCLINE>                                  lv_nastspras</FPCLINE>
      <FPCLINE>                                  wa_socl</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                   bil_prt_com-head_detail &quot;Header Details for Print</FPCLINE>
      <FPCLINE>*&lt;---End of Insert D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                         changing i_shipto_add</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                  wa_add_shipto.</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Address table for Bill to Partner</FPCLINE>
      <FPCLINE>perform f_fill_address_tab  using wa_billto</FPCLINE>
      <FPCLINE>                                  abap_true</FPCLINE>
      <FPCLINE>                                  lv_nastspras</FPCLINE>
      <FPCLINE>                                  wa_socl</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                  bil_prt_com-head_detail &quot;Header Details for Print</FPCLINE>
      <FPCLINE>*&lt;---End of Insert D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                         changing i_billto_add</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                  wa_add_billto.</FPCLINE>
      <FPCLINE>**Populate Remit To address for singapore</FPCLINE>
      <FPCLINE>read table li_regno_com with key bukrs = bil_prt_com-head_detail-vbdkr-bukrs</FPCLINE>
      <FPCLINE>            transporting no fields.</FPCLINE>
      <FPCLINE>if sy-subrc is initial.</FPCLINE>
      <FPCLINE>  refresh:  li_lines[].</FPCLINE>
      <FPCLINE>  clear: lwa_txtval.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Get the Standard text</FPCLINE>
      <FPCLINE>  call function &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>    exporting</FPCLINE>
      <FPCLINE>      id                      = lc_id_std</FPCLINE>
      <FPCLINE>      language                = lv_nastspras</FPCLINE>
      <FPCLINE>      name                    = lc_remitto_sgp</FPCLINE>
      <FPCLINE>      object                  = lc_text</FPCLINE>
      <FPCLINE>    tables</FPCLINE>
      <FPCLINE>      lines                   = li_lines</FPCLINE>
      <FPCLINE>    exceptions</FPCLINE>
      <FPCLINE>      id                      = 1</FPCLINE>
      <FPCLINE>      language                = 2</FPCLINE>
      <FPCLINE>      name                    = 3</FPCLINE>
      <FPCLINE>      not_found               = 4</FPCLINE>
      <FPCLINE>      object                  = 5</FPCLINE>
      <FPCLINE>      reference_check         = 6</FPCLINE>
      <FPCLINE>      wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>      others                  = 8.</FPCLINE>
      <FPCLINE>  if sy-subrc is initial.</FPCLINE>
      <FPCLINE>    loop at li_lines assigning &lt;lfs_lines&gt; .</FPCLINE>
      <FPCLINE>      lwa_txtval-val = &lt;lfs_lines&gt;-tdline.</FPCLINE>
      <FPCLINE>      append lwa_txtval to i_remitto_add.</FPCLINE>
      <FPCLINE>      clear lwa_txtval.</FPCLINE>
      <FPCLINE>    endloop. &quot; LOOP AT li_lines ASSIGNING &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE>  endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>else. &quot; ELSE -&gt; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* Populate the Address table for Remit to Address</FPCLINE>
      <FPCLINE>  perform f_fill_remitaddress using wa_remitto</FPCLINE>
      <FPCLINE>                                    lv_nastspras</FPCLINE>
      <FPCLINE>                           changing i_remitto_add.</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>endif. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* Populate Country below Invoice</FPCLINE>
      <FPCLINE>perform f_populate_country  using gv_adrnr3</FPCLINE>
      <FPCLINE>                                  lv_nastspras</FPCLINE>
      <FPCLINE>                                  gv_country.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Field labels from Standard texts for Item table</FPCLINE>
      <FPCLINE>perform f_populate_labels    using wa_socl</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>                                   gv_invoice</FPCLINE>
      <FPCLINE>                                   gv_payment_text</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>                          changing wa_item_label.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
     </INITIALIZATION>
     <FORMS>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>************************************************************************</FPCLINE>
      <FPCLINE>* PROGRAM    :  ZOTC0014_INVOICE_FORM_BILLING1                         *</FPCLINE>
      <FPCLINE>* TITLE      :  Invoce Form Billing Interface                          *</FPCLINE>
      <FPCLINE>* DEVELOPER  :  Ashis Dey                                              *</FPCLINE>
      <FPCLINE>* OBJECT TYPE:  Interface (Form)                                       *</FPCLINE>
      <FPCLINE>* SAP RELEASE:  SAP ECC 6.0                                            *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* WRICEF ID:  D2_OTC_FDD_0014_Customer_Invoice_Form</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* DESCRIPTION: SHORT DESCRIPTION OF FUNCTIONALITY                      *</FPCLINE>
      <FPCLINE>* Invoice Form Billing Via T-Codes VF31/VF02/VF03                      *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* MODIFICATION HISTORY:                                                *</FPCLINE>
      <FPCLINE>*======================================================================*</FPCLINE>
      <FPCLINE>* DATE        USER      TRANSPORT  DESCRIPTION                         *</FPCLINE>
      <FPCLINE>* =========== ========  ========== ====================================*</FPCLINE>
      <FPCLINE>* 24-SEP-2014 ADEY      E2DK905111 D2_OTC_FDD_0014 :                   *</FPCLINE>
      <FPCLINE>*                                  Addition of new fields and VAT      *</FPCLINE>
      <FPCLINE>*                                  details for US and Canada           *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 12-JAN-2015 ADEY      E2DK905111 D2_OTC_FDD_0014 : Defect#2022/CR_337*</FPCLINE>
      <FPCLINE>*                                  Additional changes to print billing *</FPCLINE>
      <FPCLINE>*                                  plan dates and No Tax Indicator in  *</FPCLINE>
      <FPCLINE>*                                  layout                              *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 20-FEB-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#3035/CR_482*</FPCLINE>
      <FPCLINE>*                                  1. Remove Ship date from layout     *</FPCLINE>
      <FPCLINE>*                                  2. BOM Component printing based on  *</FPCLINE>
      <FPCLINE>*                                     Distribution Channel and Invoice *</FPCLINE>
      <FPCLINE>*                                     type                             *</FPCLINE>
      <FPCLINE>*                                  3. French translation population    *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 17-MAR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : CR_D2_531_532     *</FPCLINE>
      <FPCLINE>*                                  1. Append Header Text of &apos;Z014&apos;     *</FPCLINE>
      <FPCLINE>*                                  2. Append Line Item Text of &apos;Z014&apos;  *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 17-MAR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5346       *</FPCLINE>
      <FPCLINE>*                                  Start / End Dates on Invoices print *</FPCLINE>
      <FPCLINE>*                                  backwards for Billing Plans         *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 07-APR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5656       *</FPCLINE>
      <FPCLINE>*                                  Formatting changes                  *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 07-APR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5683       *</FPCLINE>
      <FPCLINE>*                                  Handle Special Characters in Text ID*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 28-APR-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#6252       *</FPCLINE>
      <FPCLINE>*                                  Ship-To and Bill-To Address will be *</FPCLINE>
      <FPCLINE>*                                  printed from Sales Document: Partner*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 07-MAY-2015 ADEY    E2DK905111   D2_OTC_FDD_0014 : Defect#5935       *</FPCLINE>
      <FPCLINE>*                                  Unit price and Extended price at    *</FPCLINE>
      <FPCLINE>*                                  item level will be printed from     *</FPCLINE>
      <FPCLINE>*                                  KONV table for &apos;ZNET&apos; condition type*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 14-JUL-2015 ASK     E2DK913988   D2_OTC_FDD_0014 : Defect#8616 For   *</FPCLINE>
      <FPCLINE>*                                  ZCPR order invoice all componenet   *</FPCLINE>
      <FPCLINE>*                                  should be considered as normal item *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 24-JUL-2015 RNATHAK E2DK913988   D2_OTC_FDD_0014 : Defect# 8720 For  *</FPCLINE>
      <FPCLINE>*                                  Bill To - PO Box display            *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 05-AUG-2015 PDEBARU E2DK914494   D2_OTC_FDD_0014 : Defect#8835       *</FPCLINE>
      <FPCLINE>*                                  PO BOX to be printed instead of     *</FPCLINE>
      <FPCLINE>*                                  street address in Bill To &amp; Ship To *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 10-Aug-2015 RNATHAK E2DK914604   D2_OTC_FDD_0014 : Defect# 8894 For  *</FPCLINE>
      <FPCLINE>*                                  Company and Remit to address fix    *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 08-Dec-2015 MGARG    E2DK916297  D2_OTC_FDD_0014 : Defect#326 fixed  *</FPCLINE>
      <FPCLINE>*                                  Footer issue,Address adjustment acc *</FPCLINE>
      <FPCLINE>*                                  to envelope,</FPCLINE>
      <FPCLINE>*                                  Added logic for conditiontype &quot;ZCFI&quot;*</FPCLINE>
      <FPCLINE>*                                  Logic for insuarnce charges and doc *</FPCLINE>
      <FPCLINE>*                                  charges                             *</FPCLINE>
      <FPCLINE>* 17-Aug-2016 AMOHAPA  E2DK918662  D2_OTC_FDD_0014_Defect#1919         *</FPCLINE>
      <FPCLINE>*                                  Restocking Fees has been added for  *</FPCLINE>
      <FPCLINE>*                                  Billing Type &apos;ZG2&apos; and &apos;ZRE&apos; and    *</FPCLINE>
      <FPCLINE>*                                  condition type &apos;ZRST&apos;.</FPCLINE>
      <FPCLINE>*                                  For company code 3000 singapore Tax *</FPCLINE>
      <FPCLINE>*                                  invoice print Telephone,fax  number,*</FPCLINE>
      <FPCLINE>*                                  Tax Indicator &amp; percentage and      *</FPCLINE>
      <FPCLINE>*                                  Exchange Rate.                      *</FPCLINE>
      <FPCLINE>*                                  In Bill to Partner Attn To:Accounts *</FPCLINE>
      <FPCLINE>*                                  Payable Team has been added,if it is*</FPCLINE>
      <FPCLINE>*                                  maintained in customer master.      *</FPCLINE>
      <FPCLINE>* 29-Dec-2017  U102006  E1DK933466 Defect#4461 Remit to address was not*</FPCLINE>
      <FPCLINE>*                                  coming properly due to type mismatch*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 18-May-2019 U105235  E2DK923986   D3_OTC_FDD_0088 : Defect# 9572     *</FPCLINE>
      <FPCLINE>*                                   Proforma invoice changes for US and*</FPCLINE>
      <FPCLINE>*                                   EU regions                         *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>* 20-Aug-2019 U103062  E2DK923696  D3_OTC_FDD_0014:SCTASK0825806_PCR# 679</FPCLINE>
      <FPCLINE>*                                   The current footer text on the USA *</FPCLINE>
      <FPCLINE>*                                   invoice is too small to hold the   *</FPCLINE>
      <FPCLINE>*                                   required footer text, so added logic</FPCLINE>
      <FPCLINE>*                                   to accomodate it                   *</FPCLINE>
      <FPCLINE>*                                   Added GV_FOOTER in Global Data     *</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_GET_ADDRESS</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Get the address details for Ship to/Bill to/Bank Lockbox</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_PARVW    Partner Function</FPCLINE>
      <FPCLINE>*      --&gt;FP_I_VBPA   Sales Document: Partner</FPCLINE>
      <FPCLINE>*      &lt;--FP_ADDRESS  Detail address of Ship to/Bill to/Bank</FPCLINE>
      <FPCLINE>*      &lt;--FP_ADRNR    Address number</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_get_address   USING fp_parvw   TYPE parvw      &quot;Partner Function</FPCLINE>
      <FPCLINE>                           fp_i_vbpa  TYPE tab_vbpa   &quot;Sales Document: Partner</FPCLINE>
      <FPCLINE>                  CHANGING fp_address TYPE ty_address &quot;Address details</FPCLINE>
      <FPCLINE>                           fp_adrnr   TYPE adrnr.     &quot;Address number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_vbpa&gt; TYPE vbpa. &quot;Sales Document: Partner</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Fetching adress numbers and sales data for all the</FPCLINE>
      <FPCLINE>* related partners etc...</FPCLINE>
      <FPCLINE>  READ TABLE fp_i_vbpa</FPCLINE>
      <FPCLINE>   ASSIGNING &lt;lfs_vbpa&gt;</FPCLINE>
      <FPCLINE>    WITH KEY parvw = fp_parvw.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#6252 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** Fetch the Address number based on the Customer number</FPCLINE>
      <FPCLINE>*    SELECT</FPCLINE>
      <FPCLINE>*    SINGLE adrnr &quot; Address</FPCLINE>
      <FPCLINE>*      FROM kna1  &quot; General Data in Customer Master</FPCLINE>
      <FPCLINE>*      INTO fp_adrnr</FPCLINE>
      <FPCLINE>*     WHERE kunnr = &lt;lfs_vbpa&gt;-kunnr.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    fp_adrnr = &lt;lfs_vbpa&gt;-adrnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#6252 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Address details based on the Address number</FPCLINE>
      <FPCLINE>    SELECT name1      &quot; Name 1</FPCLINE>
      <FPCLINE>           name2      &quot; Name 2</FPCLINE>
      <FPCLINE>           name3      &quot; Name 3</FPCLINE>
      <FPCLINE>           name4      &quot; Name 4</FPCLINE>
      <FPCLINE>           city1      &quot; City</FPCLINE>
      <FPCLINE>           city2      &quot; District</FPCLINE>
      <FPCLINE>           post_code1 &quot; City postal code</FPCLINE>
      <FPCLINE>* Begin of change by PDEBARU for Defect # 8835</FPCLINE>
      <FPCLINE>           post_code2 &quot; PO Box Postal Code</FPCLINE>
      <FPCLINE>* End of change by PDEBARU for Defect # 8835</FPCLINE>
      <FPCLINE>           po_box     &quot; PO Box</FPCLINE>
      <FPCLINE>           street     &quot; Street</FPCLINE>
      <FPCLINE>           house_num1 &quot; House Number</FPCLINE>
      <FPCLINE>           house_num2 &quot; House number supplement</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>           str_suppl1</FPCLINE>
      <FPCLINE>           str_suppl2</FPCLINE>
      <FPCLINE>           str_suppl3</FPCLINE>
      <FPCLINE>           building   &quot; Building (Number or Code)</FPCLINE>
      <FPCLINE>           floor      &quot; Floor in building</FPCLINE>
      <FPCLINE>           roomnumber &quot; Room or Appartment Number</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>           country    &quot; Country Key</FPCLINE>
      <FPCLINE>           region     &quot; Region (State, Province, County)</FPCLINE>
      <FPCLINE>           tel_number &quot; First telephone no.: dialling code+number</FPCLINE>
      <FPCLINE>        UP TO 1 ROWS</FPCLINE>
      <FPCLINE>      FROM adrc       &quot; Addresses (Business Address Services)</FPCLINE>
      <FPCLINE>      INTO fp_address</FPCLINE>
      <FPCLINE>     WHERE addrnumber = fp_adrnr.</FPCLINE>
      <FPCLINE>    ENDSELECT.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>* Format conversion to remove the leading zero</FPCLINE>
      <FPCLINE>      CALL FUNCTION &apos;CONVERSION_EXIT_ALPHA_OUTPUT&apos;</FPCLINE>
      <FPCLINE>        EXPORTING</FPCLINE>
      <FPCLINE>          input  = &lt;lfs_vbpa&gt;-kunnr</FPCLINE>
      <FPCLINE>        IMPORTING</FPCLINE>
      <FPCLINE>          output = fp_address-kunnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#6252 by ADEY</FPCLINE>
      <FPCLINE>*   ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#6252 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_GET_ADDRESS</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_GET_EMI_VALUES</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Get values maintained in Enhancement Control table (EMI Tool)</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      &lt;--FP_US         For USA only</FPCLINE>
      <FPCLINE>*      &lt;--FP_CA         For Canada only</FPCLINE>
      <FPCLINE>*      &lt;--FP_SOLC       For VKORG_LAND1_LANGU combination</FPCLINE>
      <FPCLINE>*      &lt;--FP_COND       For Condition type - &apos;ZCFI&apos;/&apos;XR1&apos;/&apos;XR2&apos;/&apos;XR3&apos;/&apos;ZNET&apos;</FPCLINE>
      <FPCLINE>*      &lt;--FP_TDOBJ      For Application object - &apos;Z012&apos;/&apos;Z015&apos;/&apos;Z016&apos;/&apos;ZPLN&apos;</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_TXTID    For Document Header Text IDs</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_PERCON   For Percentage and Conditions</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_get_emi_values  CHANGING fp_us       TYPE lland          &quot; Country of Destination</FPCLINE>
      <FPCLINE>                                fp_ca       TYPE lland          &quot; Country of Destination</FPCLINE>
      <FPCLINE>                                fp_socl     TYPE ty_socl        &quot; Sales Organization/City/Language combination</FPCLINE>
      <FPCLINE>                                fp_cond     TYPE ty_cond        &quot; Condition type</FPCLINE>
      <FPCLINE>                                fp_tdobj    TYPE ty_tdobject    &quot; Texts: Application Object</FPCLINE>
      <FPCLINE>                                fp_i_txtid  TYPE ty_t_txtid     &quot; Header Text IDs</FPCLINE>
      <FPCLINE>                                fp_i_percon TYPE ty_t_perc_cond &quot; Percentage/Condition</FPCLINE>
      <FPCLINE>                                fp_mtart    TYPE mtart          &quot; Material Type  &quot; Defect 8548</FPCLINE>
      <FPCLINE>                                fp_i_auart  TYPE ty_t_auart     &quot; Order Type  &quot; Defect 8616</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                fp_fein_comp TYPE ty_t_bukrs</FPCLINE>
      <FPCLINE>                                fp_regno_comp TYPE ty_t_bukrs</FPCLINE>
      <FPCLINE>                                fp_lv_party_coreg TYPE party &quot; Parameter type</FPCLINE>
      <FPCLINE>                                fp_lv_party_fein TYPE party  &quot; Parameter type</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                fp_li_fkart   TYPE  ty_t_fkart  &quot;BIlling type emi entries</FPCLINE>
      <FPCLINE>                                lv_tel_emi    TYPE char20       &quot;variable for telephone number emi</FPCLINE>
      <FPCLINE>                                lv_fax_emi    TYPE char20       &quot;Variable for fax number emi</FPCLINE>
      <FPCLINE>                                fp_li_kschl   TYPE  ty_t_kschl. &quot;condition type emi entries</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constant declaration</FPCLINE>
      <FPCLINE>  CONSTANTS:</FPCLINE>
      <FPCLINE>    lc_0014        TYPE z_enhancement  VALUE &apos;D2_OTC_FDD_0014&apos;  , &quot;Enhancement No.</FPCLINE>
      <FPCLINE>    lc_txtid       TYPE z_criteria     VALUE &apos;DOC_HEADER_TXT&apos;   , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_us          TYPE z_criteria     VALUE &apos;LAND_US&apos;          , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_ca          TYPE z_criteria     VALUE &apos;LAND_CA&apos;          , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_socl        TYPE z_criteria     VALUE &apos;VKORG_LAND1_LANG&apos; , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_kschl       TYPE z_criteria     VALUE &apos;KSCHL&apos;            , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_xrx         TYPE z_criteria     VALUE &apos;KSCHL_XRX_ZCFI&apos;   , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_z012        TYPE z_criteria     VALUE &apos;TDOBJECT_Z012&apos;    , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_CR_D2_531_532 by ADEY</FPCLINE>
      <FPCLINE>    lc_z014        TYPE z_criteria     VALUE &apos;TDOBJECT_Z014&apos;    , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_CR_D2_531_532 by ADEY</FPCLINE>
      <FPCLINE>    lc_z015        TYPE z_criteria     VALUE &apos;TDOBJECT_Z015&apos;    , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_z016        TYPE z_criteria     VALUE &apos;TDOBJECT_Z016&apos;    , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>    lc_zpln        TYPE z_criteria     VALUE &apos;MTPOS&apos;            , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lc_vtweg       TYPE z_criteria     VALUE &apos;VTWEG&apos;            , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_fkart       TYPE z_criteria     VALUE &apos;FKART&apos;            , &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lc_mtart       TYPE z_criteria     VALUE &apos;MTART&apos;, &quot;Defect 8548</FPCLINE>
      <FPCLINE>    lc_auart       TYPE z_criteria     VALUE &apos;AUART&apos;, &quot;Defect 8616</FPCLINE>
      <FPCLINE>    lc_uscr        TYPE char1          VALUE &apos;_&apos;,     &quot;Underscore punctuation</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>    lc_fein        TYPE z_criteria      VALUE &apos;CUST_INV_FEIN&apos;,       &quot; Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_regno       TYPE z_criteria      VALUE &apos;CUST_INV_REGNO&apos;,      &quot; Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_party_coreg TYPE z_criteria      VALUE &apos;PARTY_COREG&apos;, &quot; Enh. Criteria</FPCLINE>
      <FPCLINE>    lc_party_fein  TYPE z_criteria      VALUE  &apos;PARTY_FEIN&apos;, &quot; Enh. Criteria</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*---&gt;Begin of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>    lc_fkart_res   TYPE z_criteria VALUE &apos;BILLING_TYPE_RES&apos;, &quot;Criteria for Billing type</FPCLINE>
      <FPCLINE>    lc_condition   TYPE z_criteria VALUE &apos;CONDITION_TYPE&apos;,   &quot;Criteria for condition type</FPCLINE>
      <FPCLINE>    lc_tel_emi     TYPE z_criteria VALUE &apos;TEL&apos;,              &quot;criteria for telephone number</FPCLINE>
      <FPCLINE>    lc_fax_emi     TYPE z_criteria VALUE &apos;FAX&apos;.              &quot;criteria for fax number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA:</FPCLINE>
      <FPCLINE>    li_constant    TYPE ty_t_constant, &quot;Enhancement Status</FPCLINE>
      <FPCLINE>    lwa_percon     TYPE ty_perc_cond , &quot;Percentage/Condition</FPCLINE>
      <FPCLINE>    lwa_auart      TYPE ty_auart     , &quot; Defect 8616</FPCLINE>
      <FPCLINE>    lwa_txtid      TYPE ty_txtid     , &quot;Header Text ID</FPCLINE>
      <FPCLINE>    lv_socl        TYPE fpb_low,       &quot;From Value</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>    lwa_fein_comp  TYPE ty_bukrs,</FPCLINE>
      <FPCLINE>    lwa_regno_comp TYPE ty_bukrs,</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*---&gt;Begin of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>    li_emi_value   TYPE STANDARD TABLE OF zdev_enh_status, &quot;Local internal table for emi entries</FPCLINE>
      <FPCLINE>    li_emi_value2  TYPE STANDARD TABLE OF zdev_enh_status, &quot;Local internal table for emi entries</FPCLINE>
      <FPCLINE>    lwa_fkart      TYPE ty_fkart,                          &quot;Local work area for range table</FPCLINE>
      <FPCLINE>    lwa_kschl      TYPE ty_kschl.                          &quot;Local work area for range table</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_constant&gt;  TYPE zdev_enh_status, &quot; Enhancement Status</FPCLINE>
      <FPCLINE>*---&gt;Begin of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>    &lt;lfs_emi_value&gt; TYPE zdev_enh_status. &quot;Field symbol for emi entry table</FPCLINE>
      <FPCLINE>*&lt;---End of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Setting all the constant values.</FPCLINE>
      <FPCLINE>  CALL FUNCTION &apos;ZDEV_ENHANCEMENT_STATUS_CHECK&apos;</FPCLINE>
      <FPCLINE>    EXPORTING</FPCLINE>
      <FPCLINE>      iv_enhancement_no = lc_0014</FPCLINE>
      <FPCLINE>    TABLES</FPCLINE>
      <FPCLINE>      tt_enh_status     = li_constant.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF li_constant[] IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*---&gt;Begin of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>    li_emi_value[] = li_constant[].</FPCLINE>
      <FPCLINE>*&lt;---End of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the constants values accordingly</FPCLINE>
      <FPCLINE>    LOOP AT li_constant ASSIGNING &lt;lfs_constant&gt;</FPCLINE>
      <FPCLINE>                            WHERE active = abap_true. &quot;Value - &apos;X&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CONDENSE &lt;lfs_constant&gt;-criteria NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF &lt;lfs_constant&gt;-criteria EQ lc_txtid. &quot;Value - &apos;DOC_HEADER_TXT&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        lwa_txtid-tdid = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE lwa_txtid-tdid NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        APPEND lwa_txtid TO fp_i_txtid.</FPCLINE>
      <FPCLINE>        CLEAR lwa_txtid.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_us. &quot;Value - &apos;LAND_US&apos;</FPCLINE>
      <FPCLINE>        fp_us = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_us NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_ca. &quot;Value - &apos;LAND_CA&apos;</FPCLINE>
      <FPCLINE>        fp_ca = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_ca NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_socl. &quot;Value - &apos;VKORG_LAND1_LANG&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* If the value is matched then set the flag</FPCLINE>
      <FPCLINE>        IF &lt;lfs_constant&gt;-sel_low+0(4) EQ fp_socl-vkorg.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          IF fp_socl-land1 IS INITIAL.</FPCLINE>
      <FPCLINE>            fp_socl-land1 = &lt;lfs_constant&gt;-sel_low+5(2). &quot;Language</FPCLINE>
      <FPCLINE>          ENDIF. &quot; IF fp_socl-land1 IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          IF fp_socl-lang1 IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            CALL FUNCTION &apos;CONVERSION_EXIT_ISOLA_INPUT&apos;</FPCLINE>
      <FPCLINE>              EXPORTING</FPCLINE>
      <FPCLINE>                input            = &lt;lfs_constant&gt;-sel_low+8(2) &quot;Language_1</FPCLINE>
      <FPCLINE>              IMPORTING</FPCLINE>
      <FPCLINE>                output           = fp_socl-lang1</FPCLINE>
      <FPCLINE>              EXCEPTIONS</FPCLINE>
      <FPCLINE>                unknown_language = 1</FPCLINE>
      <FPCLINE>                OTHERS           = 2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            IF sy-subrc &lt;&gt; 0.</FPCLINE>
      <FPCLINE>* No action needed</FPCLINE>
      <FPCLINE>            ENDIF. &quot; IF sy-subrc &lt;&gt; 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          ELSEIF fp_socl-lang2 IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            CALL FUNCTION &apos;CONVERSION_EXIT_ISOLA_INPUT&apos;</FPCLINE>
      <FPCLINE>              EXPORTING</FPCLINE>
      <FPCLINE>                input            = &lt;lfs_constant&gt;-sel_low+8(2) &quot;Language_1</FPCLINE>
      <FPCLINE>              IMPORTING</FPCLINE>
      <FPCLINE>                output           = fp_socl-lang2</FPCLINE>
      <FPCLINE>              EXCEPTIONS</FPCLINE>
      <FPCLINE>                unknown_language = 1</FPCLINE>
      <FPCLINE>                OTHERS           = 2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>            IF sy-subrc &lt;&gt; 0.</FPCLINE>
      <FPCLINE>* No action needed</FPCLINE>
      <FPCLINE>            ENDIF. &quot; IF sy-subrc &lt;&gt; 0</FPCLINE>
      <FPCLINE>          ENDIF. &quot; IF fp_socl-lang1 IS INITIAL</FPCLINE>
      <FPCLINE>        ENDIF. &quot; IF &lt;lfs_constant&gt;-sel_low+0(4) EQ fp_socl-vkorg</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_xrx. &quot;Value - &apos;KSCHL_XRX_ZCFI&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate all the maintained Condition types</FPCLINE>
      <FPCLINE>        SPLIT &lt;lfs_constant&gt;-sel_low</FPCLINE>
      <FPCLINE>           AT lc_uscr</FPCLINE>
      <FPCLINE>         INTO fp_cond-cond_xr1</FPCLINE>
      <FPCLINE>              fp_cond-cond_xr2</FPCLINE>
      <FPCLINE>              fp_cond-cond_xr3</FPCLINE>
      <FPCLINE>              fp_cond-cond_zcfi</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE>              fp_cond-cond_znet. &quot; Condition type - &apos;ZNET&apos;</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CONDENSE : fp_cond-cond_xr1 ,</FPCLINE>
      <FPCLINE>                   fp_cond-cond_xr2 ,</FPCLINE>
      <FPCLINE>                   fp_cond-cond_xr3 ,</FPCLINE>
      <FPCLINE>                   fp_cond-cond_zcfi,</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE>                   fp_cond-cond_znet &quot; Condition type - &apos;ZNET&apos;</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5935 by ADEY</FPCLINE>
      <FPCLINE>                   NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_kschl. &quot;Value - &apos;KSCHL&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Percentage values with the respective condition types</FPCLINE>
      <FPCLINE>        SPLIT &lt;lfs_constant&gt;-sel_low</FPCLINE>
      <FPCLINE>           AT lc_uscr</FPCLINE>
      <FPCLINE>         INTO lwa_percon-cond</FPCLINE>
      <FPCLINE>              lwa_percon-region</FPCLINE>
      <FPCLINE>              lwa_percon-taxtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CONDENSE : lwa_percon-cond   ,</FPCLINE>
      <FPCLINE>                   lwa_percon-region ,</FPCLINE>
      <FPCLINE>                   lwa_percon-taxtxt</FPCLINE>
      <FPCLINE>                   NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        APPEND lwa_percon TO fp_i_percon.</FPCLINE>
      <FPCLINE>        CLEAR : lwa_percon.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_z012. &quot;Value - &apos;TDOBJECT_Z012&apos;</FPCLINE>
      <FPCLINE>        fp_tdobj-id_z012 = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_tdobj-id_z012 NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_CR_D2_531_532 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_z014. &quot;Value - &apos;TDOBJECT_Z014&apos;</FPCLINE>
      <FPCLINE>        fp_tdobj-id_z014 = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_tdobj-id_z014 NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_CR_D2_531_532 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_z015. &quot;Value - &apos;TDOBJECT_Z015&apos;</FPCLINE>
      <FPCLINE>        fp_tdobj-id_z015 = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_tdobj-id_z015 NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_z016. &quot;Value - &apos;TDOBJECT_Z016&apos;</FPCLINE>
      <FPCLINE>        fp_tdobj-id_z016 = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_tdobj-id_z016 NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_zpln. &quot;Value - &apos;MTPOS&apos;</FPCLINE>
      <FPCLINE>        fp_tdobj-zpln = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_tdobj-zpln NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_vtweg. &quot;Value - &apos;VTWEG&apos;</FPCLINE>
      <FPCLINE>        fp_tdobj-vtweg = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_tdobj-vtweg NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_fkart. &quot;Value - &apos;FKART&apos;</FPCLINE>
      <FPCLINE>        fp_tdobj-fkart = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_tdobj-fkart NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#8548 by ASK</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_mtart. &quot;Value - &apos;FKART&apos;</FPCLINE>
      <FPCLINE>        fp_mtart = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE fp_mtart NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#8548 by ASK</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#8616 by ASK</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_auart. &quot;Value - &apos;FKART&apos;</FPCLINE>
      <FPCLINE>        lwa_auart-auart = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE lwa_auart-auart NO-GAPS.</FPCLINE>
      <FPCLINE>        APPEND  lwa_auart TO fp_i_auart.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_fein. &quot;Value - &apos;DOC_HEADER_TXT&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        lwa_fein_comp = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE lwa_fein_comp NO-GAPS.</FPCLINE>
      <FPCLINE>        APPEND lwa_fein_comp TO fp_fein_comp.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_regno. &quot;Value - &apos;DOC_HEADER_TXT&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        lwa_regno_comp = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>        CONDENSE lwa_regno_comp NO-GAPS.</FPCLINE>
      <FPCLINE>        APPEND lwa_regno_comp TO fp_regno_comp.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_party_coreg.</FPCLINE>
      <FPCLINE>        fp_lv_party_coreg = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF &lt;lfs_constant&gt;-criteria EQ lc_party_fein.</FPCLINE>
      <FPCLINE>        fp_lv_party_fein = &lt;lfs_constant&gt;-sel_low.</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#8616 by ASK</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; LOOP AT li_constant ASSIGNING &lt;lfs_constant&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDLOOP. &quot; IF li_constant[] IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    DELETE li_emi_value WHERE active NE abap_true.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF li_emi_value IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      SORT li_emi_value BY criteria.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      li_emi_value2[] = li_emi_value[].</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      READ TABLE li_emi_value ASSIGNING &lt;lfs_emi_value&gt;</FPCLINE>
      <FPCLINE>                              WITH KEY criteria = lc_tel_emi</FPCLINE>
      <FPCLINE>                              BINARY SEARCH.</FPCLINE>
      <FPCLINE>      IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>        lv_tel_emi = &lt;lfs_emi_value&gt;-sel_low. &quot;Telephone number from emi entry</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>      READ TABLE li_emi_value ASSIGNING &lt;lfs_emi_value&gt;</FPCLINE>
      <FPCLINE>                              WITH KEY criteria = lc_fax_emi</FPCLINE>
      <FPCLINE>                              BINARY SEARCH.</FPCLINE>
      <FPCLINE>      IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>        lv_fax_emi = &lt;lfs_emi_value&gt;-sel_low. &quot;fax number from emi entry</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      DELETE li_emi_value WHERE criteria NE lc_fkart_res.</FPCLINE>
      <FPCLINE>      IF li_emi_value IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*catching values of billing type fkart from emi table</FPCLINE>
      <FPCLINE>        LOOP AT li_emi_value ASSIGNING &lt;lfs_emi_value&gt;.</FPCLINE>
      <FPCLINE>          lwa_fkart-sign = &lt;lfs_emi_value&gt;-sel_sign.</FPCLINE>
      <FPCLINE>          lwa_fkart-option = &lt;lfs_emi_value&gt;-sel_option.</FPCLINE>
      <FPCLINE>          lwa_fkart-low = &lt;lfs_emi_value&gt;-sel_low.</FPCLINE>
      <FPCLINE>          lwa_fkart-high = &lt;lfs_emi_value&gt;-sel_high.</FPCLINE>
      <FPCLINE>          APPEND lwa_fkart TO fp_li_fkart.</FPCLINE>
      <FPCLINE>          CLEAR lwa_fkart.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ENDLOOP. &quot; LOOP AT li_emi_value ASSIGNING &lt;lfs_emi_value&gt;</FPCLINE>
      <FPCLINE>        IF &lt;lfs_emi_value&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>          UNASSIGN: &lt;lfs_emi_value&gt;.</FPCLINE>
      <FPCLINE>        ENDIF. &quot; IF &lt;lfs_emi_value&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF li_emi_value IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      DELETE li_emi_value2 WHERE criteria NE lc_condition.</FPCLINE>
      <FPCLINE>      IF li_emi_value2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*catching value for condition type kschl from emi table</FPCLINE>
      <FPCLINE>        LOOP AT li_emi_value2 ASSIGNING &lt;lfs_emi_value&gt;.</FPCLINE>
      <FPCLINE>          lwa_kschl-sign = &lt;lfs_emi_value&gt;-sel_sign.</FPCLINE>
      <FPCLINE>          lwa_kschl-option = &lt;lfs_emi_value&gt;-sel_option.</FPCLINE>
      <FPCLINE>          lwa_kschl-low = &lt;lfs_emi_value&gt;-sel_low.</FPCLINE>
      <FPCLINE>          lwa_kschl-high = &lt;lfs_emi_value&gt;-sel_high.</FPCLINE>
      <FPCLINE>          APPEND lwa_kschl TO fp_li_kschl.</FPCLINE>
      <FPCLINE>          CLEAR lwa_kschl.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ENDLOOP. &quot; LOOP AT li_emi_value2 ASSIGNING &lt;lfs_emi_value&gt;</FPCLINE>
      <FPCLINE>        IF &lt;lfs_emi_value&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>          UNASSIGN : &lt;lfs_emi_value&gt;.</FPCLINE>
      <FPCLINE>        ENDIF. &quot; IF &lt;lfs_emi_value&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF li_emi_value2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF li_emi_value IS NOT INITIAL</FPCLINE>
      <FPCLINE>*&lt;---End of insert for D2_OTC_FDD_0014_Defect#1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF li_constant[] IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  UNASSIGN &lt;lfs_constant&gt;.</FPCLINE>
      <FPCLINE>  CLEAR li_constant.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_GET_EMI_VALUES</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  POPULATE_HEADER_TEXT</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the Document Header Text ID - &apos;Z009&apos;</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_TXTID    Text ID</FPCLINE>
      <FPCLINE>*      --&gt;FP_TXTNAME  Text Object name</FPCLINE>
      <FPCLINE>*      --&gt;FP_OBJ      Text Object - &apos;VBBK&apos;</FPCLINE>
      <FPCLINE>*      --&gt;FP_SOCL     Language from EMI Tool</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_LINES  Header text lines</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM populate_header_text    USING fp_txtid   TYPE ty_txtid    &quot;Text ID</FPCLINE>
      <FPCLINE>                                   fp_txtname TYPE tdobname    &quot;Name</FPCLINE>
      <FPCLINE>                                   fp_obj     TYPE tdobject    &quot;Application Object - &apos;VBBK&apos;</FPCLINE>
      <FPCLINE>                                   fp_socl    TYPE ty_socl     &quot;Languages</FPCLINE>
      <FPCLINE>                          CHANGING fp_i_lines TYPE ty_t_lines. &quot;Header text lines</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local Data declarations</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    li_lines      TYPE tline_t , &quot;Added Under CR-508</FPCLINE>
      <FPCLINE>* ----&gt; Defect 979</FPCLINE>
      <FPCLINE>*  lwa_lines     TYPE tline   , &quot;Added Under CR-508</FPCLINE>
      <FPCLINE>*  lwa_lines1    TYPE ty_lines, &quot;Added Under CR-508</FPCLINE>
      <FPCLINE>    lwa_lines     TYPE ty_lines,</FPCLINE>
      <FPCLINE>    lwa_lines1    TYPE ty_lines,</FPCLINE>
      <FPCLINE>* &lt;---- Defect 979</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE>    li_text_lines TYPE STANDARD TABLE OF char30000, &quot; Text_lines</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE>    lv_char       TYPE i, &quot;Added Under CR-508</FPCLINE>
      <FPCLINE>    lv_char_count TYPE i, &quot;Added Under CR-508</FPCLINE>
      <FPCLINE>    lv_last_count TYPE i, &quot;Added Under CR-508</FPCLINE>
      <FPCLINE>    lv_remaining  TYPE i, &quot;Added Under CR-508</FPCLINE>
      <FPCLINE>    lv_string     TYPE string.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; charBegin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_text_lines&gt; TYPE char30000. &quot; Text_line of type CHAR30000</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>******* Retrieval of Invoice Header Text *******************</FPCLINE>
      <FPCLINE>  CALL FUNCTION &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>    EXPORTING</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>* Previously it was &apos;Z006&apos; but currently changed to &apos;Z009&apos;</FPCLINE>
      <FPCLINE>*     id                      = lc_id</FPCLINE>
      <FPCLINE>      id                      = fp_txtid-tdid &quot;Value - &apos;Z009&apos;</FPCLINE>
      <FPCLINE>*     language                = lc_en</FPCLINE>
      <FPCLINE>      language                = fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>*     name                    = lv_name</FPCLINE>
      <FPCLINE>      name                    = fp_txtname</FPCLINE>
      <FPCLINE>*     object                  = lc_obj</FPCLINE>
      <FPCLINE>      object                  = fp_obj</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>    TABLES</FPCLINE>
      <FPCLINE>      lines                   = li_lines</FPCLINE>
      <FPCLINE>    EXCEPTIONS</FPCLINE>
      <FPCLINE>      id                      = 1</FPCLINE>
      <FPCLINE>      language                = 2</FPCLINE>
      <FPCLINE>      name                    = 3</FPCLINE>
      <FPCLINE>      not_found               = 4</FPCLINE>
      <FPCLINE>      object                  = 5</FPCLINE>
      <FPCLINE>      reference_check         = 6</FPCLINE>
      <FPCLINE>      wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>      OTHERS                  = 8.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Calling FM to convert the text line table data into string</FPCLINE>
      <FPCLINE>    CALL FUNCTION &apos;CONVERT_ITF_TO_STREAM_TEXT&apos;</FPCLINE>
      <FPCLINE>      EXPORTING</FPCLINE>
      <FPCLINE>        language    = fp_socl-lang2  &quot;Language Key</FPCLINE>
      <FPCLINE>        lf          = &apos; &apos;</FPCLINE>
      <FPCLINE>      TABLES</FPCLINE>
      <FPCLINE>        itf_text    = li_lines       &quot;Text line data</FPCLINE>
      <FPCLINE>        text_stream = li_text_lines. &quot;String format</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* CR-508 : begin of changes : snigam : 10-jul-2013</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* we dont need to display only one line of header text.</FPCLINE>
      <FPCLINE>* instead, we need to display complete header text maintained</FPCLINE>
      <FPCLINE>* for customer (upto 1200 characters)</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Commented Code below</FPCLINE>
      <FPCLINE>*  READ TABLE li_lines INTO lwa_lines INDEX 1.</FPCLINE>
      <FPCLINE>*  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*    gv_htext = lwa_lines-tdline.</FPCLINE>
      <FPCLINE>*  ENDIF.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Added code below</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Move Header text into a global internal table</FPCLINE>
      <FPCLINE>* Only Display 1200 characters of the header text</FPCLINE>
      <FPCLINE>* on the Layout</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE>*    LOOP AT li_lines INTO lwa_lines.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    LOOP AT li_text_lines ASSIGNING &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lwa_lines-tdline = &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lwa_lines1-tdline = lwa_lines-tdline.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   Move One line into String type varaibe</FPCLINE>
      <FPCLINE>      MOVE lwa_lines-tdline TO lv_string.</FPCLINE>
      <FPCLINE>      CONDENSE lv_string.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   Count Number of Characters in String</FPCLINE>
      <FPCLINE>      lv_char = strlen( lv_string ).</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   Set Counter for total number of characters addind into</FPCLINE>
      <FPCLINE>*   final internal table</FPCLINE>
      <FPCLINE>      lv_char_count = lv_char_count + lv_char.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   If total characters are less than 1200,add workarea</FPCLINE>
      <FPCLINE>*   into final Internal table</FPCLINE>
      <FPCLINE>      IF lv_char_count LE 1200.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        APPEND lwa_lines1 TO i_lines.</FPCLINE>
      <FPCLINE>        CLEAR lwa_lines1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   Once LV_CHAR_COUNT is more than 1200 and actual total number</FPCLINE>
      <FPCLINE>*   of characters in I_LINES table are less than 1200, calculate</FPCLINE>
      <FPCLINE>*   how many more characters we can accomodate more  to make it</FPCLINE>
      <FPCLINE>*   exactly 1200 and then add those remaining characters.</FPCLINE>
      <FPCLINE>      ELSE. &quot; ELSE -&gt; IF lv_char_count LE 1200</FPCLINE>
      <FPCLINE>*     Calculate Number of characters in I_LINES table upto now</FPCLINE>
      <FPCLINE>        lv_last_count = lv_char_count - lv_char.</FPCLINE>
      <FPCLINE>*     Check space for remaining characters</FPCLINE>
      <FPCLINE>        lv_remaining = 1200 - lv_last_count.</FPCLINE>
      <FPCLINE>*     Move only those char, so that by adding those characters,</FPCLINE>
      <FPCLINE>*     count would be 1200 exactly.</FPCLINE>
      <FPCLINE>        CLEAR lwa_lines1-tdline.</FPCLINE>
      <FPCLINE>        MOVE lv_string(lv_remaining) TO lwa_lines1-tdline.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        APPEND lwa_lines1 TO i_lines.</FPCLINE>
      <FPCLINE>        CLEAR: lwa_lines1,</FPCLINE>
      <FPCLINE>               lv_last_count,</FPCLINE>
      <FPCLINE>               lv_remaining.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*     After this loop, no more characters are required.</FPCLINE>
      <FPCLINE>        EXIT.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF lv_char_count LE 1200</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR: lv_char,</FPCLINE>
      <FPCLINE>             lv_string.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDLOOP. &quot; LOOP AT li_text_lines ASSIGNING &lt;lfs_text_lines&gt;</FPCLINE>
      <FPCLINE>* CR-508 : End of changes : SNIGAM : 10-Jul-2013</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : li_lines      ,</FPCLINE>
      <FPCLINE>          lwa_lines     ,</FPCLINE>
      <FPCLINE>          lwa_lines1    ,</FPCLINE>
      <FPCLINE>          lv_char       ,</FPCLINE>
      <FPCLINE>          lv_char_count ,</FPCLINE>
      <FPCLINE>          lv_last_count ,</FPCLINE>
      <FPCLINE>          lv_remaining  ,</FPCLINE>
      <FPCLINE>          lv_string.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>******* Retrieval of Invoice Header Text *******************</FPCLINE>
      <FPCLINE>  CALL FUNCTION &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>    EXPORTING</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>* Previously it was &apos;Z006&apos; but currently changed to &apos;Z009&apos;</FPCLINE>
      <FPCLINE>*     id                      = lc_id</FPCLINE>
      <FPCLINE>      id                      = fp_txtid-tdid &quot;Value - &apos;Z009&apos;</FPCLINE>
      <FPCLINE>*     language                = lc_en</FPCLINE>
      <FPCLINE>      language                = fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>*     name                    = lv_name</FPCLINE>
      <FPCLINE>      name                    = fp_txtname</FPCLINE>
      <FPCLINE>*     object                  = lc_obj</FPCLINE>
      <FPCLINE>      object                  = fp_obj</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014 by ADEY</FPCLINE>
      <FPCLINE>    TABLES</FPCLINE>
      <FPCLINE>      lines                   = li_lines</FPCLINE>
      <FPCLINE>    EXCEPTIONS</FPCLINE>
      <FPCLINE>      id                      = 1</FPCLINE>
      <FPCLINE>      language                = 2</FPCLINE>
      <FPCLINE>      name                    = 3</FPCLINE>
      <FPCLINE>      not_found               = 4</FPCLINE>
      <FPCLINE>      object                  = 5</FPCLINE>
      <FPCLINE>      reference_check         = 6</FPCLINE>
      <FPCLINE>      wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>      OTHERS                  = 8.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Calling FM to convert the text line table data into string</FPCLINE>
      <FPCLINE>    CALL FUNCTION &apos;CONVERT_ITF_TO_STREAM_TEXT&apos;</FPCLINE>
      <FPCLINE>      EXPORTING</FPCLINE>
      <FPCLINE>        language    = fp_socl-lang1  &quot;Language Key</FPCLINE>
      <FPCLINE>        lf          = &apos; &apos;</FPCLINE>
      <FPCLINE>      TABLES</FPCLINE>
      <FPCLINE>        itf_text    = li_lines       &quot;Text line data</FPCLINE>
      <FPCLINE>        text_stream = li_text_lines. &quot;String format</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* CR-508 : begin of changes : snigam : 10-jul-2013</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* we dont need to display only one line of header text.</FPCLINE>
      <FPCLINE>* instead, we need to display complete header text maintained</FPCLINE>
      <FPCLINE>* for customer (upto 1200 characters)</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Commented Code below</FPCLINE>
      <FPCLINE>*  READ TABLE li_lines INTO lwa_lines INDEX 1.</FPCLINE>
      <FPCLINE>*  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*    gv_htext = lwa_lines-tdline.</FPCLINE>
      <FPCLINE>*  ENDIF.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Added code below</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Move Header text into a global internal table</FPCLINE>
      <FPCLINE>* Only Display 1200 characters of the header text</FPCLINE>
      <FPCLINE>* on the Layout</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE>*    LOOP AT li_lines INTO lwa_lines.</FPCLINE>
      <FPCLINE>    LOOP AT li_text_lines ASSIGNING &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lwa_lines-tdline = &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lwa_lines1-tdline = lwa_lines-tdline.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   Move One line into String type varaibe</FPCLINE>
      <FPCLINE>      MOVE lwa_lines-tdline TO lv_string.</FPCLINE>
      <FPCLINE>      CONDENSE lv_string.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   Count Number of Characters in String</FPCLINE>
      <FPCLINE>      lv_char = strlen( lv_string ).</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   Set Counter for total number of characters addind into</FPCLINE>
      <FPCLINE>*   final internal table</FPCLINE>
      <FPCLINE>      lv_char_count = lv_char_count + lv_char.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   If total characters are less than 1200,add workarea</FPCLINE>
      <FPCLINE>*   into final Internal table</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF lv_char_count LE 1200.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        APPEND lwa_lines1 TO i_lines.</FPCLINE>
      <FPCLINE>        CLEAR lwa_lines1.</FPCLINE>
      <FPCLINE>*   Once LV_CHAR_COUNT is more than 1200 and actual total number</FPCLINE>
      <FPCLINE>*   of characters in I_LINES table are less than 1200, calculate</FPCLINE>
      <FPCLINE>*   how many more characters we can accomodate more  to make it</FPCLINE>
      <FPCLINE>*   exactly 1200 and then add those remaining characters.</FPCLINE>
      <FPCLINE>      ELSE. &quot; ELSE -&gt; IF lv_char_count LE 1200</FPCLINE>
      <FPCLINE>*     Calculate Number of characters in I_LINES table upto now</FPCLINE>
      <FPCLINE>        lv_last_count = lv_char_count - lv_char.</FPCLINE>
      <FPCLINE>*     Check space for remaining characters</FPCLINE>
      <FPCLINE>        lv_remaining = 1200 - lv_last_count.</FPCLINE>
      <FPCLINE>*     Move only those char, so that by adding those characters,</FPCLINE>
      <FPCLINE>*     count would be 1200 exactly.</FPCLINE>
      <FPCLINE>        CLEAR lwa_lines1-tdline.</FPCLINE>
      <FPCLINE>        MOVE lv_string(lv_remaining) TO lwa_lines1-tdline.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        APPEND lwa_lines1 TO i_lines.</FPCLINE>
      <FPCLINE>        CLEAR: lwa_lines1,</FPCLINE>
      <FPCLINE>               lv_last_count,</FPCLINE>
      <FPCLINE>               lv_remaining.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*     After this loop, no more characters are required.</FPCLINE>
      <FPCLINE>        EXIT.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF lv_char_count LE 1200</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR: lv_char,</FPCLINE>
      <FPCLINE>             lv_string.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDLOOP. &quot; LOOP AT li_text_lines ASSIGNING &lt;lfs_text_lines&gt;</FPCLINE>
      <FPCLINE>* CR-508 : End of changes : SNIGAM : 10-Jul-2013</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; POPULATE_HEADER_TEXT</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_SERIALNUM</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the Serial numbers for the Materials</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_I_ITEM_DETAIL  Item table for Invoice</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_OBJK         Doc. Header for Serial Numbers for Delivery</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_SER01        Serial numbers</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_serialnum     USING fp_i_item_detail TYPE invoice_t_prt_item_detail</FPCLINE>
      <FPCLINE>                           CHANGING fp_i_objk        TYPE ty_t_objk</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>                                    fp_i_ser01       TYPE ty_t_ser01.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local Data declarations</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    li_delv  TYPE ty_t_delv , &quot;Delivery for Serial number</FPCLINE>
      <FPCLINE>    lwa_delv TYPE ty_delv.    &quot;Delivery for Serial number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_detail&gt; TYPE invoice_s_prt_item_detail. &quot;Lines read from text element</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF fp_i_item_detail IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    LOOP AT fp_i_item_detail ASSIGNING &lt;lfs_detail&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF &lt;lfs_detail&gt;-vbdpr-vgbel IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Delivery and Delivery Item details for Serial number</FPCLINE>
      <FPCLINE>        lwa_delv-lief_nr = &lt;lfs_detail&gt;-vbdpr-vgbel.</FPCLINE>
      <FPCLINE>        lwa_delv-posnr   = &lt;lfs_detail&gt;-vbdpr-vgpos.</FPCLINE>
      <FPCLINE>        APPEND lwa_delv TO li_delv.</FPCLINE>
      <FPCLINE>        CLEAR lwa_delv.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF &lt;lfs_detail&gt;-vbdpr-vgbel IS NOT INITIAL</FPCLINE>
      <FPCLINE>    ENDLOOP. &quot; LOOP AT fp_i_item_detail ASSIGNING &lt;lfs_detail&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    UNASSIGN &lt;lfs_detail&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF li_delv IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Sort records by Delivery and Item number</FPCLINE>
      <FPCLINE>      SORT li_delv BY lief_nr</FPCLINE>
      <FPCLINE>                      posnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch Document Header for Serial Numbers for Delivery</FPCLINE>
      <FPCLINE>      SELECT obknr   &quot; Object list number</FPCLINE>
      <FPCLINE>             lief_nr &quot; Delivery</FPCLINE>
      <FPCLINE>             posnr   &quot; Delivery Item</FPCLINE>
      <FPCLINE>        FROM ser01   &quot; Document Header for Serial Numbers for Delivery</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>*       INTO TABLE li_ser01</FPCLINE>
      <FPCLINE>        INTO TABLE fp_i_ser01</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>         FOR ALL ENTRIES IN li_delv</FPCLINE>
      <FPCLINE>       WHERE lief_nr = li_delv-lief_nr</FPCLINE>
      <FPCLINE>         AND posnr   = li_delv-posnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch Plant Maintenance Object List</FPCLINE>
      <FPCLINE>        SELECT obknr &quot; Object list number</FPCLINE>
      <FPCLINE>               obzae &quot; Object list counters</FPCLINE>
      <FPCLINE>               sernr &quot; Serial Number</FPCLINE>
      <FPCLINE>               matnr &quot; Material Number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          FROM objk  &quot; Plant Maintenance Object List</FPCLINE>
      <FPCLINE>          INTO TABLE fp_i_objk</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>*          FOR ALL ENTRIES IN li_ser01</FPCLINE>
      <FPCLINE>*        WHERE obknr = li_ser01-obknr.</FPCLINE>
      <FPCLINE>           FOR ALL ENTRIES IN fp_i_ser01</FPCLINE>
      <FPCLINE>         WHERE obknr = fp_i_ser01-obknr.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Sort records by Material number</FPCLINE>
      <FPCLINE>          SORT fp_i_objk BY matnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE>          SORT fp_i_ser01 BY lief_nr</FPCLINE>
      <FPCLINE>                             posnr.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5389 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF li_delv IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_i_item_detail IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_SERIALNUM</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_FINAL_TOTAL</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Calculate and populate the Final total</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_FLAG      Country spec. check - Canada/Others</FPCLINE>
      <FPCLINE>*      --&gt;FP_SUB       Subtotal</FPCLINE>
      <FPCLINE>*      --&gt;FP_RESTOCK   Restocking fees</FPCLINE>
      <FPCLINE>*      --&gt;FP_TAX       Tax</FPCLINE>
      <FPCLINE>*      --&gt;FP_FC        Freight Charge</FPCLINE>
      <FPCLINE>*      --&gt;FP_HC        Handling Charge</FPCLINE>
      <FPCLINE>*      --&gt;FP_DG        Dangerous Goods Charge</FPCLINE>
      <FPCLINE>*      --&gt;FP_CUKY      Document currency</FPCLINE>
      <FPCLINE>*      --&gt;FP_TOTAL     Interim total</FPCLINE>
      <FPCLINE>*      --&gt;FP_ADVPMT    Advance payment</FPCLINE>
      <FPCLINE>*      --&gt;FP_FINTOT    Final total</FPCLINE>
      <FPCLINE>*      --&gt;FP_SOCL      Languages</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_FINTOT  Final total table</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_final_total   USING fp_flag     TYPE flag   &quot;General Flag</FPCLINE>
      <FPCLINE>                                    fp_sub      TYPE char20 &quot;Subtotal</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                    fp_restock  TYPE char20                       &quot;Restocking fees</FPCLINE>
      <FPCLINE>                                    fp_head_detail TYPE invoice_s_prt_head_detail &quot; Header Details</FPCLINE>
      <FPCLINE>                                    fp_regno_comp  TYPE ty_t_bukrs                &quot;Company code table</FPCLINE>
      <FPCLINE>                                    fp_li_fkart    TYPE ty_t_fkart                &quot;Billing type range table from emi</FPCLINE>
      <FPCLINE>                                    fp_li_kschl    TYPE ty_t_kschl                &quot;Condition type range table from emi</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                    fp_tax      TYPE char20 &quot;Tax</FPCLINE>
      <FPCLINE>                                    fp_fc       TYPE char20 &quot;Freight</FPCLINE>
      <FPCLINE>                                    fp_hc       TYPE char20 &quot;Handling charge</FPCLINE>
      <FPCLINE>                                    fp_dg       TYPE char20 &quot;Dangerous goods charge</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                    fp_ic       TYPE char20 &quot;Label Insurance charges</FPCLINE>
      <FPCLINE>                                    fp_dc       TYPE char20 &quot;Document charges</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                    fp_cuky     TYPE char7  &quot;Document currency</FPCLINE>
      <FPCLINE>                                    fp_total    TYPE char20 &quot;Interim total</FPCLINE>
      <FPCLINE>                                    fp_advpmt   TYPE char20 &quot;Advance payment</FPCLINE>
      <FPCLINE>                                    fp_fintot   TYPE char20 &quot;Final total</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                    fp_exchange TYPE char20 &quot;Exchange rate</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                    fp_socl     TYPE ty_socl      &quot;Languages</FPCLINE>
      <FPCLINE>                           CHANGING fp_i_fintot TYPE ty_t_stdtxt. &quot;Final Total</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_subtot    TYPE tdobname VALUE &apos;ZOTC_0014_SUBTOT&apos;     , &quot;Subtotal</FPCLINE>
      <FPCLINE>    lc_tax       TYPE tdobname VALUE &apos;ZOTC_0014_TAX&apos;        , &quot;Tax</FPCLINE>
      <FPCLINE>    lc_canadatax TYPE tdobname VALUE &apos;ZOTC_0014_CANADATAX&apos;  , &quot;Canada Tax</FPCLINE>
      <FPCLINE>    lc_freight   TYPE tdobname VALUE &apos;ZOTC_0014_FREIGHT_CH&apos; , &quot;Freight</FPCLINE>
      <FPCLINE>    lc_handling  TYPE tdobname VALUE &apos;ZOTC_0014_HNDLCH&apos;     , &quot;Handling charge</FPCLINE>
      <FPCLINE>    lc_danger    TYPE tdobname VALUE &apos;ZOTC_0014_DANGERCH&apos;   , &quot;Dangerous goods charge</FPCLINE>
      <FPCLINE>    lc_total     TYPE tdobname VALUE &apos;ZOTC_0014_TOTAL&apos;      , &quot;Interim total</FPCLINE>
      <FPCLINE>    lc_advpmnt   TYPE tdobname VALUE &apos;ZOTC_0014_ADVPMNT&apos;    , &quot;Advance payment</FPCLINE>
      <FPCLINE>    lc_fintot    TYPE tdobname VALUE &apos;ZOTC_0014_FINALTOT&apos;   , &quot;Final total</FPCLINE>
      <FPCLINE>    lc_slash     TYPE char1    VALUE &apos;/&apos;                    , &quot;Punctuation</FPCLINE>
      <FPCLINE>    lc_colon     TYPE char1    VALUE &apos;:&apos;,                     &quot;Punctuation</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>    lc_insurance TYPE tdobname VALUE &apos;ZOTC_0014_INSURAN&apos;, &quot;Insurance Charges</FPCLINE>
      <FPCLINE>    lc_docchagre TYPE tdobname VALUE &apos;ZOTC_0014_DOCCHRG&apos;, &quot;Document charges</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>    lc_restock   TYPE tdobname VALUE &apos;ZOTC_0014_RESTOCK&apos;,   &quot;Restocking fee</FPCLINE>
      <FPCLINE>    lc_gst       TYPE tdobname VALUE &apos;ZOTC_0014_GST&apos;,       &quot;Gst</FPCLINE>
      <FPCLINE>    lc_exchange  TYPE tdobname VALUE  &apos;ZOTC_0014_EXCHANGE&apos;. &quot;Exchange rate</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_fintot TYPE ty_stdtxt , &quot;Standard Text with values</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lwa_stdtxt TYPE ty_stdtxt , &quot;Standard Text</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lv_total   TYPE char10. &quot;For Total with Currency Key</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* -----------------------------------------------------------------</FPCLINE>
      <FPCLINE>* Separate Footer for Total payment for USA specific requirement</FPCLINE>
      <FPCLINE>* -----------------------------------------------------------------</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_flag IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Labels for Tax, Sub Total and Total will be printed always</FPCLINE>
      <FPCLINE>* without validating the initial value. Otherwise this check</FPCLINE>
      <FPCLINE>* is applicable for all other labels.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_subtot     &quot;Subtotal</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_subtot     &quot;Subtotal</FPCLINE>
      <FPCLINE>                                       lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                       fp_sub</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  lc_slash</FPCLINE>
      <FPCLINE>                  lwa_fintot-text</FPCLINE>
      <FPCLINE>             INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>    CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Restocking fee will be populated only if the billing type is ZG2 or ZRE and condition type zrst</FPCLINE>
      <FPCLINE>*---&gt;Begin of Change for D2_OTC_FDD_0014 Defect# 1919_FUT Issue by AMOHAPA on 28-Oct-2016</FPCLINE>
      <FPCLINE>    IF fp_restock IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*    IF fp_head_detail-vbdkr-fkart IN fp_li_fkart.</FPCLINE>
      <FPCLINE>*&lt;---End of change for D2_OTC_FDD_0014 Defect# 1919_FUT Issue by AMOHAPA on 28-Oct-2016</FPCLINE>
      <FPCLINE>      IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_restock    &quot;Restocking fees</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values for restocking fees</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_restock    &quot;Restocking fees</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_restock</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    lc_slash</FPCLINE>
      <FPCLINE>                    lwa_fintot-text</FPCLINE>
      <FPCLINE>               INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CONDENSE lwa_fintot-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_restock IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_tax        &quot;Ta\x</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 24-Oct-2016</FPCLINE>
      <FPCLINE>*If the company code is 3000(singapore invoice) then Tax text should be replaced by Add GST @7.00%</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    READ TABLE fp_regno_comp WITH KEY bukrs = fp_head_detail-vbdkr-bukrs</FPCLINE>
      <FPCLINE>                             TRANSPORTING NO FIELDS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING   lc_gst        &quot;Add GSt@ 7.00%</FPCLINE>
      <FPCLINE>                                           lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                           fp_tax</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSE. &quot; ELSE -&gt; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 24-Oct-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_tax        &quot;Tax</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_tax</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 24-Oct-2016</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 24-Oct-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  lc_slash</FPCLINE>
      <FPCLINE>                  lwa_fintot-text</FPCLINE>
      <FPCLINE>             INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>    CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_fc IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_freight    &quot;Freight</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_freight    &quot;Freight</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_fc</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    lc_slash</FPCLINE>
      <FPCLINE>                    lwa_fintot-text</FPCLINE>
      <FPCLINE>               INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_fc IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_hc IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_handling   &quot;Handling charge</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_handling   &quot;Handling charge</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_hc</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    lc_slash</FPCLINE>
      <FPCLINE>                    lwa_fintot-text</FPCLINE>
      <FPCLINE>               INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_hc IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_dg IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_danger     &quot;Dangerous goods charge</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_dg</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_dg IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* Insurance Charges</FPCLINE>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF fp_ic IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_insurance  &quot;Insurance charges</FPCLINE>
      <FPCLINE>                                           lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                           fp_ic</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE>        APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>        CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF fp_ic IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Document charges</FPCLINE>
      <FPCLINE>      IF fp_dc IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_docchagre  &quot; Document Charges</FPCLINE>
      <FPCLINE>                                           lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                           fp_dc</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE>        APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>        CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF fp_dc IS NOT INITIAL</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_total      &quot;Total</FPCLINE>
      <FPCLINE>                                       lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                       fp_total</FPCLINE>
      <FPCLINE>                                       fp_cuky       &quot;Currency value</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>    CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>*Exchange rate will be populated only if the company code is 3000</FPCLINE>
      <FPCLINE>    READ TABLE fp_regno_comp WITH KEY bukrs = fp_head_detail-vbdkr-bukrs</FPCLINE>
      <FPCLINE>                             TRANSPORTING NO FIELDS.</FPCLINE>
      <FPCLINE>    IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>      IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_exchange   &quot;Exchange rate</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values  Exchange rate</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_exchange   &quot;Exchange rate</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_exchange</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    lc_slash</FPCLINE>
      <FPCLINE>                    lwa_fintot-text</FPCLINE>
      <FPCLINE>               INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_advpmt IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_advpmnt    &quot;Advance payment</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_advpmt</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Final Total should not appear on any invoice where Advance Payment is not present</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_fintot     &quot;Final Total</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_fintot</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_advpmt IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* -----------------------------------------------------------------</FPCLINE>
      <FPCLINE>* Separate Footer for Total payment for CANADA specific requirement</FPCLINE>
      <FPCLINE>* -----------------------------------------------------------------</FPCLINE>
      <FPCLINE>  ELSE. &quot; ELSE -&gt; IF fp_advpmt IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Labels for Tax, Sub Total and Total will be printed always</FPCLINE>
      <FPCLINE>* without validating the initial value. Otherwise this check</FPCLINE>
      <FPCLINE>* is applicable for all other labels.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_subtot     &quot;Subtotal</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_subtot     &quot;Subtotal</FPCLINE>
      <FPCLINE>                                       lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                       fp_sub</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  lc_slash</FPCLINE>
      <FPCLINE>                  lwa_fintot-text</FPCLINE>
      <FPCLINE>             INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>    CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Restocking fee will be populated only if the billing type is ZG2 or ZRE and condition type zrst</FPCLINE>
      <FPCLINE>*---&gt;Begin of Change for D2_OTC_FDD_0014 Defect# 1919_FUT Issue by AMOHAPA on 28-Oct-2016</FPCLINE>
      <FPCLINE>    IF fp_restock IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*    IF fp_head_detail-vbdkr-fkart IN fp_li_fkart.</FPCLINE>
      <FPCLINE>*&lt;---End of change for D2_OTC_FDD_0014 Defect# 1919_FUT Issue by AMOHAPA on 28-Oct-2016</FPCLINE>
      <FPCLINE>      IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_restock    &quot;Restocking fees</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values for restocking fees</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_restock    &quot;Restocking fees</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_restock</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    lc_slash</FPCLINE>
      <FPCLINE>                    lwa_fintot-text</FPCLINE>
      <FPCLINE>               INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_restock IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>    IF fp_fc IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_freight    &quot;Freight</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_freight    &quot;Freight</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_fc</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    lc_slash</FPCLINE>
      <FPCLINE>                    lwa_fintot-text</FPCLINE>
      <FPCLINE>               INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_fc IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_hc IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_handling   &quot;Handling charge</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_handling   &quot;Handling charge</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_hc</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    lc_slash</FPCLINE>
      <FPCLINE>                    lwa_fintot-text</FPCLINE>
      <FPCLINE>               INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_hc IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_dg IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_danger     &quot;Dangerous goods charge</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_dg</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_dg IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_tax        &quot;Tax</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_tax        &quot;Tax</FPCLINE>
      <FPCLINE>                                       lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                       fp_tax</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  lc_slash</FPCLINE>
      <FPCLINE>                  lwa_fintot-text</FPCLINE>
      <FPCLINE>             INTO lwa_fintot-text</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>    CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_total      &quot;Total</FPCLINE>
      <FPCLINE>                                       lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                       fp_total</FPCLINE>
      <FPCLINE>                                       fp_cuky</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>    CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_advpmt IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_advpmnt    &quot;Advance payment</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_advpmt</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Final Total should not appear on any invoice where Advance Payment is not present</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_fintot     &quot;Final Total</FPCLINE>
      <FPCLINE>                                         lc_colon      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                         fp_fintot</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_fintot TO fp_i_fintot.</FPCLINE>
      <FPCLINE>      CLEAR lwa_fintot.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_advpmt IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_flag IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_FINAL_TOTAL</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_PROMO_CODE</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the PROMO CODE at Header Level</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_STDTXT   Standard text</FPCLINE>
      <FPCLINE>*      --&gt;FP_ID       Text ID - &apos;Z012&apos;</FPCLINE>
      <FPCLINE>*      --&gt;FP_SPRAS    Language Key</FPCLINE>
      <FPCLINE>*      &lt;--FP_PROMO    Promo Code details</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_promo_code  USING fp_stdtxt  TYPE tdobname &quot; Name</FPCLINE>
      <FPCLINE>                                  fp_id      TYPE tdid     &quot; Text ID</FPCLINE>
      <FPCLINE>                                  fp_spras   TYPE spras    &quot; Language Key</FPCLINE>
      <FPCLINE>                         CHANGING fp_promo   TYPE ty_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_promo    TYPE tdobname VALUE &apos;ZOTC_0014_PROMO&apos;, &quot;Subtotal</FPCLINE>
      <FPCLINE>    lc_obj_vbbk TYPE tdobject VALUE &apos;VBBK&apos;           , &quot;Texts: application object</FPCLINE>
      <FPCLINE>    lc_colon    TYPE char1    VALUE &apos;:&apos;.               &quot;Punctuation</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local Data declarations</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    li_lines TYPE ty_t_lines. &quot;Standard texts</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_lines&gt; TYPE ty_lines. &quot;Lines read from text element</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Standard text for the Billing document number</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val2 USING fp_stdtxt   &quot;Billing document number</FPCLINE>
      <FPCLINE>                                     fp_id       &quot;Text ID - &apos;Z012&apos;</FPCLINE>
      <FPCLINE>                                     lc_obj_vbbk &quot;Application object - &apos;VBBK&apos;</FPCLINE>
      <FPCLINE>                                     fp_spras    &quot;Language Key</FPCLINE>
      <FPCLINE>                            CHANGING li_lines.   &quot;Standard texts</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  &quot;Consolidate the errors into the message body:</FPCLINE>
      <FPCLINE>  READ TABLE li_lines</FPCLINE>
      <FPCLINE>   ASSIGNING &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE>       INDEX 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>* Concatenate the colon value and make it right justified</FPCLINE>
      <FPCLINE>    fp_promo-val = &lt;lfs_lines&gt;-tdline.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_promo &quot;Promo Code Header</FPCLINE>
      <FPCLINE>                                       lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                       fp_promo-val</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       fp_spras &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING fp_promo.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_PROMO_CODE</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_LABELS</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the labels for the Line item table</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_SOCL      Language from EMI Tool</FPCLINE>
      <FPCLINE>*      --&gt;FP_INVOICE   Invoice number</FPCLINE>
      <FPCLINE>*      &lt;--FP_LABEL     Item label</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_labels    USING fp_socl    TYPE ty_socl</FPCLINE>
      <FPCLINE>                                fp_invoice TYPE vbeln    &quot; Sales and Distribution Document Number</FPCLINE>
      <FPCLINE>                                fp_payment TYPE tdobname &quot; Name</FPCLINE>
      <FPCLINE>                       CHANGING fp_label TYPE ty_label.  &quot; Header/Item label</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_matnum      TYPE tdobname VALUE &apos;ZOTC_0014_MATNUM&apos;  , &quot;Material number</FPCLINE>
      <FPCLINE>    lc_ordqty      TYPE tdobname VALUE &apos;ZOTC_0014_ORDQTY&apos;  , &quot;Order quantity</FPCLINE>
      <FPCLINE>    lc_shpqty      TYPE tdobname VALUE &apos;ZOTC_0014_SHPQTY&apos;  , &quot;Ship quantity</FPCLINE>
      <FPCLINE>    lc_unit        TYPE tdobname VALUE &apos;ZOTC_0014_UNIT&apos;    , &quot;Unit</FPCLINE>
      <FPCLINE>    lc_descrp      TYPE tdobname VALUE &apos;ZOTC_0014_DESCRP&apos;  , &quot;Description</FPCLINE>
      <FPCLINE>    lc_unitpr      TYPE tdobname VALUE &apos;ZOTC_0014_UNITPR&apos;  , &quot;Unit Price</FPCLINE>
      <FPCLINE>    lc_extdpr      TYPE tdobname VALUE &apos;ZOTC_0014_EXTDPR&apos;  , &quot;Extended price</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lc_shipto      TYPE tdobname VALUE &apos;ZOTC_0014_SHIPTO&apos;  , &quot;Ship to Text</FPCLINE>
      <FPCLINE>    lc_billto      TYPE tdobname VALUE &apos;ZOTC_0014_BILLTO&apos;  , &quot;Bill to Text</FPCLINE>
      <FPCLINE>    lc_invoice     TYPE tdobname VALUE &apos;ZOTC_0014_INVOICE&apos; , &quot;Invoice Text</FPCLINE>
      <FPCLINE>*&lt;---Begin of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>    lc_proforma    TYPE tdobname VALUE &apos;ZOTC_0088_PROFORMA&apos;,  &quot;Proforma</FPCLINE>
      <FPCLINE>    lc_zf2         TYPE fkart    VALUE &apos;ZF2&apos;,</FPCLINE>
      <FPCLINE>    lc_ziv         TYPE fkart    VALUE  &apos;ZIV&apos;,</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>*&lt;---Begin of Insert for Defect # 10321  by U105235 on 28-Aug-2019</FPCLINE>
      <FPCLINE>     lc_cri_fkart   TYPE z_criteria    VALUE &apos;FKART&apos;,</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for Defect # 10321  by U105235 on 28-Aug-2019</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 Defect # 5656 by APODDAR</FPCLINE>
      <FPCLINE>    &quot;lc_debit_memo  TYPE tdobname VALUE &apos;ZOTC_0014_DEBIT_MEMO&apos;,</FPCLINE>
      <FPCLINE>    lc_credit_memo TYPE tdobname VALUE &apos;ZOTC_0014_CREDIT_MEMO&apos;, &quot; Name</FPCLINE>
      <FPCLINE>    lc_m           TYPE vbtyp    VALUE &apos;M&apos;,                     &quot; SD document category</FPCLINE>
      <FPCLINE>    lc_o           TYPE vbtyp    VALUE &apos;O&apos;,                     &quot; SD document category</FPCLINE>
      <FPCLINE>    lc_p           TYPE vbtyp    VALUE &apos;P&apos;,                     &quot; SD document category</FPCLINE>
      <FPCLINE>* &lt;--- End    of Change for D2_OTC_FDD_0014 Defect # 5656 by APODDAR</FPCLINE>
      <FPCLINE>*&amp;-- Begin of Insert for D2_OTC_FDD_0014 D#5250 by MBHATTA1</FPCLINE>
      <FPCLINE>    lc_tax_inv     TYPE tdobname VALUE &apos;ZOTC_0014_TAX_INVOICE&apos;, &quot;Name</FPCLINE>
      <FPCLINE>*&amp;-- End of Insert for D2_OTC_FDD_0014 D#5250 by MBHATTA1</FPCLINE>
      <FPCLINE>    lc_plsremit    TYPE tdobname VALUE &apos;ZOTC_0014_PLSREMIT&apos;, &quot;Please remit to Text</FPCLINE>
      <FPCLINE>    lc_question    TYPE tdobname VALUE &apos;ZOTC_0014_QUESTION&apos;, &quot;Question call Text</FPCLINE>
      <FPCLINE>    lc_slash       TYPE char1    VALUE &apos;/&apos;,                  &quot;Slash mark</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>* ---&gt; Begin of insert for D3_OTC_FDD_0014_SCTASK0825806_PCR# 679 by U103062 on 20-Aug-2019</FPCLINE>
      <FPCLINE>    lc_tcsales     TYPE tdobname VALUE &apos;ZOTC_0014_D1_TCSALES_XXXX&apos;, &quot; Name</FPCLINE>
      <FPCLINE>    lc_sales       TYPE string VALUE &apos;XXXX&apos;,                        &quot; Local constant for sales org</FPCLINE>
      <FPCLINE>    lc_english     TYPE spras VALUE &apos;E&apos;.                            &quot;Local constant for english language</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  DATA: lv_stdtext TYPE tdobname.    &quot; Local variable for standard text</FPCLINE>
      <FPCLINE>* &lt;--- End of insert for D3_OTC_FDD_0014_SCTASK0825806_PCR# 679 by U103062 on 20-Aug-2019</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;-- Begin of Insert for D2_OTC_FDD_0014 D#5250 by MBHATTA1</FPCLINE>
      <FPCLINE>  CONSTANTS: lc_criteria TYPE z_criteria    VALUE &apos;VKORG&apos;,           &quot;Enh. Criteria</FPCLINE>
      <FPCLINE>             lc_enh_no   TYPE z_enhancement VALUE &apos;D2_OTC_FDD_0014&apos;. &quot;Enhancement No.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  DATA: li_enh_status TYPE STANDARD TABLE OF zdev_enh_status, &quot; Enhancement Status</FPCLINE>
      <FPCLINE>        lv_invoice    TYPE tdobname.                          &quot; Name</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  FIELD-SYMBOLS: &lt;lfs_enh_status&gt; TYPE zdev_enh_status. &quot; Enhancement Status</FPCLINE>
      <FPCLINE>*&amp;-- End of Insert for D2_OTC_FDD_0014 D#5250 by MBHATTA1</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_stdtxt  TYPE ty_stdtxt, &quot;Standard Text with values</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lwa_stdtxt1 TYPE ty_stdtxt. &quot;Standard Text with values</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>***** POPULATE SHIP TO ******</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_shipto    &quot;Ship to</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_shipto   &quot;Ship to</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                lc_slash</FPCLINE>
      <FPCLINE>                lwa_stdtxt-text</FPCLINE>
      <FPCLINE>           INTO fp_label-shipto</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-shipto = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-shipto = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>***** POPULATE BILL TO ******</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_billto    &quot;Bill to</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_billto   &quot;Bill to</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                lc_slash</FPCLINE>
      <FPCLINE>                lwa_stdtxt-text</FPCLINE>
      <FPCLINE>           INTO fp_label-billto</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-billto = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-billto = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE>***** POPULATE INVOICE ******</FPCLINE>
      <FPCLINE>*&amp;-- Begin of Insert for D2_OTC_FDD_0014 D#5250 by MBHATTA1</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;-- Get the reqiured details form the EMI tool</FPCLINE>
      <FPCLINE>  CALL FUNCTION &apos;ZDEV_ENHANCEMENT_STATUS_CHECK&apos;</FPCLINE>
      <FPCLINE>    EXPORTING</FPCLINE>
      <FPCLINE>      iv_enhancement_no = lc_enh_no</FPCLINE>
      <FPCLINE>    TABLES</FPCLINE>
      <FPCLINE>      tt_enh_status     = li_enh_status.</FPCLINE>
      <FPCLINE>*&amp;--We select only the active entries.</FPCLINE>
      <FPCLINE>  DELETE li_enh_status WHERE active = space.</FPCLINE>
      <FPCLINE>  IF li_enh_status[] IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    READ TABLE li_enh_status ASSIGNING &lt;lfs_enh_status&gt; WITH KEY criteria = lc_criteria</FPCLINE>
      <FPCLINE>                                                                 sel_low  = fp_socl-vkorg.</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 Defect # 5656 by APODDAR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>      lv_invoice = lc_tax_inv.</FPCLINE>
      <FPCLINE>    ELSE. &quot; ELSE -&gt; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>      CASE lv_vbtyp.</FPCLINE>
      <FPCLINE>*          WHEN lc_p.</FPCLINE>
      <FPCLINE>*            lv_invoice = lc_debit_memo.</FPCLINE>
      <FPCLINE>        WHEN lc_o.</FPCLINE>
      <FPCLINE>          lv_invoice = lc_credit_memo.</FPCLINE>
      <FPCLINE>        WHEN OTHERS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---Begin of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>*changing the INVOICE --&gt; Pro Forma in the proforma invoice document</FPCLINE>
      <FPCLINE>**          lv_invoice = lc_invoice.</FPCLINE>
      <FPCLINE>          IF gv_fkart =   lc_zf2 OR</FPCLINE>
      <FPCLINE>             gv_fkart =   lc_ziv.     &quot;Billing Type Invoice</FPCLINE>
      <FPCLINE>            lv_invoice = lc_invoice.</FPCLINE>
      <FPCLINE>          ELSE.</FPCLINE>
      <FPCLINE>            lv_invoice = lc_proforma.</FPCLINE>
      <FPCLINE>          ENDIF.</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>      ENDCASE.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>* &lt;--- End    of Change for D2_OTC_FDD_0014 Defect # 5656 by APODDAR</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF li_enh_status[] IS NOT INITIAL</FPCLINE>
      <FPCLINE>*&amp;-- End of Insert for D2_OTC_FDD_0014 D#5250 by MBHATTA1</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lv_invoice   &quot;Invoice</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lv_invoice  &quot;Invoice</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                lc_slash</FPCLINE>
      <FPCLINE>                lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                fp_invoice</FPCLINE>
      <FPCLINE>           INTO fp_label-invoice</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                fp_invoice</FPCLINE>
      <FPCLINE>           INTO fp_label-invoice</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                fp_invoice</FPCLINE>
      <FPCLINE>           INTO fp_label-invoice</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Begin of Code changes - Defect # 10321 - U105235 - Aug 27 - 2019</FPCLINE>
      <FPCLINE>*populating the heading based on the Invoice types ZICC / ZICD</FPCLINE>
      <FPCLINE/>
      <FPCLINE> IF li_enh_status[] IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    READ TABLE li_enh_status ASSIGNING &lt;lfs_enh_status&gt; WITH KEY criteria =  lc_cri_fkart</FPCLINE>
      <FPCLINE>                                                                 sel_low  = gv_fkart.</FPCLINE>
      <FPCLINE>    IF SY-SUBRC EQ 0.</FPCLINE>
      <FPCLINE>      lwa_stdtxt1-text = &lt;lfs_enh_status&gt;-sel_high.</FPCLINE>
      <FPCLINE>         CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                fp_invoice</FPCLINE>
      <FPCLINE>           INTO fp_label-invoice</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE>    endif.</FPCLINE>
      <FPCLINE>   endif.</FPCLINE>
      <FPCLINE>*End of Code changes - Defect # 10321 - U105235 - Aug 27 - 2019</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>***** POPULATE PLEASE REMIT TO ******</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_plsremit  &quot;Please remit to</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_plsremit &quot;Please remit to</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                lc_slash</FPCLINE>
      <FPCLINE>                lwa_stdtxt-text</FPCLINE>
      <FPCLINE>           INTO fp_label-plsremit</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-plsremit = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-plsremit = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>***** POPULATE QUESTION CALL ******</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_question  &quot;Question call</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE>* ---&gt; Begin of insert for D3_OTC_FDD_0014_SCTASK0825806_PCR# 679 by U103062 on 20-Aug-2019</FPCLINE>
      <FPCLINE>* Populate footer text for USA invoice</FPCLINE>
      <FPCLINE>    IF fp_socl-lang2 = lc_english.</FPCLINE>
      <FPCLINE>      lv_stdtext = lc_tcsales.</FPCLINE>
      <FPCLINE>      REPLACE lc_sales WITH fp_socl-vkorg INTO lv_stdtext.</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lv_stdtext  &quot;Question call</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING gv_footer. &quot;Standard text</FPCLINE>
      <FPCLINE>      CLEAR:lv_stdtext.</FPCLINE>
      <FPCLINE>    ENDIF. &quot;IF fp_socl-lang2 = lc_english.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of insert for D3_OTC_FDD_0014_SCTASK0825806_PCR# 679 by U103062 on 20-Aug-2019</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_question &quot;Question call</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE>* ---&gt; Begin of insert for D3_OTC_FDD_0014_SCTASK0825806_PCR# 679 by U103062 on 20-Aug-2019</FPCLINE>
      <FPCLINE>* Populate footer text for USA invoice</FPCLINE>
      <FPCLINE>    IF fp_socl-lang1 = lc_english.</FPCLINE>
      <FPCLINE>      lv_stdtext = lc_tcsales.</FPCLINE>
      <FPCLINE>      REPLACE lc_sales WITH fp_socl-vkorg INTO lv_stdtext.</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lv_stdtext &quot;Question call</FPCLINE>
      <FPCLINE>                                               space       &quot;No colon</FPCLINE>
      <FPCLINE>                                               space       &quot;No value</FPCLINE>
      <FPCLINE>                                               space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                               fp_socl-lang1</FPCLINE>
      <FPCLINE>                                      CHANGING gv_footer. &quot;Standard text</FPCLINE>
      <FPCLINE>      CLEAR: lv_stdtext.</FPCLINE>
      <FPCLINE>    ENDIF. &quot;IF fp_socl-lang1 = lc_english.</FPCLINE>
      <FPCLINE>* &lt;--- End of insert for D3_OTC_FDD_0014_SCTASK0825806_PCR# 679 by U103062 on 20-Aug-2019</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                lc_slash</FPCLINE>
      <FPCLINE>                lwa_stdtxt-text</FPCLINE>
      <FPCLINE>           INTO fp_label-question</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-question = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-question = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>***** POPULATE PAYMENT ******</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING fp_payment   &quot;Payment Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING fp_payment  &quot;Payment Text</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-payment    = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    fp_label-payment+60 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-payment = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_label-payment = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_matnum    &quot;Material number/Batch/Serial number</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      fp_label-mat_batch_fr = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val  USING lc_matnum   &quot;Material number/Batch/Serial number</FPCLINE>
      <FPCLINE>                                     space       &quot;No colon</FPCLINE>
      <FPCLINE>                                     space       &quot;No value</FPCLINE>
      <FPCLINE>                                     space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                     fp_socl-lang1</FPCLINE>
      <FPCLINE>                            CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  fp_label-mat_batch_sn = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_ordqty    &quot;Order quantity Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      fp_label-order_qty_fr = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val  USING lc_ordqty   &quot;Order quantity Text</FPCLINE>
      <FPCLINE>                                     space       &quot;No colon</FPCLINE>
      <FPCLINE>                                     space       &quot;No value</FPCLINE>
      <FPCLINE>                                     space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                     fp_socl-lang1</FPCLINE>
      <FPCLINE>                            CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>  fp_label-order_qty = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_shpqty    &quot;Ship quantity Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      fp_label-ship_qty_fr = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val  USING lc_shpqty   &quot;Ship quantity Text</FPCLINE>
      <FPCLINE>                                     space       &quot;No colon</FPCLINE>
      <FPCLINE>                                     space       &quot;No value</FPCLINE>
      <FPCLINE>                                     space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                     fp_socl-lang1</FPCLINE>
      <FPCLINE>                            CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>  fp_label-ship_qty = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_unit      &quot;Unit Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      fp_label-unit_fr = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val  USING lc_unit     &quot;Unit Text</FPCLINE>
      <FPCLINE>                                     space       &quot;No colon</FPCLINE>
      <FPCLINE>                                     space       &quot;No value</FPCLINE>
      <FPCLINE>                                     space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                     fp_socl-lang1</FPCLINE>
      <FPCLINE>                            CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>  fp_label-unit = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_descrp    &quot;Description Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      fp_label-desc_fr = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val  USING lc_descrp   &quot;Description Text</FPCLINE>
      <FPCLINE>                                     space       &quot;No colon</FPCLINE>
      <FPCLINE>                                     space       &quot;No value</FPCLINE>
      <FPCLINE>                                     space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                     fp_socl-lang1</FPCLINE>
      <FPCLINE>                            CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>  fp_label-description = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_unitpr    &quot;Unit Price Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      fp_label-unit_pr_fr = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val  USING lc_unitpr   &quot;Unit Price Text</FPCLINE>
      <FPCLINE>                                     space       &quot;No colon</FPCLINE>
      <FPCLINE>                                     space       &quot;No value</FPCLINE>
      <FPCLINE>                                     space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                     fp_socl-lang1</FPCLINE>
      <FPCLINE>                            CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>  fp_label-unit_price = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_extdpr    &quot;Extended price Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      fp_label-extnd_pr_fr = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val  USING lc_extdpr   &quot;Extended price Text</FPCLINE>
      <FPCLINE>                                     space       &quot;No colon</FPCLINE>
      <FPCLINE>                                     space       &quot;No value</FPCLINE>
      <FPCLINE>                                     space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                     fp_socl-lang1</FPCLINE>
      <FPCLINE>                            CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>  fp_label-extnd_price = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_LABELS</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_QID_PCODE_LINTXT</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate QUOTE ID/PROMO CODE/LINE TEXT for each item</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_QUOTEREF    Quote Reference</FPCLINE>
      <FPCLINE>*      --&gt;FP_TDOBJ       Application object : Standard Text</FPCLINE>
      <FPCLINE>*      --&gt;FP_VBELNPOSNR  Invoice number</FPCLINE>
      <FPCLINE>*      --&gt;FP_SPRAS       Language Key</FPCLINE>
      <FPCLINE>*      --&gt;FP_SOCL        Languages</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>*      --&gt;FP_FPLT        Billing Plan: Dates</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_LINES     Line texts</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_qid_pcode_lintxt   USING fp_quoteref   TYPE char20      &quot; Qid_pcode_lintxt of type CHAR20</FPCLINE>
      <FPCLINE>                                         fp_tdobj      TYPE ty_tdobject &quot; Application object</FPCLINE>
      <FPCLINE>                                         fp_vbelnposnr TYPE tdobname    &quot; Name</FPCLINE>
      <FPCLINE>                                         fp_spras      TYPE spras       &quot; Language Key</FPCLINE>
      <FPCLINE>                                         fp_socl       TYPE ty_socl     &quot; Languages</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>                                         fp_fplt       TYPE ty_fplt &quot; Billing Plan: Dates</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>                                CHANGING fp_i_lines    TYPE wcb_tdline_tab. &quot; Text Line</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_quote    TYPE tdobname  VALUE &apos;ZOTC_0014_QUOTE&apos;  , &quot;Standard Text name</FPCLINE>
      <FPCLINE>    lc_promo    TYPE tdobname  VALUE &apos;ZOTC_0014_PROMO&apos;  , &quot;Standard Text name</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>    lc_startdt  TYPE tdobname  VALUE &apos;ZOTC_0014_STARTDATE&apos; , &quot;Standard Text name</FPCLINE>
      <FPCLINE>    lc_enddt    TYPE tdobname  VALUE &apos;ZOTC_0014_ENDDATE&apos;   , &quot;Standard Text name</FPCLINE>
      <FPCLINE>    lc_dash     TYPE char1     VALUE &apos;-&apos;                   , &quot;Dash mark</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lc_obj_vbbp TYPE tdobject  VALUE &apos;VBBP&apos;             , &quot;Texts: application object</FPCLINE>
      <FPCLINE>    lc_slash    TYPE char1     VALUE &apos;/&apos;                , &quot;Slash mark</FPCLINE>
      <FPCLINE>    lc_colon    TYPE char1     VALUE &apos;:&apos;.                 &quot;Colon</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declarations</FPCLINE>
      <FPCLINE>  DATA:</FPCLINE>
      <FPCLINE>    li_lines2   TYPE ty_t_lines, &quot;Standard text</FPCLINE>
      <FPCLINE>    li_lines3   TYPE ty_t_lines, &quot;Standard text</FPCLINE>
      <FPCLINE>    lwa_quote   TYPE ty_lines  , &quot;Line text</FPCLINE>
      <FPCLINE>    lwa_promo   TYPE ty_lines  , &quot;Line text</FPCLINE>
      <FPCLINE>    lwa_lines   TYPE ty_lines  , &quot;Line text</FPCLINE>
      <FPCLINE>    lwa_stdtxt  TYPE ty_stdtxt , &quot;Standard text with value</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lwa_stdtxt1 TYPE ty_stdtxt , &quot;Standard text with value</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>    lwa_startdt TYPE ty_lines  , &quot;Line text</FPCLINE>
      <FPCLINE>    lwa_enddt   TYPE ty_lines  , &quot;Line text</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE>    lv_startdt  TYPE nfdat     , &quot;Line text</FPCLINE>
      <FPCLINE>    lv_enddt    TYPE nfdat.      &quot;Line text</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_lines&gt; TYPE ty_lines.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5656 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>**-------------------</FPCLINE>
      <FPCLINE>** Populate Quote ID</FPCLINE>
      <FPCLINE>**-------------------</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF fp_quoteref IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*      PERFORM f_populate_text_val  USING lc_quote &quot;Quote ID</FPCLINE>
      <FPCLINE>*                                         lc_colon</FPCLINE>
      <FPCLINE>*                                         fp_quoteref</FPCLINE>
      <FPCLINE>*                                         space</FPCLINE>
      <FPCLINE>*                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>*                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the Value for Quote ID with value</FPCLINE>
      <FPCLINE>*      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>*                  lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*             INTO lwa_quote</FPCLINE>
      <FPCLINE>*                  SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF fp_quoteref IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>**-------------------------</FPCLINE>
      <FPCLINE>** Populate the PROMO CODE</FPCLINE>
      <FPCLINE>**-------------------------</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the Standard text for the Billing document number</FPCLINE>
      <FPCLINE>*    PERFORM f_populate_text_val2 USING fp_vbelnposnr    &quot;Billing document number,Item number</FPCLINE>
      <FPCLINE>*                                       fp_tdobj-id_z015 &quot;Text ID</FPCLINE>
      <FPCLINE>*                                       lc_obj_vbbp      &quot;Application object - &apos;VBBP&apos;</FPCLINE>
      <FPCLINE>*                                       fp_spras         &quot;Language Key</FPCLINE>
      <FPCLINE>*                              CHANGING li_lines2.       &quot;Standard texts</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF li_lines2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* &quot;Get the Line text</FPCLINE>
      <FPCLINE>*      READ TABLE li_lines2</FPCLINE>
      <FPCLINE>*       ASSIGNING &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE>*           INDEX 1.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*        CLEAR : lwa_stdtxt.</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*        PERFORM f_populate_text_val  USING lc_promo &quot;Value - &apos;ZOTC_0014_PROMO&apos;</FPCLINE>
      <FPCLINE>*                                           lc_colon</FPCLINE>
      <FPCLINE>*                                           &lt;lfs_lines&gt;-tdline</FPCLINE>
      <FPCLINE>*                                           space</FPCLINE>
      <FPCLINE>*                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>*                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the Value for Quote ID with value</FPCLINE>
      <FPCLINE>*        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>*                    lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*               INTO lwa_promo</FPCLINE>
      <FPCLINE>*                    SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF li_lines2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF lwa_quote IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*       lwa_promo IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Concatenate the values temporarily</FPCLINE>
      <FPCLINE>*      CONCATENATE lwa_quote</FPCLINE>
      <FPCLINE>*                  lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>*                  lwa_promo</FPCLINE>
      <FPCLINE>*             INTO lwa_lines</FPCLINE>
      <FPCLINE>*                  SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    ELSEIF lwa_quote IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*           lwa_promo IS INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      lwa_lines = lwa_quote.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    ELSEIF lwa_quote IS INITIAL AND</FPCLINE>
      <FPCLINE>*           lwa_promo IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      lwa_lines = lwa_promo.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF lwa_quote IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF lwa_lines IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*      APPEND lwa_lines TO li_lines3.</FPCLINE>
      <FPCLINE>*      CLEAR lwa_lines.</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF lwa_lines IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    UNASSIGN &lt;lfs_lines&gt;.</FPCLINE>
      <FPCLINE>*    CLEAR li_lines2.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF fp_quoteref IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*    PERFORM f_populate_text_val  USING lc_quote &quot;Quote ID</FPCLINE>
      <FPCLINE>*                                       lc_colon</FPCLINE>
      <FPCLINE>*                                       fp_quoteref</FPCLINE>
      <FPCLINE>*                                       space</FPCLINE>
      <FPCLINE>*                                       fp_socl-lang1</FPCLINE>
      <FPCLINE>*                              CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the Value for Quote ID with value</FPCLINE>
      <FPCLINE>*    CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>*                lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*           INTO lwa_quote</FPCLINE>
      <FPCLINE>*                SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_quoteref IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>**-------------------------</FPCLINE>
      <FPCLINE>** Populate the PROMO CODE</FPCLINE>
      <FPCLINE>**-------------------------</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the Standard text for the Billing document number</FPCLINE>
      <FPCLINE>*  PERFORM f_populate_text_val2 USING fp_vbelnposnr    &quot;Billing document number,Item number</FPCLINE>
      <FPCLINE>*                                     fp_tdobj-id_z015 &quot;Text ID</FPCLINE>
      <FPCLINE>*                                     lc_obj_vbbp      &quot;Application object - &apos;VBBP&apos;</FPCLINE>
      <FPCLINE>*                                     fp_spras         &quot;Language Key</FPCLINE>
      <FPCLINE>*                            CHANGING li_lines2.       &quot;Standard texts</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF li_lines2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* &quot;Get the Line text</FPCLINE>
      <FPCLINE>*    READ TABLE li_lines2</FPCLINE>
      <FPCLINE>*     ASSIGNING &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE>*         INDEX 1.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      CLEAR : lwa_stdtxt.</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*      PERFORM f_populate_text_val  USING lc_promo &quot;Value - &apos;ZOTC_0014_PROMO&apos;</FPCLINE>
      <FPCLINE>*                                         lc_colon</FPCLINE>
      <FPCLINE>*                                         &lt;lfs_lines&gt;-tdline</FPCLINE>
      <FPCLINE>*                                         space</FPCLINE>
      <FPCLINE>*                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>*                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the Value for Quote ID with value</FPCLINE>
      <FPCLINE>*      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>*                  lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*             INTO lwa_promo</FPCLINE>
      <FPCLINE>*                  SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF li_lines2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF lwa_quote IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*     lwa_promo IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Concatenate the values temporarily</FPCLINE>
      <FPCLINE>*    CONCATENATE lwa_quote</FPCLINE>
      <FPCLINE>*                lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>*                lwa_promo</FPCLINE>
      <FPCLINE>*           INTO lwa_lines</FPCLINE>
      <FPCLINE>*                SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ELSEIF lwa_quote IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*         lwa_promo IS INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    lwa_lines = lwa_quote.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ELSEIF lwa_quote IS INITIAL AND</FPCLINE>
      <FPCLINE>*         lwa_promo IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    lwa_lines = lwa_promo.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF lwa_quote IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF lwa_lines IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*    APPEND lwa_lines TO li_lines3.</FPCLINE>
      <FPCLINE>*    CLEAR lwa_lines.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF lwa_lines IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  UNASSIGN &lt;lfs_lines&gt;.</FPCLINE>
      <FPCLINE>*  CLEAR li_lines2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>*-------------------</FPCLINE>
      <FPCLINE>* Populate Quote ID</FPCLINE>
      <FPCLINE>*-------------------</FPCLINE>
      <FPCLINE>  IF fp_quoteref IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_quote &quot;Quote ID</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_quote &quot;Quote ID</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                  lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                  lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                  fp_quoteref</FPCLINE>
      <FPCLINE>             INTO lwa_quote-tdline</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                  fp_quoteref</FPCLINE>
      <FPCLINE>             INTO lwa_quote-tdline</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                  lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                  fp_quoteref</FPCLINE>
      <FPCLINE>             INTO lwa_quote-tdline</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>            lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_quoteref IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-------------------------</FPCLINE>
      <FPCLINE>* Populate the PROMO CODE</FPCLINE>
      <FPCLINE>*-------------------------</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Standard text for the Billing document number</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val2 USING fp_vbelnposnr    &quot;Billing document number,Item number</FPCLINE>
      <FPCLINE>                                     fp_tdobj-id_z015 &quot;Text ID</FPCLINE>
      <FPCLINE>                                     lc_obj_vbbp      &quot;Application object - &apos;VBBP&apos;</FPCLINE>
      <FPCLINE>                                     fp_spras         &quot;Language Key</FPCLINE>
      <FPCLINE>                            CHANGING li_lines2.       &quot;Standard texts</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF li_lines2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    &quot;Get the Line text</FPCLINE>
      <FPCLINE>    READ TABLE li_lines2</FPCLINE>
      <FPCLINE>     ASSIGNING &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE>         INDEX 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF &lt;lfs_lines&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 Defect # 5656 by APODDAR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*      IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*        PERFORM f_populate_text_val  USING lc_promo &quot;Value - &apos;ZOTC_0014_PROMO&apos;</FPCLINE>
      <FPCLINE>*                                           space</FPCLINE>
      <FPCLINE>*                                           space</FPCLINE>
      <FPCLINE>*                                           space</FPCLINE>
      <FPCLINE>*                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>*                                  CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End    of Change for D2_OTC_FDD_0014 Defect # 5656 by APODDAR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_promo &quot;Value - &apos;ZOTC_0014_PROMO&apos;</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           space</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>         lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014 Defect # 5656 by APODDAR</FPCLINE>
      <FPCLINE>                    &quot;lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>* &lt;--- End    of Change for D2_OTC_FDD_0014 Defect # 5656 by APODDAR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>                    lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                    lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                    &lt;lfs_lines&gt;-tdline</FPCLINE>
      <FPCLINE>               INTO lwa_promo-tdline</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                    &lt;lfs_lines&gt;-tdline</FPCLINE>
      <FPCLINE>               INTO lwa_promo-tdline</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                    lc_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                    &lt;lfs_lines&gt;-tdline</FPCLINE>
      <FPCLINE>               INTO lwa_promo-tdline</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>              lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF &lt;lfs_lines&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF li_lines2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_quote IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_promo IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_quote</FPCLINE>
      <FPCLINE>                lc_slash &quot;Value -&apos;/&apos;</FPCLINE>
      <FPCLINE>                lwa_promo</FPCLINE>
      <FPCLINE>           INTO lwa_lines</FPCLINE>
      <FPCLINE>                SEPARATED BY space..</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_lines TO li_lines3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_quote IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    lwa_lines = lwa_quote.</FPCLINE>
      <FPCLINE>    APPEND lwa_lines TO li_lines3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_promo IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    lwa_lines = lwa_promo.</FPCLINE>
      <FPCLINE>    APPEND lwa_lines TO li_lines3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_quote IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_quote,</FPCLINE>
      <FPCLINE>          lwa_promo,</FPCLINE>
      <FPCLINE>          lwa_lines.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5656 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*------------------------------------------------------</FPCLINE>
      <FPCLINE>* Populate the START DATE and END DATE for Billing Plan</FPCLINE>
      <FPCLINE>*------------------------------------------------------</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_fplt-fkdat LT fp_fplt-nfdat.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lv_startdt = fp_fplt-fkdat.</FPCLINE>
      <FPCLINE>    lv_enddt   = fp_fplt-nfdat.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF fp_fplt-nfdat LT fp_fplt-fkdat.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lv_startdt = fp_fplt-nfdat.</FPCLINE>
      <FPCLINE>    lv_enddt   = fp_fplt-fkdat.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_fplt-fkdat LT fp_fplt-nfdat</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* IF fp_fplt-fkdat IS NOT INITIAL.</FPCLINE>
      <FPCLINE>  IF lv_startdt IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_startdt &quot;Value - &apos;ZOTC_0014_STARTDATE&apos;</FPCLINE>
      <FPCLINE>                                       lc_colon</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE>*                                      fp_fplt-fkdat</FPCLINE>
      <FPCLINE>                                       lv_startdt</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       fp_spras &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CONCATENATE lwa_stdtxt-val+4(2) &quot;Value - &apos;MM&apos;</FPCLINE>
      <FPCLINE>                lc_dash             &quot;Value - &apos;-&apos;</FPCLINE>
      <FPCLINE>                lwa_stdtxt-val+6(2) &quot;Value - &apos;DD&apos;</FPCLINE>
      <FPCLINE>                lc_dash             &quot;Value - &apos;-&apos;</FPCLINE>
      <FPCLINE>                lwa_stdtxt-val+0(4) &quot;Value - &apos;YYYY&apos;</FPCLINE>
      <FPCLINE>           INTO lwa_stdtxt-val.</FPCLINE>
      <FPCLINE>    CONDENSE lwa_stdtxt-val NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Value for Quote ID with value</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                lwa_stdtxt-val</FPCLINE>
      <FPCLINE>           INTO lwa_startdt</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lv_startdt IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* IF fp_fplt-nfdat IS NOT INITIAL.</FPCLINE>
      <FPCLINE>  IF lv_enddt IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_enddt &quot;Value - &apos;ZOTC_0014_ENDDATE&apos;</FPCLINE>
      <FPCLINE>                                       lc_colon</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE>*                                      fp_fplt-nfdat</FPCLINE>
      <FPCLINE>                                       lv_enddt</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5346 by ADEY</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       fp_spras &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CONCATENATE lwa_stdtxt-val+4(2) &quot;Value - &apos;MM&apos;</FPCLINE>
      <FPCLINE>                lc_dash             &quot;Value - &apos;-&apos;</FPCLINE>
      <FPCLINE>                lwa_stdtxt-val+6(2) &quot;Value - &apos;DD&apos;</FPCLINE>
      <FPCLINE>                lc_dash             &quot;Value - &apos;-&apos;</FPCLINE>
      <FPCLINE>                lwa_stdtxt-val+0(4) &quot;Value - &apos;YYYY&apos;</FPCLINE>
      <FPCLINE>           INTO lwa_stdtxt-val.</FPCLINE>
      <FPCLINE>    CONDENSE lwa_stdtxt-val NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Value for Quote ID with value</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                lwa_stdtxt-val</FPCLINE>
      <FPCLINE>           INTO lwa_enddt</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lv_enddt IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_startdt IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_startdt</FPCLINE>
      <FPCLINE>                lwa_enddt</FPCLINE>
      <FPCLINE>           INTO lwa_enddt</FPCLINE>
      <FPCLINE>               SEPARATED BY space.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lwa_startdt IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Line Item text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_CR_D2_531_532 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR li_lines2.</FPCLINE>
      <FPCLINE>* Populate the Standard text for the Billing document number</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val2 USING fp_vbelnposnr    &quot;Billing document number,Item number</FPCLINE>
      <FPCLINE>                                       fp_tdobj-id_z014 &quot;Text ID</FPCLINE>
      <FPCLINE>                                       lc_obj_vbbp      &quot;Application object - &apos;VBBP&apos;</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1    &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING li_lines2.       &quot;Standard texts</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF li_lines2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      APPEND LINES OF li_lines2 TO li_lines3.</FPCLINE>
      <FPCLINE>      CLEAR li_lines2.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF li_lines2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5250 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR li_lines2.</FPCLINE>
      <FPCLINE>* Populate the Standard text for the Billing document number</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val2 USING fp_vbelnposnr    &quot;Billing document number,Item number</FPCLINE>
      <FPCLINE>                                       fp_tdobj-id_z014 &quot;Text ID</FPCLINE>
      <FPCLINE>                                       lc_obj_vbbp      &quot;Application object - &apos;VBBP&apos;</FPCLINE>
      <FPCLINE>                                       fp_socl-lang2    &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING li_lines2.       &quot;Standard texts</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF li_lines2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      APPEND LINES OF li_lines2 TO li_lines3.</FPCLINE>
      <FPCLINE>      CLEAR li_lines2.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF li_lines2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5250 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_CR_D2_531_532 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Standard text for the Billing document number</FPCLINE>
      <FPCLINE>  PERFORM f_populate_text_val2 USING fp_vbelnposnr    &quot;Billing document number,Item number</FPCLINE>
      <FPCLINE>                                     fp_tdobj-id_z016 &quot;Text ID</FPCLINE>
      <FPCLINE>                                     lc_obj_vbbp      &quot;Application object - &apos;VBBP&apos;</FPCLINE>
      <FPCLINE>                                     fp_socl-lang2    &quot;Language Key</FPCLINE>
      <FPCLINE>                            CHANGING li_lines2.       &quot;Standard texts</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF li_lines2 IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Standard text for the Billing document number</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val2 USING fp_vbelnposnr    &quot;Billing document number,Item number</FPCLINE>
      <FPCLINE>                                       fp_tdobj-id_z016 &quot;Text ID</FPCLINE>
      <FPCLINE>                                       lc_obj_vbbp      &quot;Application object - &apos;VBBP&apos;</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1    &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING li_lines2.       &quot;Standard texts</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF li_lines2 IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*  IF li_lines2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*    APPEND LINES OF li_lines2 TO li_lines3.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF li_lines2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF li_lines2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the first line from Line item text table</FPCLINE>
      <FPCLINE>    UNASSIGN &lt;lfs_lines&gt;.</FPCLINE>
      <FPCLINE>    READ TABLE li_lines2</FPCLINE>
      <FPCLINE>     ASSIGNING &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE>         INDEX 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF sy-subrc  IS INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_enddt IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_lines.</FPCLINE>
      <FPCLINE>      CONCATENATE &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE>                  lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                  lwa_enddt</FPCLINE>
      <FPCLINE>             INTO lwa_lines</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      &lt;lfs_lines&gt; = lwa_lines.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc IS INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND LINES OF li_lines2 TO li_lines3.</FPCLINE>
      <FPCLINE>    UNASSIGN &lt;lfs_lines&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSE. &quot; ELSE -&gt; IF sy-subrc IS INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_enddt IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      APPEND lwa_enddt TO li_lines3.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_enddt IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF li_lines2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF li_lines3 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    fp_i_lines[] = li_lines3[].</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF li_lines3 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_QID_PCODE_LINTXT</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_POHDR_TXT</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the Purchase Order Header text</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_SOCL       Language from EMI Tool</FPCLINE>
      <FPCLINE>*      --&gt;FP_PURCHASE   Purchase Order Header</FPCLINE>
      <FPCLINE>*      --&gt;FP_SHIP_FROM  Ship from date</FPCLINE>
      <FPCLINE>*      &lt;--FP_PO_TXT     Final Purchase order print structure</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_pohdr_txt   USING fp_socl      TYPE ty_socl</FPCLINE>
      <FPCLINE>                                  fp_purchase  TYPE ty_purchase</FPCLINE>
      <FPCLINE>                                  fp_ship_from TYPE char100 &quot; Ship_from of type CHAR100</FPCLINE>
      <FPCLINE>                         CHANGING fp_po_txt    TYPE ty_po_txt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_poid TYPE tdobname VALUE &apos;ZOTC_0014_POID&apos;   , &quot;Purchase Order ID</FPCLINE>
      <FPCLINE>    lc_case TYPE tdobname VALUE &apos;ZOTC_0014_CASEID&apos; , &quot;Case ID</FPCLINE>
      <FPCLINE>    lc_ship TYPE tdobname VALUE &apos;ZOTC_0014_SHPFROM&apos;, &quot;Ship from</FPCLINE>
      <FPCLINE>    lc_term TYPE tdobname VALUE &apos;ZOTC_0014_PAYMENT&apos;. &quot;Payment terms</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_stdtxt  TYPE ty_stdtxt, &quot;Standard Text with values</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lwa_stdtxt1 TYPE ty_stdtxt. &quot;Standard Text with values</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_poid      &quot;Purchase Order ID Text</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_poid     &quot;Purchase Order ID Text</FPCLINE>
      <FPCLINE>                                       space       &quot;No colon</FPCLINE>
      <FPCLINE>                                       space       &quot;No value</FPCLINE>
      <FPCLINE>                                       space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1</FPCLINE>
      <FPCLINE>                              CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  fp_po_txt-bstnk_vf = fp_purchase-bstnk_vf.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_po_txt-bstnk_vf IS INITIAL.</FPCLINE>
      <FPCLINE>    fp_po_txt-bstnk_vf = &apos;No Data&apos;.</FPCLINE>
      <FPCLINE>  ENDIF.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   fp_po_txt-po_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-po_txt    = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    fp_po_txt-po_txt+70 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>         lwa_stdtxt-text  IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-po_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text  IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>         lwa_stdtxt1-text IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-po_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*  IF fp_purchase-zzcaseref IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*    PERFORM f_populate_text_val  USING lc_case     &quot;CASE ID</FPCLINE>
      <FPCLINE>*                                       space       &quot;No colon</FPCLINE>
      <FPCLINE>*                                       fp_purchase-zzcaseref</FPCLINE>
      <FPCLINE>*                                       space       &quot;No currency Key</FPCLINE>
      <FPCLINE>*                                       fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>*                              CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    fp_po_txt-case_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>*    fp_po_txt-caseref  = lwa_stdtxt-val.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_purchase-zzcaseref IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2361 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_ship      &quot;Ship from</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_ship     &quot;Ship from</FPCLINE>
      <FPCLINE>                                       space       &quot;No colon</FPCLINE>
      <FPCLINE>                                       space       &quot;No value</FPCLINE>
      <FPCLINE>                                       space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1</FPCLINE>
      <FPCLINE>                              CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  fp_po_txt-ship_frm = fp_ship_from.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   fp_po_txt-ship_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-ship_txt    = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    fp_po_txt-ship_txt+65 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>         lwa_stdtxt-text  IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-ship_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text  IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>         lwa_stdtxt1-text IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-ship_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_term      &quot;Payment Terms</FPCLINE>
      <FPCLINE>                                         space        &quot;No colon</FPCLINE>
      <FPCLINE>                                         space        &quot;No value</FPCLINE>
      <FPCLINE>                                         space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_term     &quot;Payment Terms</FPCLINE>
      <FPCLINE>                                       space       &quot;No colon</FPCLINE>
      <FPCLINE>                                       space       &quot;No value</FPCLINE>
      <FPCLINE>                                       space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1</FPCLINE>
      <FPCLINE>                              CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  fp_po_txt-zterm   = fp_purchase-zterm.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* fp_po_txt-pmt_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-pmt_txt    = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>    fp_po_txt-pmt_txt+65 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>         lwa_stdtxt-text  IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-pmt_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF lwa_stdtxt-text  IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>         lwa_stdtxt1-text IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    fp_po_txt-pmt_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_POHDR_TXT</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_SALESORD_DET</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate SVC Case ID/Order Channel details</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_SOCL    Language from EMI Tool</FPCLINE>
      <FPCLINE>*      --&gt;FP_SALES   Sales order details</FPCLINE>
      <FPCLINE>*      --&gt;FP_CASEID  Case ID</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_REF   Reference table</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_salesord_det  USING fp_socl   TYPE ty_socl</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>                                    fp_sales  TYPE ty_sales</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>                                    fp_caseid TYPE z_quoteref &quot;Legacy Qtn Ref</FPCLINE>
      <FPCLINE>                           CHANGING fp_i_ref  TYPE ty_t_stdtxt</FPCLINE>
      <FPCLINE>** ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>                                    fp_i_sls  TYPE ty_t_stdtxt</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>                                    fp_salesord_1   TYPE ty_stdtxt</FPCLINE>
      <FPCLINE>                                    fp_salesord_2   TYPE ty_stdtxt</FPCLINE>
      <FPCLINE>                                    fp_salesord_3   TYPE ty_stdtxt</FPCLINE>
      <FPCLINE>                                    fp_reference_1  TYPE ty_stdtxt</FPCLINE>
      <FPCLINE>                                    fp_reference_2  TYPE ty_stdtxt.</FPCLINE>
      <FPCLINE>** &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_svcid   TYPE tdobname  VALUE &apos;ZOTC_0014_SVCCASEID&apos; , &quot;SVC Case ID</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lc_conname TYPE tdobname  VALUE &apos;ZOTC_0014_CONNAME&apos;   , &quot;Contact name</FPCLINE>
      <FPCLINE>    lc_phnum   TYPE tdobname  VALUE &apos;ZOTC_0014_CONPHNUM&apos;  , &quot;Contact phone number</FPCLINE>
      <FPCLINE>    lc_orddt   TYPE tdobname  VALUE &apos;ZOTC_0014_ORDDT&apos;     , &quot;Order date</FPCLINE>
      <FPCLINE>    lc_sord    TYPE tdobname  VALUE &apos;ZOTC_0014_SORD&apos;      , &quot;Sales order</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lc_slash   TYPE char1     VALUE &apos;/&apos;                   , &quot;Slash</FPCLINE>
      <FPCLINE>    lc_colon   TYPE char1     VALUE &apos;:&apos;                   , &quot;Colon</FPCLINE>
      <FPCLINE>    lc_minus   TYPE char1     VALUE &apos;-&apos;.                    &quot;Dash mark</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_stdtxt  TYPE ty_stdtxt, &quot;Standard Text with values</FPCLINE>
      <FPCLINE>    lwa_stdtxt1 TYPE ty_stdtxt. &quot;Standard Text with values</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_sord     &quot;Sales order</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    lwa_stdtxt1-val = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_orddt    &quot;Order date</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang2</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    lwa_stdtxt1-val+56 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_sales-name1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_conname  &quot;Contact name</FPCLINE>
      <FPCLINE>                                           space       &quot;No colon</FPCLINE>
      <FPCLINE>                                           space       &quot;No value</FPCLINE>
      <FPCLINE>                                           space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      lwa_stdtxt1-val+110 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_sales-name1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_sls.</FPCLINE>
      <FPCLINE>      fp_salesord_1-val = lwa_stdtxt1-val.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_sord     &quot;Sales order</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    lwa_stdtxt1-val = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>    lwa_stdtxt1-val+23 = fp_sales-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val    USING lc_orddt    &quot;Order date</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>    lwa_stdtxt1-val+53 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CONCATENATE fp_sales-erdat+4(2)</FPCLINE>
      <FPCLINE>                lc_minus</FPCLINE>
      <FPCLINE>                fp_sales-erdat+6(2)</FPCLINE>
      <FPCLINE>                lc_minus</FPCLINE>
      <FPCLINE>                fp_sales-erdat+0(4)</FPCLINE>
      <FPCLINE>           INTO lwa_stdtxt1-val+70.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>    IF fp_sales-name1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_conname  &quot;Contact name</FPCLINE>
      <FPCLINE>                                           space       &quot;No colon</FPCLINE>
      <FPCLINE>                                           space       &quot;No value</FPCLINE>
      <FPCLINE>                                           space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      lwa_stdtxt1-val+107 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>      lwa_stdtxt1-val+125 = fp_sales-name1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_sales-name1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_sls.</FPCLINE>
      <FPCLINE>      fp_salesord_2-val = lwa_stdtxt1-val.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_sales-tel_number IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_phnum     &quot;Contact phone number</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_phnum    &quot;Contact phone number</FPCLINE>
      <FPCLINE>                                           space       &quot;No colon</FPCLINE>
      <FPCLINE>                                           space       &quot;No value</FPCLINE>
      <FPCLINE>                                           space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                  lc_slash</FPCLINE>
      <FPCLINE>                  lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  fp_sales-tel_number</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_sls.</FPCLINE>
      <FPCLINE>      fp_salesord_3-val = lwa_stdtxt1-val.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  fp_sales-tel_number</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_sls.</FPCLINE>
      <FPCLINE>      fp_salesord_3-val = lwa_stdtxt1-val.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                  fp_sales-tel_number</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_sls.</FPCLINE>
      <FPCLINE>      fp_salesord_3-val = lwa_stdtxt1-val.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_sales-tel_number IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt1,</FPCLINE>
      <FPCLINE>          lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_caseid IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_svcid    &quot;SVC Case ID</FPCLINE>
      <FPCLINE>                                           space       &quot;No colon</FPCLINE>
      <FPCLINE>                                           space       &quot;No value</FPCLINE>
      <FPCLINE>                                           space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      lwa_stdtxt1-val+112 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_ref.</FPCLINE>
      <FPCLINE>      fp_reference_1-val = lwa_stdtxt1-val.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_svcid    &quot;SVC Case ID</FPCLINE>
      <FPCLINE>                                       lc_colon    &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                       fp_caseid   &quot;Ref. Case value</FPCLINE>
      <FPCLINE>                                       space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                       fp_socl-lang1</FPCLINE>
      <FPCLINE>                              CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the SVC Case ID with the values</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  lwa_stdtxt-val</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val+112</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_ref.</FPCLINE>
      <FPCLINE>      fp_reference_2-val = lwa_stdtxt1-val.</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5753 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>              lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_caseid IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_SALESORD_DET</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_TAX_SUMMARY</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the Tax group summary for Canada only</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_COND   Summed up values for &apos;XR1&apos;/&apos;XR2&apos;/&apos;XR3&apos;</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_TAX  Tax group summary table to print</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_tax_summary   USING fp_cond  TYPE ty_cond   &quot; Condition summary</FPCLINE>
      <FPCLINE>                           CHANGING fp_i_tax TYPE ty_t_tax. &quot; Tax summary</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constant declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_perc  TYPE char1  VALUE &apos;%&apos;  , &quot;Percentage</FPCLINE>
      <FPCLINE>    lc_opn   TYPE char2  VALUE &apos; (&apos; , &quot;Open bracket</FPCLINE>
      <FPCLINE>    lc_cls   TYPE char1  VALUE &apos;)&apos;  , &quot;Closing bracket</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lc_slash TYPE char1  VALUE &apos;/&apos;  , &quot; Front slash</FPCLINE>
      <FPCLINE>    lc_gst   TYPE char3  VALUE &apos;GST&apos;, &quot; Gst Tax group</FPCLINE>
      <FPCLINE>    lc_tps   TYPE char3  VALUE &apos;TPS&apos;, &quot; Tps Tax group</FPCLINE>
      <FPCLINE>    lc_hst   TYPE char3  VALUE &apos;HST&apos;, &quot; Hst Tax group</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* Correction of Tax label from &apos;TUH&apos; to &apos;TVH&apos;</FPCLINE>
      <FPCLINE>*    lc_tuh   TYPE char3  VALUE &apos;TUH&apos;, &quot; Tuh Tax group</FPCLINE>
      <FPCLINE>    lc_tuh   TYPE char3  VALUE &apos;TVH&apos;, &quot; Tuh Tax group</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>    lc_pst   TYPE char3  VALUE &apos;PST&apos;, &quot; Pst Tax group</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* Correction of Tax label from &apos;TUQ&apos; to &apos;TVQ&apos;</FPCLINE>
      <FPCLINE>*    lc_tuq   TYPE char3  VALUE &apos;TUQ&apos;. &quot; Tuq Tax group</FPCLINE>
      <FPCLINE>    lc_tuq   TYPE char3  VALUE &apos;TVQ&apos;. &quot; Tuq Tax group</FPCLINE>
      <FPCLINE>*-----&gt;End of Change for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_tax    TYPE ty_tax, &quot;Tax summary</FPCLINE>
      <FPCLINE>    lv_taxamnt TYPE kbetr.  &quot;Rate (condition amount or percentage)</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF fp_cond-sum_xr1 IS NOT INITIAL OR</FPCLINE>
      <FPCLINE>     fp_cond-sum_xr2 IS NOT INITIAL OR</FPCLINE>
      <FPCLINE>     fp_cond-sum_xr3 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lwa_tax-perc = fp_cond-perc_xr1 + fp_cond-perc_xr2 + fp_cond-perc_xr3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CONDENSE lwa_tax-perc NO-GAPS.</FPCLINE>
      <FPCLINE>    CONCATENATE lwa_tax-perc</FPCLINE>
      <FPCLINE>                lc_opn</FPCLINE>
      <FPCLINE>                lc_perc</FPCLINE>
      <FPCLINE>                lc_cls</FPCLINE>
      <FPCLINE>           INTO lwa_tax-perc.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lwa_tax-amnt = lv_taxamnt = fp_cond-sum_xr1 + fp_cond-sum_xr2 + fp_cond-sum_xr3.</FPCLINE>
      <FPCLINE>    CONDENSE lwa_tax-amnt NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_tax TO fp_i_tax.</FPCLINE>
      <FPCLINE>    CLEAR lwa_tax.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_cond-sum_xr1 IS NOT INITIAL OR</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_cond-sum_xr1 IS NOT INITIAL. &quot;Aggregated value for Condition type - &apos;XR1&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Tax group summary</FPCLINE>
      <FPCLINE>    PERFORM f_fill_tax_details   USING fp_cond-tax_xr1</FPCLINE>
      <FPCLINE>                                       fp_cond-perc_xr1</FPCLINE>
      <FPCLINE>                                       fp_cond-sum_xr1</FPCLINE>
      <FPCLINE>                              CHANGING lwa_tax.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CASE lwa_tax-taxtxt.</FPCLINE>
      <FPCLINE>      WHEN lc_gst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tps   &quot;Value - &apos;TPS&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN lc_hst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tuh   &quot;Value - &apos;TUH&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN lc_pst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tuq   &quot;Value - &apos;TUQ&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN OTHERS.</FPCLINE>
      <FPCLINE>    ENDCASE.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_tax TO fp_i_tax.</FPCLINE>
      <FPCLINE>    CLEAR lwa_tax.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF li_lines2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_cond-sum_xr2 IS NOT INITIAL. &quot;Aggregated value for Condition type - &apos;XR2&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Tax group summary</FPCLINE>
      <FPCLINE>    PERFORM f_fill_tax_details   USING fp_cond-tax_xr2</FPCLINE>
      <FPCLINE>                                       fp_cond-perc_xr2</FPCLINE>
      <FPCLINE>                                       fp_cond-sum_xr2</FPCLINE>
      <FPCLINE>                              CHANGING lwa_tax.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CASE lwa_tax-taxtxt.</FPCLINE>
      <FPCLINE>      WHEN lc_gst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tps   &quot;Value - &apos;TPS&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN lc_hst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tuh   &quot;Value - &apos;TUH&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN lc_pst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tuq   &quot;Value - &apos;TUQ&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN OTHERS.</FPCLINE>
      <FPCLINE>    ENDCASE.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_tax TO fp_i_tax.</FPCLINE>
      <FPCLINE>    CLEAR lwa_tax.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF sum_xr2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_cond-sum_xr3 IS NOT INITIAL. &quot;Aggregated value for Condition type - &apos;XR3&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Tax group summary</FPCLINE>
      <FPCLINE>    PERFORM f_fill_tax_details   USING fp_cond-tax_xr3</FPCLINE>
      <FPCLINE>                                       fp_cond-perc_xr3</FPCLINE>
      <FPCLINE>                                       fp_cond-sum_xr3</FPCLINE>
      <FPCLINE>                              CHANGING lwa_tax.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CASE lwa_tax-taxtxt.</FPCLINE>
      <FPCLINE>      WHEN lc_gst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tps   &quot;Value - &apos;TPS&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN lc_hst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tuh   &quot;Value - &apos;TUH&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN lc_pst.</FPCLINE>
      <FPCLINE>* Populate the translations</FPCLINE>
      <FPCLINE>        CONCATENATE lc_tuq   &quot;Value - &apos;TUQ&apos;</FPCLINE>
      <FPCLINE>                    lc_slash &quot;Value - &apos;/&apos;</FPCLINE>
      <FPCLINE>                    lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>               INTO lwa_tax-taxtxt</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      WHEN OTHERS.</FPCLINE>
      <FPCLINE>    ENDCASE.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    APPEND lwa_tax TO fp_i_tax.</FPCLINE>
      <FPCLINE>    CLEAR lwa_tax.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF sum_xr3 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_TAX_SUMMARY</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_FILL_TAX_DETAILS</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the Tax group summary</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_TAXTXT   Tax Description - &apos;GST&apos;/&apos;HST&apos;/&apos;PST&apos;/&apos;QST&apos;</FPCLINE>
      <FPCLINE>*      --&gt;FP_PERC     Percentage value</FPCLINE>
      <FPCLINE>*      --&gt;FP_SUM      Aggregated value</FPCLINE>
      <FPCLINE>*      &lt;--FP_TAX      Tax details</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_fill_tax_details   USING fp_taxtxt  TYPE char3   &quot; GST/PST/HST/QST</FPCLINE>
      <FPCLINE>                                fp_perc    TYPE char10  &quot; Percentage</FPCLINE>
      <FPCLINE>                                fp_sum     TYPE kbetr   &quot; Summed up value</FPCLINE>
      <FPCLINE>                       CHANGING fp_tax     TYPE ty_tax. &quot; Tax details</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constant declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_perc TYPE char1  VALUE &apos;%&apos;  , &quot;Percentage</FPCLINE>
      <FPCLINE>    lc_opn  TYPE char2  VALUE &apos; (&apos; , &quot;Open bracket</FPCLINE>
      <FPCLINE>    lc_cls  TYPE char1  VALUE &apos;)&apos;.   &quot;Closing bracket</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lv_percnt TYPE char1    , &quot;Percentage character</FPCLINE>
      <FPCLINE>    lv_value  TYPE char20   , &quot;Value</FPCLINE>
      <FPCLINE>    lv_len    TYPE int2.      &quot;String length</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Popualte the Tax details to print</FPCLINE>
      <FPCLINE>  fp_tax-taxtxt = fp_taxtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CONDENSE fp_perc NO-GAPS.</FPCLINE>
      <FPCLINE>  CONCATENATE fp_perc</FPCLINE>
      <FPCLINE>              lc_opn</FPCLINE>
      <FPCLINE>              lc_perc</FPCLINE>
      <FPCLINE>              lc_cls</FPCLINE>
      <FPCLINE>         INTO fp_tax-perc.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  fp_tax-amnt = fp_sum.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CONDENSE : fp_tax-taxtxt,</FPCLINE>
      <FPCLINE>             fp_tax-amnt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_FILL_TAX_DETAILS</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_FILL_ADDRESS_TAB</FPCLINE>
      <FPCLINE>*&amp;--------------------------- ------------------------------------------*</FPCLINE>
      <FPCLINE>*       Fill the Address details for the Ship to/Bill to</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_ADDRESS    Ship to/Bill to Address details</FPCLINE>
      <FPCLINE>*      --&gt;FP_FLAG       Country spec. check - Canada/Others</FPCLINE>
      <FPCLINE>*      --&gt;FP_SPRAS      Language Key</FPCLINE>
      <FPCLINE>*      --&gt;FP_SOCL       Language from EMI Tool</FPCLINE>
      <FPCLINE>*      --&gt;FP_HEAD_DETAIL Header Details</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_ADDRESS  Address table for printing</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_fill_address_tab   USING fp_address   TYPE ty_address &quot;Address details</FPCLINE>
      <FPCLINE>                                fp_flag      TYPE flag       &quot;Ship to/Bill to</FPCLINE>
      <FPCLINE>                                fp_spras     TYPE spras      &quot;Language Key</FPCLINE>
      <FPCLINE>                                fp_socl      TYPE ty_socl    &quot;Languages</FPCLINE>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                                fp_head_detail TYPE invoice_s_prt_head_detail &quot; Header Details</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE>                       CHANGING fp_i_address TYPE ty_t_stdtxt &quot;Address tab</FPCLINE>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>                                fp_add_data  TYPE ty_add_data. &quot; Add data</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_shipto TYPE tdobname VALUE &apos;ZOTC_0014_SHIPTOCUST&apos; , &quot;Ship to Customer</FPCLINE>
      <FPCLINE>    lc_billto TYPE tdobname VALUE &apos;ZOTC_0014_BILLTOCUST&apos; , &quot;Bill to Customer</FPCLINE>
      <FPCLINE>    lc_custno TYPE tdobname VALUE &apos;ZOTC_0014_CUSTNO&apos;     , &quot;Customer number</FPCLINE>
      <FPCLINE>    lc_slash  TYPE char1    VALUE &apos;/&apos;                    , &quot;Slash</FPCLINE>
      <FPCLINE>    lc_space  TYPE char2    VALUE &apos;  &apos;                   , &quot;Spaces</FPCLINE>
      <FPCLINE>    lc_star   TYPE char1    VALUE &apos;*&apos;                    , &quot;Punctuation</FPCLINE>
      <FPCLINE>    lc_comma  TYPE char1    VALUE &apos;,&apos;.                     &quot;Punctuation</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Begin of Change by RNATHAK for Defect # 8720</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_pobox  TYPE tdobname VALUE &apos;ZOTC_0014_POBOX&apos;. &quot;P.O. Box</FPCLINE>
      <FPCLINE>* End of Change by RNATHAK for Defect # 8720</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_stdtxt    TYPE ty_stdtxt, &quot;Standard Text with values</FPCLINE>
      <FPCLINE>    lwa_stdtxt1   TYPE ty_stdtxt, &quot;Standard Text with values</FPCLINE>
      <FPCLINE>    lv_country    TYPE landx    , &quot;Country Name</FPCLINE>
      <FPCLINE>    lv_value      TYPE char100  , &quot;Line values</FPCLINE>
      <FPCLINE>    lv_state      TYPE bezei20  , &quot;State/Province details</FPCLINE>
      <FPCLINE>    lv_street     TYPE char80,    &quot;Street</FPCLINE>
      <FPCLINE>* Begin of Change by PDEBARU for Defect# 8835</FPCLINE>
      <FPCLINE>    lv_flag       TYPE flag, &quot; Flag for PO box check</FPCLINE>
      <FPCLINE>* End of Change by PDEBARU for Defect# 8835</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lv_name       TYPE tdobname,                    &quot;Local variable</FPCLINE>
      <FPCLINE>    lv_kunnr      TYPE kunnr,                       &quot;Local variable</FPCLINE>
      <FPCLINE>    li_text_lines TYPE STANDARD TABLE OF char30000, &quot; Text_lines</FPCLINE>
      <FPCLINE>    li_lines      TYPE tlinet,                      &quot;Lines read from text element</FPCLINE>
      <FPCLINE>    lv_att_to     TYPE string,</FPCLINE>
      <FPCLINE>    lwa_lines     TYPE tline.                       &quot;Lines read from text element</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_lines&gt;      TYPE tline,     &quot;Lines read from text element</FPCLINE>
      <FPCLINE>    &lt;lfs_text_lines&gt; TYPE char30000. &quot; Text_line of type CHAR30000</FPCLINE>
      <FPCLINE>  CONSTANTS: lc_id       TYPE tdid VALUE &apos;Z009&apos;,     &quot;Local constant for ID</FPCLINE>
      <FPCLINE>             lc_object   TYPE tdobject VALUE &apos;KNVV&apos;, &quot;Local constant for Object</FPCLINE>
      <FPCLINE>             lc_english  TYPE spras VALUE &apos;E&apos;,      &quot;Local constant for english language</FPCLINE>
      <FPCLINE>             lc_english1 TYPE sylangu VALUE &apos;E&apos;,   &quot;Local constant for sy-langu</FPCLINE>
      <FPCLINE>             lc_space1   TYPE tdbool   VALUE &apos; &apos;.    &quot;Local constant for space</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS: &lt;lfs_address&gt; TYPE ty_stdtxt,</FPCLINE>
      <FPCLINE>                 &lt;lfs_add&gt;     TYPE string.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CONSTANTS:</FPCLINE>
      <FPCLINE>    lc_add_data  TYPE string   VALUE &apos;FP_ADD_DATA-LINE&apos;.</FPCLINE>
      <FPCLINE>  DATA: lv_add_head  TYPE string,</FPCLINE>
      <FPCLINE>        lv_add_name  TYPE string,</FPCLINE>
      <FPCLINE>        lv_add_house TYPE string,</FPCLINE>
      <FPCLINE>        lv_add_pobox TYPE string,</FPCLINE>
      <FPCLINE>        lv_add_floor TYPE string,</FPCLINE>
      <FPCLINE>        lv_add_city  TYPE string,</FPCLINE>
      <FPCLINE>        lv_count     TYPE char_02, &quot; Count of type CHAR1</FPCLINE>
      <FPCLINE>        lv_fieldname TYPE string.  &quot;field name</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>* Begin of Change by PDEBARU for Defect# 8835</FPCLINE>
      <FPCLINE>  CLEAR lv_flag.</FPCLINE>
      <FPCLINE>* End of change by PDEBARU for Defect # 8835</FPCLINE>
      <FPCLINE>  IF fp_flag IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_custno    &quot;Customer number</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_shipto   &quot;Ship to</FPCLINE>
      <FPCLINE>                                           space       &quot;No colon</FPCLINE>
      <FPCLINE>                                           space       &quot;No value</FPCLINE>
      <FPCLINE>                                           space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                  lc_slash</FPCLINE>
      <FPCLINE>                  lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  fp_address-kunnr</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_address.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  fp_address-kunnr</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_address.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                  fp_address-kunnr</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_address.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR : lwa_stdtxt1,</FPCLINE>
      <FPCLINE>            lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSE. &quot; ELSE -&gt; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_custno    &quot;Customer number</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_billto   &quot;Bill to</FPCLINE>
      <FPCLINE>                                           space       &quot;No colon</FPCLINE>
      <FPCLINE>                                           space       &quot;No value</FPCLINE>
      <FPCLINE>                                           space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                  lc_slash</FPCLINE>
      <FPCLINE>                  lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  fp_address-kunnr</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_address.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  fp_address-kunnr</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_address.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt1-text</FPCLINE>
      <FPCLINE>                  fp_address-kunnr</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt1-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      APPEND lwa_stdtxt1 TO fp_i_address.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*If Att to Text is maintained in customer master</FPCLINE>
      <FPCLINE>*then it will catch this text to populate in the form</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR: lv_kunnr,lv_name,lwa_stdtxt1.</FPCLINE>
      <FPCLINE>    REFRESH: li_lines,li_text_lines.</FPCLINE>
      <FPCLINE>    CALL FUNCTION &apos;CONVERSION_EXIT_ALPHA_INPUT&apos;</FPCLINE>
      <FPCLINE>      EXPORTING</FPCLINE>
      <FPCLINE>        input  = fp_address-kunnr</FPCLINE>
      <FPCLINE>      IMPORTING</FPCLINE>
      <FPCLINE>        output = lv_kunnr.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CONCATENATE lv_kunnr fp_head_detail-vbdkr-vkorg</FPCLINE>
      <FPCLINE>      fp_head_detail-vbdkr-vtweg fp_head_detail-vbdkr-spart</FPCLINE>
      <FPCLINE>    INTO lv_name.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CALL FUNCTION &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>      EXPORTING</FPCLINE>
      <FPCLINE>        id                      = lc_id</FPCLINE>
      <FPCLINE>        language                = fp_spras</FPCLINE>
      <FPCLINE>        name                    = lv_name</FPCLINE>
      <FPCLINE>        object                  = lc_object</FPCLINE>
      <FPCLINE>      TABLES</FPCLINE>
      <FPCLINE>        lines                   = li_lines</FPCLINE>
      <FPCLINE>      EXCEPTIONS</FPCLINE>
      <FPCLINE>        id                      = 1</FPCLINE>
      <FPCLINE>        language                = 2</FPCLINE>
      <FPCLINE>        name                    = 3</FPCLINE>
      <FPCLINE>        not_found               = 4</FPCLINE>
      <FPCLINE>        object                  = 5</FPCLINE>
      <FPCLINE>        reference_check         = 6</FPCLINE>
      <FPCLINE>        wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>        OTHERS                  = 8.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>* Calling FM to convert the text line table data into string</FPCLINE>
      <FPCLINE>      CALL FUNCTION &apos;CONVERT_ITF_TO_STREAM_TEXT&apos;</FPCLINE>
      <FPCLINE>        EXPORTING</FPCLINE>
      <FPCLINE>          language    = fp_spras</FPCLINE>
      <FPCLINE>          lf          = lc_space1</FPCLINE>
      <FPCLINE>        TABLES</FPCLINE>
      <FPCLINE>          itf_text    = li_lines       &quot;Text line data</FPCLINE>
      <FPCLINE>          text_stream = li_text_lines. &quot;String format</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF sy-subrc EQ 0.</FPCLINE>
      <FPCLINE>        UNASSIGN &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        READ TABLE li_text_lines</FPCLINE>
      <FPCLINE>         ASSIGNING &lt;lfs_text_lines&gt;</FPCLINE>
      <FPCLINE>             INDEX 1.</FPCLINE>
      <FPCLINE>        lwa_stdtxt1-val = &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        APPEND lwa_stdtxt1 TO fp_i_address.</FPCLINE>
      <FPCLINE>        CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF sy-subrc EQ 0</FPCLINE>
      <FPCLINE>    ELSE. &quot; ELSE -&gt; IF sy-subrc EQ 0</FPCLINE>
      <FPCLINE>*As per the requirement if the text is not maintained in the required language</FPCLINE>
      <FPCLINE>*then it should pick the English anguage as default for every invoice.</FPCLINE>
      <FPCLINE>      CALL FUNCTION &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>        EXPORTING</FPCLINE>
      <FPCLINE>          id                      = lc_id</FPCLINE>
      <FPCLINE>          language                = lc_english</FPCLINE>
      <FPCLINE>          name                    = lv_name</FPCLINE>
      <FPCLINE>          object                  = lc_object</FPCLINE>
      <FPCLINE>        TABLES</FPCLINE>
      <FPCLINE>          lines                   = li_lines</FPCLINE>
      <FPCLINE>        EXCEPTIONS</FPCLINE>
      <FPCLINE>          id                      = 1</FPCLINE>
      <FPCLINE>          language                = 2</FPCLINE>
      <FPCLINE>          name                    = 3</FPCLINE>
      <FPCLINE>          not_found               = 4</FPCLINE>
      <FPCLINE>          object                  = 5</FPCLINE>
      <FPCLINE>          reference_check         = 6</FPCLINE>
      <FPCLINE>          wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>          OTHERS                  = 8.</FPCLINE>
      <FPCLINE>      IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>* Calling FM to convert the text line table data into string</FPCLINE>
      <FPCLINE>        CALL FUNCTION &apos;CONVERT_ITF_TO_STREAM_TEXT&apos;</FPCLINE>
      <FPCLINE>          EXPORTING</FPCLINE>
      <FPCLINE>            language    = lc_english1</FPCLINE>
      <FPCLINE>            lf          = lc_space1</FPCLINE>
      <FPCLINE>          TABLES</FPCLINE>
      <FPCLINE>            itf_text    = li_lines       &quot;Text line data</FPCLINE>
      <FPCLINE>            text_stream = li_text_lines. &quot;String format</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        IF sy-subrc EQ 0.</FPCLINE>
      <FPCLINE>          UNASSIGN &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          READ TABLE li_text_lines</FPCLINE>
      <FPCLINE>           ASSIGNING &lt;lfs_text_lines&gt;</FPCLINE>
      <FPCLINE>               INDEX 1.</FPCLINE>
      <FPCLINE>          lwa_stdtxt1-val = &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>          APPEND lwa_stdtxt1 TO fp_i_address.</FPCLINE>
      <FPCLINE>          CLEAR lwa_stdtxt1.</FPCLINE>
      <FPCLINE>        ENDIF. &quot; IF sy-subrc EQ 0</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CLEAR : lwa_stdtxt1,</FPCLINE>
      <FPCLINE>            lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_flag IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*** Populate Address first Row (lv_add_head)</FPCLINE>
      <FPCLINE>*********************************************************************</FPCLINE>
      <FPCLINE>  READ TABLE fp_i_address ASSIGNING &lt;lfs_address&gt; INDEX 1.</FPCLINE>
      <FPCLINE>  IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>    lv_add_head = &lt;lfs_address&gt;-val.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Index 2 will take Att To text and populate it if it is maintained in the customer master</FPCLINE>
      <FPCLINE>  READ TABLE fp_i_address ASSIGNING &lt;lfs_address&gt; INDEX 2.</FPCLINE>
      <FPCLINE>  IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>    lv_att_to = &lt;lfs_address&gt;-val.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 17-Aug-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*** Populate Address Next Row (lv_add_name)</FPCLINE>
      <FPCLINE>*&amp;--Name 1</FPCLINE>
      <FPCLINE>  IF fp_address-name1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    lv_add_name = fp_address-name1.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-name1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Name 2</FPCLINE>
      <FPCLINE>  IF fp_address-name2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONCATENATE lv_add_name fp_address-name2 INTO lv_add_name</FPCLINE>
      <FPCLINE>    SEPARATED BY space.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-name2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Name 3</FPCLINE>
      <FPCLINE>  IF fp_address-name3 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONCATENATE lv_add_name fp_address-name3 INTO lv_add_name</FPCLINE>
      <FPCLINE>    SEPARATED BY space.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-name3 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*&amp;--Name 4</FPCLINE>
      <FPCLINE>  IF fp_address-name4 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONCATENATE lv_add_name fp_address-name4 INTO lv_add_name</FPCLINE>
      <FPCLINE>    SEPARATED BY space.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-name4 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CONDENSE lv_add_name.</FPCLINE>
      <FPCLINE>*** Populate Address Next Row (lv_add_house)</FPCLINE>
      <FPCLINE>*&amp;--House Number</FPCLINE>
      <FPCLINE>  IF fp_address-house_num1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    lv_add_house = fp_address-house_num1.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-house_num1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--House2</FPCLINE>
      <FPCLINE>  IF fp_address-house_num2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONCATENATE lv_add_house fp_address-house_num2 INTO lv_add_house</FPCLINE>
      <FPCLINE>    SEPARATED BY &apos;,&apos;.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-house_num2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Street</FPCLINE>
      <FPCLINE>  IF fp_address-street IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONCATENATE lv_add_house fp_address-street INTO lv_add_house</FPCLINE>
      <FPCLINE>    SEPARATED BY space.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-street IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Srting supplier</FPCLINE>
      <FPCLINE>  IF fp_address-str_suppl1 IS NOT INITIAL .</FPCLINE>
      <FPCLINE>    CONCATENATE lv_add_house fp_address-str_suppl1 INTO lv_add_house</FPCLINE>
      <FPCLINE>    SEPARATED BY space.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-str_suppl1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>  CONDENSE lv_add_house.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*** Populate Address Next Row (lv_add_floor)</FPCLINE>
      <FPCLINE>  IF fp_address-building IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    lv_add_floor = fp_address-building.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-building IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Room Number</FPCLINE>
      <FPCLINE>  IF fp_address-roomnumber IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONCATENATE lv_add_floor fp_address-roomnumber INTO lv_add_floor</FPCLINE>
      <FPCLINE>    SEPARATED BY &apos;,&apos;.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-roomnumber IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&amp;--Floor</FPCLINE>
      <FPCLINE>  IF fp_address-floor IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONCATENATE lv_add_floor fp_address-floor INTO lv_add_floor</FPCLINE>
      <FPCLINE>    SEPARATED BY &apos;,&apos;.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-floor IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Only for Ship to</FPCLINE>
      <FPCLINE>  IF lv_add_floor IS INITIAL AND fp_flag = abap_false.</FPCLINE>
      <FPCLINE>    IF fp_address-str_suppl2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      lv_add_floor = fp_address-str_suppl2.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_address-str_suppl2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_add_floor IS INITIAL AND fp_flag = abap_false</FPCLINE>
      <FPCLINE>  CONDENSE lv_add_floor.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*** Populate Address Next Row (lv_add_pobox)</FPCLINE>
      <FPCLINE>* For Bill To Only</FPCLINE>
      <FPCLINE>  IF fp_flag = abap_true.</FPCLINE>
      <FPCLINE>    IF fp_address-po_box IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_pobox &quot;P.O. Box</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_address-po_box</FPCLINE>
      <FPCLINE>                                         space</FPCLINE>
      <FPCLINE>                                         fp_spras &quot;Language Key</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate the value for the P.O. Box</FPCLINE>
      <FPCLINE>        CLEAR lv_value.</FPCLINE>
      <FPCLINE>        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                    fp_address-po_box</FPCLINE>
      <FPCLINE>               INTO lv_add_pobox</FPCLINE>
      <FPCLINE>                    SEPARATED BY space.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_address-po_box IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CONDENSE lv_add_pobox.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_flag = abap_true</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*** Populate Address Next Row (lv_add_city)</FPCLINE>
      <FPCLINE>*  *City</FPCLINE>
      <FPCLINE>  IF fp_address-city1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    lv_add_city = fp_address-city1.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-city1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Region</FPCLINE>
      <FPCLINE>  IF fp_address-region IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    IF lv_add_city IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      CONCATENATE lv_add_city fp_address-region INTO lv_add_city</FPCLINE>
      <FPCLINE>      SEPARATED BY &apos;,&apos;.</FPCLINE>
      <FPCLINE>    ELSE. &quot; ELSE -&gt; IF lv_add_city IS NOT INITIAL</FPCLINE>
      <FPCLINE>      lv_add_city = fp_address-region.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lv_add_city IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-region IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lv_add_pobox IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* If Po box is there only then print post_code2</FPCLINE>
      <FPCLINE>    IF fp_address-post_code2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      IF lv_add_city IS NOT INITIAL.</FPCLINE>
      <FPCLINE>        CONCATENATE lv_add_city fp_address-post_code2 INTO lv_add_city</FPCLINE>
      <FPCLINE>        SEPARATED BY space.</FPCLINE>
      <FPCLINE>      ELSE. &quot; ELSE -&gt; IF lv_add_city IS NOT INITIAL</FPCLINE>
      <FPCLINE>        lv_add_city = fp_address-post_code2.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lv_add_city IS NOT INITIAL</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_address-post_code2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ELSE. &quot; ELSE -&gt; IF fp_address-post_code2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>    IF fp_address-post_code1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>      IF lv_add_city IS NOT INITIAL.</FPCLINE>
      <FPCLINE>        CONCATENATE lv_add_city fp_address-post_code1 INTO lv_add_city</FPCLINE>
      <FPCLINE>        SEPARATED BY space.</FPCLINE>
      <FPCLINE>      ELSE. &quot; ELSE -&gt; IF lv_add_city IS NOT INITIAL</FPCLINE>
      <FPCLINE>        lv_add_city = fp_address-post_code1.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF lv_add_city IS NOT INITIAL</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF fp_address-post_code1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_add_pobox IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*Country</FPCLINE>
      <FPCLINE>  IF fp_address-country IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    CONDENSE fp_address-country NO-GAPS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CONCATENATE lv_add_city fp_address-country INTO lv_add_city</FPCLINE>
      <FPCLINE>    SEPARATED BY space.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-country IS NOT INITIAL</FPCLINE>
      <FPCLINE>  CONDENSE lv_add_city.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate ship to and bill to address in the layout.</FPCLINE>
      <FPCLINE>  lv_count = 1.</FPCLINE>
      <FPCLINE>  CONCATENATE lc_add_data lv_count INTO lv_fieldname.</FPCLINE>
      <FPCLINE>  ASSIGN (lv_fieldname) TO &lt;lfs_add&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lv_add_head IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    IF &lt;lfs_add&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>      &lt;lfs_add&gt; = lv_add_head.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_count = lv_count + 1.</FPCLINE>
      <FPCLINE>      CONCATENATE lc_add_data lv_count INTO lv_fieldname.</FPCLINE>
      <FPCLINE>      ASSIGN (lv_fieldname) TO &lt;lfs_add&gt;.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF &lt;lfs_add&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_add_head IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF lv_add_name IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    IF &lt;lfs_add&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>      &lt;lfs_add&gt; = lv_add_name.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_count = lv_count + 1.</FPCLINE>
      <FPCLINE>      CONCATENATE lc_add_data lv_count INTO lv_fieldname.</FPCLINE>
      <FPCLINE>      ASSIGN (lv_fieldname) TO &lt;lfs_add&gt;.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF &lt;lfs_add&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_add_name IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 24-Oct-2016</FPCLINE>
      <FPCLINE>  IF lv_att_to IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    IF &lt;lfs_add&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>      &lt;lfs_add&gt; = lv_att_to.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_count = lv_count + 1.</FPCLINE>
      <FPCLINE>      CONCATENATE lc_add_data lv_count INTO lv_fieldname.</FPCLINE>
      <FPCLINE>      ASSIGN (lv_fieldname) TO &lt;lfs_add&gt;.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF &lt;lfs_add&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_att_to IS NOT INITIAL</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 24-Oct-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lv_add_house IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    IF &lt;lfs_add&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>      &lt;lfs_add&gt; = lv_add_house.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_count = lv_count + 1.</FPCLINE>
      <FPCLINE>      CONCATENATE lc_add_data lv_count INTO lv_fieldname.</FPCLINE>
      <FPCLINE>      ASSIGN (lv_fieldname) TO &lt;lfs_add&gt;.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF &lt;lfs_add&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_add_house IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lv_add_floor IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    IF &lt;lfs_add&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>      &lt;lfs_add&gt; = lv_add_floor.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_count = lv_count + 1.</FPCLINE>
      <FPCLINE>      CONCATENATE lc_add_data lv_count INTO lv_fieldname.</FPCLINE>
      <FPCLINE>      ASSIGN (lv_fieldname) TO &lt;lfs_add&gt;.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF &lt;lfs_add&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_add_floor IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lv_add_pobox IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    IF &lt;lfs_add&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>      &lt;lfs_add&gt; = lv_add_pobox.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_count = lv_count + 1.</FPCLINE>
      <FPCLINE>      CONCATENATE lc_add_data lv_count INTO lv_fieldname.</FPCLINE>
      <FPCLINE>      ASSIGN (lv_fieldname) TO &lt;lfs_add&gt;.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF &lt;lfs_add&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_add_pobox IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*---&gt;Begin of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 24-Oct-2016</FPCLINE>
      <FPCLINE>*As the functional does not want to change in layout so we are checking</FPCLINE>
      <FPCLINE>*if the number of field is 6 or not because in the layout section there are only six line for the address table</FPCLINE>
      <FPCLINE>  IF lv_count EQ 7.</FPCLINE>
      <FPCLINE>    EXIT.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_count EQ 7</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D2_OTC_FDD_0014 Defect# 1919 by AMOHAPA on 24-Oct-2016</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lv_add_city IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    IF &lt;lfs_add&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE>      &lt;lfs_add&gt; = lv_add_city.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lv_count = lv_count + 1.</FPCLINE>
      <FPCLINE>      CONCATENATE lc_add_data lv_count INTO lv_fieldname.</FPCLINE>
      <FPCLINE>      ASSIGN (lv_fieldname) TO &lt;lfs_add&gt;.</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF &lt;lfs_add&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lv_add_city IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Insert for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>*  CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>*              lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*         INTO lv_value</FPCLINE>
      <FPCLINE>*              SEPARATED BY lc_space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>*  lwa_stdtxt-val = lv_value.</FPCLINE>
      <FPCLINE>*  APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>*  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>*          lv_value.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*-----&gt;Begin of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the NAME</FPCLINE>
      <FPCLINE>*  IF fp_address-name1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*    lwa_stdtxt-val = fp_address-name1.</FPCLINE>
      <FPCLINE>*    APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>*    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_address-name1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF fp_address-house_num1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>** Prepare the Street Address</FPCLINE>
      <FPCLINE>*    lv_street = fp_address-house_num1.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_address-house_num1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF fp_address-street IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF lv_street IS NOT INITIAL.</FPCLINE>
      <FPCLINE>** Prepare the Street Address</FPCLINE>
      <FPCLINE>*      CONCATENATE lv_street</FPCLINE>
      <FPCLINE>*                  fp_address-street</FPCLINE>
      <FPCLINE>*             INTO lv_street</FPCLINE>
      <FPCLINE>*                  SEPARATED BY space.</FPCLINE>
      <FPCLINE>*    ELSE. &quot; ELSE -&gt; IF lv_street IS NOT INITIAL</FPCLINE>
      <FPCLINE>*      lv_street = fp_address-street.</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF lv_street IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_address-street IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF fp_address-house_num2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF lv_street IS NOT INITIAL.</FPCLINE>
      <FPCLINE>** Prepare the Street Address</FPCLINE>
      <FPCLINE>*      CONCATENATE lv_street</FPCLINE>
      <FPCLINE>*                  fp_address-house_num2</FPCLINE>
      <FPCLINE>*             INTO lv_street</FPCLINE>
      <FPCLINE>*                  SEPARATED BY space.</FPCLINE>
      <FPCLINE>*    ELSE. &quot; ELSE -&gt; IF lv_street IS NOT INITIAL</FPCLINE>
      <FPCLINE>*      lv_street = fp_address-house_num2.</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF lv_street IS NOT INITIAL</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_address-house_num2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the STREET ADDRESS</FPCLINE>
      <FPCLINE>*  IF lv_street IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*    lwa_stdtxt-val = lv_street.</FPCLINE>
      <FPCLINE>*    APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>*    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF lv_street IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>**  Begin of change by RNATHAK for Defect #8720</FPCLINE>
      <FPCLINE>*  IF lv_street IS INITIAL.</FPCLINE>
      <FPCLINE>*    IF fp_address-po_box IS NOT INITIAL.</FPCLINE>
      <FPCLINE>** Begin of chnage by PDEBARU for Defect # 8835</FPCLINE>
      <FPCLINE>*      lv_flag = abap_true.</FPCLINE>
      <FPCLINE>** End of chnage by PDEBARU for Defect # 8835</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*      PERFORM f_populate_text_val  USING lc_pobox &quot;P.O. Box</FPCLINE>
      <FPCLINE>*                                         space</FPCLINE>
      <FPCLINE>*                                         fp_address-po_box</FPCLINE>
      <FPCLINE>*                                         space</FPCLINE>
      <FPCLINE>*                                         fp_spras &quot;Language Key</FPCLINE>
      <FPCLINE>*                                CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>** Populate the value for the P.O. Box</FPCLINE>
      <FPCLINE>*        CLEAR lv_value.</FPCLINE>
      <FPCLINE>*        CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>*                    fp_address-po_box</FPCLINE>
      <FPCLINE>*               INTO lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*                    SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF fp_address-po_box IS NOT INITIAL</FPCLINE>
      <FPCLINE>*    IF fp_address-name2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*      IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*        CONCATENATE lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*                    fp_address-name2</FPCLINE>
      <FPCLINE>*               INTO lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*                    SEPARATED BY space.</FPCLINE>
      <FPCLINE>*      ELSE. &quot; ELSE -&gt; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE>*        lwa_stdtxt-val = fp_address-name2.</FPCLINE>
      <FPCLINE>*      ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF fp_address-name2 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*    IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*      APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>*      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF lv_street IS INITIAL</FPCLINE>
      <FPCLINE>**  End of change by RNATHAK for Defect # 8720</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the CITY</FPCLINE>
      <FPCLINE>*  IF fp_address-city1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*    lv_value = fp_address-city1.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_address-city1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF fp_address-country IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    CONDENSE fp_address-country NO-GAPS.</FPCLINE>
      <FPCLINE>** Get the Country value</FPCLINE>
      <FPCLINE>*    SELECT</FPCLINE>
      <FPCLINE>*    SINGLE landx &quot; Vehicle country key</FPCLINE>
      <FPCLINE>*      FROM t005t &quot; Countries</FPCLINE>
      <FPCLINE>*      INTO lv_country</FPCLINE>
      <FPCLINE>*     WHERE spras = fp_spras</FPCLINE>
      <FPCLINE>*       AND land1 = fp_address-country.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    IF sy-subrc = 0.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Fetch the State/Province details</FPCLINE>
      <FPCLINE>*      SELECT</FPCLINE>
      <FPCLINE>*      SINGLE bezei &quot; Description</FPCLINE>
      <FPCLINE>*        FROM t005u &quot; Taxes: Region Key: Texts</FPCLINE>
      <FPCLINE>*        INTO lv_state</FPCLINE>
      <FPCLINE>*       WHERE spras = fp_spras</FPCLINE>
      <FPCLINE>*         AND land1 = fp_address-country</FPCLINE>
      <FPCLINE>*         AND bland = fp_address-region.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>*             &quot; No action needed</FPCLINE>
      <FPCLINE>*      ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_address-country IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF lv_value IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*     lv_state IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the CITY/STATE/PROVINCE</FPCLINE>
      <FPCLINE>*    CONCATENATE lv_value &quot;City</FPCLINE>
      <FPCLINE>*                lc_comma</FPCLINE>
      <FPCLINE>*           INTO lv_value.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    CONCATENATE lv_value &quot;City</FPCLINE>
      <FPCLINE>*                lv_state &quot;State</FPCLINE>
      <FPCLINE>*           INTO lwa_stdtxt-val</FPCLINE>
      <FPCLINE>*                SEPARATED BY space.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ELSEIF lv_value IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*         lv_state IS INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    lwa_stdtxt-val = lv_value. &quot;City only</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ELSEIF lv_value IS INITIAL AND</FPCLINE>
      <FPCLINE>*         lv_state IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    lwa_stdtxt-val = lv_state. &quot;State only</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF lv_value IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  IF lwa_stdtxt IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*    APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>*    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF lwa_stdtxt IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate the POSTAL CODE</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Begin of Change by PDEBARU for defect# 8835</FPCLINE>
      <FPCLINE>*  IF lv_flag = abap_true.</FPCLINE>
      <FPCLINE>*    IF fp_address-post_code2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*      lwa_stdtxt-val = fp_address-post_code2.</FPCLINE>
      <FPCLINE>*      APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>*      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>*    ENDIF.</FPCLINE>
      <FPCLINE>*  ELSE. &quot; ELSE -&gt; IF lv_flag = abap_true</FPCLINE>
      <FPCLINE>** End of Change by PDEBARU for defect# 8835</FPCLINE>
      <FPCLINE>*    IF fp_address-post_code1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*      lwa_stdtxt-val = fp_address-post_code1.</FPCLINE>
      <FPCLINE>*      APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>*      CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    ENDIF. &quot; IF fp_address-post_code1 IS NOT INITIAL</FPCLINE>
      <FPCLINE>** Begin of Change by PDEBARU for defect# 8835</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF lv_flag = abap_true</FPCLINE>
      <FPCLINE>** End of Change by PDEBARU for defect# 8835</FPCLINE>
      <FPCLINE>** Populate the COUNTRY</FPCLINE>
      <FPCLINE>*  IF lv_country IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    lwa_stdtxt-val = lv_country.</FPCLINE>
      <FPCLINE>*    APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>*    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF lv_country IS NOT INITIAL</FPCLINE>
      <FPCLINE>*-----&gt;End of Delete for D2_OTC_FDD_0014 Defect#326 PGL-B by MGARG</FPCLINE>
      <FPCLINE>ENDFORM. &quot; F_FILL_ADDRESS_TAB</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_COUNTRY</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the Country to be displayed under INVOICE</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_SPRAS    Language Key</FPCLINE>
      <FPCLINE>*      --&gt;FP_NAST     Message Status</FPCLINE>
      <FPCLINE>*      &lt;--FP_COUNTRY  Country Name</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_country    USING fp_adrnr   TYPE ad_addrnum &quot;Address number</FPCLINE>
      <FPCLINE>                                 fp_spras   TYPE spras      &quot;Language Key</FPCLINE>
      <FPCLINE>                        CHANGING fp_country TYPE landx.     &quot;Country Name</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_address TYPE ty_address. &quot;Address details</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_adrnr IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Address details based on the Address number</FPCLINE>
      <FPCLINE>    SELECT name1      &quot; Name 1</FPCLINE>
      <FPCLINE>           name2      &quot; Name 2</FPCLINE>
      <FPCLINE>           name3      &quot; Name 3</FPCLINE>
      <FPCLINE>           name4      &quot; Name 4</FPCLINE>
      <FPCLINE>           city1      &quot; City</FPCLINE>
      <FPCLINE>           city2      &quot; District</FPCLINE>
      <FPCLINE>           post_code1 &quot; City postal code</FPCLINE>
      <FPCLINE>           post_code2 &quot; Po Box code  &quot; Defect 8894</FPCLINE>
      <FPCLINE>           po_box     &quot; PO Box</FPCLINE>
      <FPCLINE>           street     &quot; Street</FPCLINE>
      <FPCLINE>           house_num1 &quot; House Number</FPCLINE>
      <FPCLINE>           house_num2 &quot; House number supplement</FPCLINE>
      <FPCLINE>           country    &quot; Country Key</FPCLINE>
      <FPCLINE>           region     &quot; Region (State, Province, County)</FPCLINE>
      <FPCLINE>           tel_number &quot; First telephone no.: dialling code+number</FPCLINE>
      <FPCLINE>        UP TO 1 ROWS</FPCLINE>
      <FPCLINE>      FROM adrc       &quot; Addresses (Business Address Services)</FPCLINE>
      <FPCLINE>      INTO lwa_address</FPCLINE>
      <FPCLINE>     WHERE addrnumber = fp_adrnr.</FPCLINE>
      <FPCLINE>    ENDSELECT.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF sy-subrc IS INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_address-country IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CONDENSE lwa_address-country NO-GAPS.</FPCLINE>
      <FPCLINE>* Get the Country value</FPCLINE>
      <FPCLINE>      SELECT</FPCLINE>
      <FPCLINE>      SINGLE landx &quot; Vehicle country key</FPCLINE>
      <FPCLINE>        FROM t005t &quot; Countries</FPCLINE>
      <FPCLINE>        INTO fp_country</FPCLINE>
      <FPCLINE>       WHERE spras = fp_spras</FPCLINE>
      <FPCLINE>         AND land1 = lwa_address-country.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>        &quot; No action needed</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc IS INITIAL AND</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_adrnr IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_COUNTRY</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_FILL_REMITADDRESS</FPCLINE>
      <FPCLINE>*&amp;--------------------------- ------------------------------------------*</FPCLINE>
      <FPCLINE>*       Fill the Address details for the Lockbox Bank</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_SPRAS      Language Key</FPCLINE>
      <FPCLINE>*      --&gt;FP_NAST       Message Status</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_ADDRESS  Address table for printing</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_fill_remitaddress</FPCLINE>
      <FPCLINE>*--&gt; Begin of comment done by U102006 for defect#4461 on 29-Dec-2017</FPCLINE>
      <FPCLINE>*  USING fp_address   TYPE ty_address   &quot;Address details</FPCLINE>
      <FPCLINE>*&lt;-- End of comment done by U102006 for defect#4461 on 29-Dec-2017</FPCLINE>
      <FPCLINE>*--&gt; Begin of insert done by U102006 for defect#4461 on 29-Dec-2017</FPCLINE>
      <FPCLINE>                       USING    fp_address   TYPE ty_address_remit</FPCLINE>
      <FPCLINE>*&lt;-- End of insert done by U102006 for defect#4461 on 29-Dec-2017</FPCLINE>
      <FPCLINE>                                fp_spras     TYPE spras        &quot;Language Key</FPCLINE>
      <FPCLINE>                       CHANGING fp_i_address TYPE ty_t_stdtxt. &quot;Address tab</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_pobox TYPE tdobname VALUE &apos;ZOTC_0014_POBOX&apos;, &quot;P.O. Box</FPCLINE>
      <FPCLINE>    lc_comma TYPE char1    VALUE &apos;,&apos;.               &quot;Punctuation</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_stdtxt TYPE ty_stdtxt, &quot;Standard Text with values</FPCLINE>
      <FPCLINE>    lv_value   TYPE char100.   &quot;Line values</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate NAME1</FPCLINE>
      <FPCLINE>  IF fp_address-name1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    lwa_stdtxt-val = fp_address-name1.</FPCLINE>
      <FPCLINE>    APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-name1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_address-po_box IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>    PERFORM f_populate_text_val  USING lc_pobox &quot;P.O. Box</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       fp_address-po_box</FPCLINE>
      <FPCLINE>                                       space</FPCLINE>
      <FPCLINE>                                       fp_spras &quot;Language Key</FPCLINE>
      <FPCLINE>                              CHANGING lwa_stdtxt.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt-text IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate the value for the P.O. Box</FPCLINE>
      <FPCLINE>      CLEAR lv_value.</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-text</FPCLINE>
      <FPCLINE>                  fp_address-po_box</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-text IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-po_box IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_address-name2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      CONCATENATE lwa_stdtxt-val</FPCLINE>
      <FPCLINE>                  fp_address-name2</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSE. &quot; ELSE -&gt; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lwa_stdtxt-val = fp_address-name2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-name2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate NAME2, NAME3 &amp; NAME4</FPCLINE>
      <FPCLINE>  IF fp_address-name3 IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>     fp_address-name4 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    CONCATENATE fp_address-name3</FPCLINE>
      <FPCLINE>                fp_address-name4</FPCLINE>
      <FPCLINE>           INTO lwa_stdtxt-val</FPCLINE>
      <FPCLINE>                SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF fp_address-name3 IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>         fp_address-name4 IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lwa_stdtxt-val = fp_address-name3.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ELSEIF fp_address-name3 IS INITIAL AND</FPCLINE>
      <FPCLINE>         fp_address-name4 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lwa_stdtxt-val = fp_address-name4.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_address-name3 IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_address-city1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    lwa_stdtxt-val = fp_address-city1.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-city1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_address-region IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate the City with Region</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-val</FPCLINE>
      <FPCLINE>                  fp_address-region</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSE. &quot; ELSE -&gt; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lwa_stdtxt-val = fp_address-region.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-region IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_address-post_code1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE>* Populate the City with Region</FPCLINE>
      <FPCLINE>      CONCATENATE lwa_stdtxt-val</FPCLINE>
      <FPCLINE>                  fp_address-post_code1</FPCLINE>
      <FPCLINE>             INTO lwa_stdtxt-val</FPCLINE>
      <FPCLINE>                  SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSE. &quot; ELSE -&gt; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      lwa_stdtxt-val = fp_address-post_code1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF fp_address-post_code1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF lwa_stdtxt-val IS NOT INITIAL.</FPCLINE>
      <FPCLINE>    APPEND lwa_stdtxt TO fp_i_address.</FPCLINE>
      <FPCLINE>    CLEAR lwa_stdtxt.</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF lwa_stdtxt-val IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_FILL_REMITADDRESS</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_FILL_CUSTOMER</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the Customer details for the Invoice</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_SOCL       Language from EMI Tool</FPCLINE>
      <FPCLINE>*      &lt;--FP_CUSTOMER   Customer details for Invoice (With Ship date)</FPCLINE>
      <FPCLINE>*      &lt;--FP_CUSTOMER1  Customer details for Invoice (Without Ship date)</FPCLINE>
      <FPCLINE>*      &lt;--FP_INVOICE    Invoice number to print</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_fill_customer     USING fp_socl      TYPE ty_socl</FPCLINE>
      <FPCLINE>                      CHANGING fp_customer  TYPE ty_customer</FPCLINE>
      <FPCLINE>                               fp_customer1 TYPE ty_customer</FPCLINE>
      <FPCLINE>                               fp_invoice   TYPE vbeln. &quot; Sales and Distribution Document Number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constants declaration</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_custno  TYPE tdobname VALUE &apos;ZOTC_0014_CUSTNO&apos;  , &quot;Customer number</FPCLINE>
      <FPCLINE>    lc_invnum  TYPE tdobname VALUE &apos;ZOTC_0014_INVNUM&apos;  , &quot;Invoice number</FPCLINE>
      <FPCLINE>    lc_invdt   TYPE tdobname VALUE &apos;ZOTC_0014_INDVDT&apos;  , &quot;Invoice date</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>*    lc_shpdt    TYPE tdobname VALUE &apos;ZOTC_0014_SHPDT&apos;   , &quot;Ship date</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    lc_carrier TYPE tdobname VALUE &apos;ZOTC_0014_CARRIER&apos; , &quot;Carrier</FPCLINE>
      <FPCLINE>    lc_freight TYPE tdobname VALUE &apos;ZOTC_0014_FREIGHT&apos;.  &quot;Freight</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---Begin of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>  CONSTANTS:</FPCLINE>
      <FPCLINE>    lc_invnum1 TYPE tdobname VALUE &apos;ZOTC_0088_INVNUM&apos;,    &quot;Pro Forma Invoice</FPCLINE>
      <FPCLINE>    lc_zf2     TYPE fkart    VALUE &apos;ZF2&apos;,</FPCLINE>
      <FPCLINE>    lc_ziv     TYPE fkart    VALUE &apos;ZIV&apos;,</FPCLINE>
      <FPCLINE>    lc_zf5     TYPE fkart    VALUE &apos;ZF5&apos;.</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declaration</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    lwa_stdtxt  TYPE ty_stdtxt, &quot;Standard Text with values</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    lwa_stdtxt1 TYPE ty_stdtxt. &quot;Standard Text with values</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF fp_customer-kunrg IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_custno    &quot;Customer number Text</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_custno   &quot;Customer number Text</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*    fp_customer-kunrg_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-kunrg_txt    = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>      fp_customer-kunrg_txt+30 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt-text  IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-kunrg_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text  IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt1-text IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-kunrg_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_customer-kunrg IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF fp_customer-vbeln IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_invnum    &quot;Invoice number Text</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*&lt;---Begin of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>*changing the INVOICE NO. --&gt; Order No. and the field value to sales order number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF gv_fkart = lc_zf2 OR</FPCLINE>
      <FPCLINE>         gv_fkart = lc_ziv.  &quot;Billing Type Invoice</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_invnum   &quot;Invoice number Text</FPCLINE>
      <FPCLINE>                                           space       &quot;No colon</FPCLINE>
      <FPCLINE>                                           space       &quot;No value</FPCLINE>
      <FPCLINE>                                           space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang1</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE>      ELSE.</FPCLINE>
      <FPCLINE>        PERFORM f_populate_text_val  USING lc_invnum1   &quot;ProForma Invoice Text</FPCLINE>
      <FPCLINE>                                                space       &quot;No colon</FPCLINE>
      <FPCLINE>                                                space       &quot;No value</FPCLINE>
      <FPCLINE>                                                space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                                fp_socl-lang1</FPCLINE>
      <FPCLINE>                                       CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE>      ENDIF.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---End of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   fp_customer-vbeln_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>    fp_invoice = fp_customer-vbeln.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-vbeln_txt    = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>      fp_customer-vbeln_txt+40 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt-text  IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-vbeln_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text  IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt1-text IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-vbeln_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*&lt;---Begin of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>      IF gv_fkart EQ lc_zf5.   &quot;Billing Type Invoice</FPCLINE>
      <FPCLINE>        fp_customer-vbeln     = gv_vbeln.</FPCLINE>
      <FPCLINE>      ENDIF.</FPCLINE>
      <FPCLINE>*&lt;---End of Insert for D3_OTC_FDD_0088 Defect# 9572 8000020217 by U105235 on 17-May-2019</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_customer-vbeln IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF fp_customer-fkdat IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_invdt     &quot;Ship date Text</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_invdt    &quot;Ship date Text</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   fp_customer-fkdat_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-fkdat_txt    = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>      fp_customer-fkdat_txt+30 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt-text  IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-fkdat_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text  IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt1-text IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-fkdat_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_customer-fkdat IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF fp_customer-name1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_carrier   &quot;Carrier Text</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_carrier  &quot;Carrier Text</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   fp_customer-name1_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-name1_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>      fp_customer-name1_txt+30 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt-text  IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-name1_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text  IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt1-text IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-name1_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_customer-name1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF fp_customer-inco1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE>    IF fp_socl-lang2 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val    USING lc_freight   &quot;Freight</FPCLINE>
      <FPCLINE>                                           space        &quot;No colon</FPCLINE>
      <FPCLINE>                                           space        &quot;No value</FPCLINE>
      <FPCLINE>                                           space        &quot;No currency Key</FPCLINE>
      <FPCLINE>                                           fp_socl-lang2</FPCLINE>
      <FPCLINE>                                  CHANGING lwa_stdtxt1. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang2 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF fp_socl-lang1 IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>      PERFORM f_populate_text_val  USING lc_freight  &quot;Freight</FPCLINE>
      <FPCLINE>                                         space       &quot;No colon</FPCLINE>
      <FPCLINE>                                         space       &quot;No value</FPCLINE>
      <FPCLINE>                                         space       &quot;No currency Key</FPCLINE>
      <FPCLINE>                                         fp_socl-lang1</FPCLINE>
      <FPCLINE>                                CHANGING lwa_stdtxt. &quot;Standard text</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF fp_socl-lang1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*   fp_customer-inco1_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>       lwa_stdtxt-text  IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-inco1_txt    = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE>      fp_customer-inco1_txt+90 = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt-text  IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-inco1_txt = lwa_stdtxt1-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ELSEIF lwa_stdtxt-text  IS NOT INITIAL AND</FPCLINE>
      <FPCLINE>           lwa_stdtxt1-text IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate text</FPCLINE>
      <FPCLINE>      fp_customer-inco1_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF lwa_stdtxt1-text IS NOT INITIAL AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF fp_customer-inco1 IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  CLEAR : lwa_stdtxt,</FPCLINE>
      <FPCLINE>          lwa_stdtxt1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>*  IF fp_customer-lfdat IS NOT INITIAL.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** Populate Standard text and its corresponding values</FPCLINE>
      <FPCLINE>*    PERFORM f_populate_text_val  USING lc_shpdt      &quot;Ship date Text</FPCLINE>
      <FPCLINE>*                                       space         &quot;No colon</FPCLINE>
      <FPCLINE>*                                       space         &quot;No value</FPCLINE>
      <FPCLINE>*                                       space         &quot;No currency Key</FPCLINE>
      <FPCLINE>*                                       fp_socl-lang1 &quot;Language Key</FPCLINE>
      <FPCLINE>*                              CHANGING lwa_stdtxt.   &quot;Standard text</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*    fp_customer-lfdat_txt = lwa_stdtxt-text.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ELSE. &quot; ELSE -&gt; IF fp_customer-lfdat IS NOT INITIAL</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>** If Ship to date is blank then populate this structure</FPCLINE>
      <FPCLINE>*    fp_customer1 = fp_customer.</FPCLINE>
      <FPCLINE>*    CLEAR fp_customer.</FPCLINE>
      <FPCLINE>*</FPCLINE>
      <FPCLINE>*  ENDIF. &quot; IF fp_customer-lfdat IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  fp_customer1 = fp_customer.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#3035/CR_482 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_FILL_CUSTOMER</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_TEXT_VAL</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate Standard Texts and the respective calculated values</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_STDTXT     Standard text</FPCLINE>
      <FPCLINE>*      --&gt;FP_COLON      Punctuation mark</FPCLINE>
      <FPCLINE>*      --&gt;FP_VALUE      Value</FPCLINE>
      <FPCLINE>*      --&gt;FP_CUKY       Currency Key</FPCLINE>
      <FPCLINE>*      --&gt;FP_SPRAS      Language Key</FPCLINE>
      <FPCLINE>*      &lt;--FP_STDTXTVAL  Standard text with value</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_text_val  USING fp_stdtxt    TYPE tdobname   &quot;Name</FPCLINE>
      <FPCLINE>                                fp_colon     TYPE char1      &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                                fp_value     TYPE any        &quot;Value</FPCLINE>
      <FPCLINE>                                fp_cuky      TYPE char7      &quot;Currency Key</FPCLINE>
      <FPCLINE>                                fp_spras     TYPE spras      &quot;Language Key</FPCLINE>
      <FPCLINE>                       CHANGING fp_stdtxtval TYPE ty_stdtxt. &quot;Standard Text values</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constant declarations</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_id  TYPE tdid      VALUE &apos;ST&apos;  , &quot;Text ID</FPCLINE>
      <FPCLINE>    lc_obj TYPE tdobject  VALUE &apos;TEXT&apos;. &quot;Texts: application object</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declarations</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    li_lines      TYPE tlinet, &quot;Lines read from text element</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE>    li_text_lines TYPE STANDARD TABLE OF char30000, &quot; Text_lines</FPCLINE>
      <FPCLINE>    lwa_lines     TYPE tline.                       &quot;Lines read from text element</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_lines&gt;      TYPE tline, &quot;Lines read from text element</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE>    &lt;lfs_text_lines&gt; TYPE char30000. &quot; Text_line of type CHAR30000</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Get the Standard text</FPCLINE>
      <FPCLINE>  CALL FUNCTION &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>    EXPORTING</FPCLINE>
      <FPCLINE>      id                      = lc_id</FPCLINE>
      <FPCLINE>      language                = fp_spras</FPCLINE>
      <FPCLINE>      name                    = fp_stdtxt</FPCLINE>
      <FPCLINE>      object                  = lc_obj</FPCLINE>
      <FPCLINE>    TABLES</FPCLINE>
      <FPCLINE>      lines                   = li_lines</FPCLINE>
      <FPCLINE>    EXCEPTIONS</FPCLINE>
      <FPCLINE>      id                      = 1</FPCLINE>
      <FPCLINE>      language                = 2</FPCLINE>
      <FPCLINE>      name                    = 3</FPCLINE>
      <FPCLINE>      not_found               = 4</FPCLINE>
      <FPCLINE>      object                  = 5</FPCLINE>
      <FPCLINE>      reference_check         = 6</FPCLINE>
      <FPCLINE>      wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>      OTHERS                  = 8.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Calling FM to convert the text line table data into string</FPCLINE>
      <FPCLINE>    CALL FUNCTION &apos;CONVERT_ITF_TO_STREAM_TEXT&apos;</FPCLINE>
      <FPCLINE>      EXPORTING</FPCLINE>
      <FPCLINE>        language    = fp_spras</FPCLINE>
      <FPCLINE>        lf          = &apos; &apos;</FPCLINE>
      <FPCLINE>      TABLES</FPCLINE>
      <FPCLINE>        itf_text    = li_lines       &quot;Text line data</FPCLINE>
      <FPCLINE>        text_stream = li_text_lines. &quot;String format</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF sy-subrc EQ 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>** Read the first line for the maintained text</FPCLINE>
      <FPCLINE>*    READ TABLE li_lines</FPCLINE>
      <FPCLINE>*     ASSIGNING &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE>*         INDEX 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      READ TABLE li_text_lines</FPCLINE>
      <FPCLINE>       ASSIGNING &lt;lfs_text_lines&gt;</FPCLINE>
      <FPCLINE>           INDEX 1.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF &lt;lfs_text_lines&gt; IS ASSIGNED.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ASSIGN lwa_lines TO &lt;lfs_lines&gt;.</FPCLINE>
      <FPCLINE>        &lt;lfs_lines&gt;-tdline = &lt;lfs_text_lines&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Concatenate the colon value and make it right justified</FPCLINE>
      <FPCLINE>        fp_stdtxtval-text = &lt;lfs_lines&gt;-tdline.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        IF fp_cuky IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Populate the Total value with Currency Key</FPCLINE>
      <FPCLINE>          CONCATENATE fp_stdtxtval-text</FPCLINE>
      <FPCLINE>                      fp_cuky</FPCLINE>
      <FPCLINE>                 INTO fp_stdtxtval-text</FPCLINE>
      <FPCLINE>                      SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ELSE. &quot; ELSE -&gt; IF fp_cuky IS NOT INITIAL</FPCLINE>
      <FPCLINE>* Add the colon sign</FPCLINE>
      <FPCLINE>          CONCATENATE fp_stdtxtval-text</FPCLINE>
      <FPCLINE>                      fp_colon &quot;Value - &apos;:&apos;</FPCLINE>
      <FPCLINE>                 INTO fp_stdtxtval-text</FPCLINE>
      <FPCLINE>                      SEPARATED BY space.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        ENDIF. &quot; IF fp_cuky IS NOT INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        fp_stdtxtval-val  = fp_value.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF &lt;lfs_text_lines&gt; IS ASSIGNED</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc EQ 0</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  UNASSIGN &lt;lfs_lines&gt;.</FPCLINE>
      <FPCLINE>  CLEAR li_lines.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_TEXT_VAL</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_POPULATE_TEXT_VAL2</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate Standard Texts and the respective calculated values</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_STDTXT    Standard text</FPCLINE>
      <FPCLINE>*      --&gt;FP_ID        Text ID</FPCLINE>
      <FPCLINE>*      --&gt;FP_OBJ       Application Object</FPCLINE>
      <FPCLINE>*      --&gt;FP_SPRAS     Language Key</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_LINES   Final total table</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_populate_text_val2  USING fp_stdtxt   TYPE tdobname    &quot;Name</FPCLINE>
      <FPCLINE>                                 fp_id       TYPE tdid        &quot;Text ID</FPCLINE>
      <FPCLINE>                                 fp_obj      TYPE tdobject    &quot;Application object</FPCLINE>
      <FPCLINE>                                 fp_spras    TYPE spras       &quot;Message Status</FPCLINE>
      <FPCLINE>                        CHANGING fp_i_lines  TYPE ty_t_lines. &quot;Standard texts</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Local data declarations</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    li_lines      TYPE tlinet   , &quot;Lines read from text element</FPCLINE>
      <FPCLINE>    lwa_lines     TYPE ty_lines , &quot;Standard texts</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE>    li_text_lines TYPE STANDARD TABLE OF char30000. &quot; Text_lines</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_lines&gt;      TYPE tline, &quot;Lines read from text element</FPCLINE>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE>    &lt;lfs_text_lines&gt; TYPE char30000. &quot; Text_line of type CHAR30000</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#5683 by ADEY</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Get the Standard text</FPCLINE>
      <FPCLINE>  CALL FUNCTION &apos;READ_TEXT&apos;</FPCLINE>
      <FPCLINE>    EXPORTING</FPCLINE>
      <FPCLINE>      id                      = fp_id    &quot;Value - Invoice number</FPCLINE>
      <FPCLINE>      language                = fp_spras &quot;Language Key</FPCLINE>
      <FPCLINE>      name                    = fp_stdtxt</FPCLINE>
      <FPCLINE>      object                  = fp_obj   &quot;Value - &apos;VBBK&apos;(Header)/&apos;VBBP&apos;(Line Item)</FPCLINE>
      <FPCLINE>    TABLES</FPCLINE>
      <FPCLINE>      lines                   = li_lines</FPCLINE>
      <FPCLINE>    EXCEPTIONS</FPCLINE>
      <FPCLINE>      id                      = 1</FPCLINE>
      <FPCLINE>      language                = 2</FPCLINE>
      <FPCLINE>      name                    = 3</FPCLINE>
      <FPCLINE>      not_found               = 4</FPCLINE>
      <FPCLINE>      object                  = 5</FPCLINE>
      <FPCLINE>      reference_check         = 6</FPCLINE>
      <FPCLINE>      wrong_access_to_archive = 7</FPCLINE>
      <FPCLINE>      OTHERS                  = 8.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF sy-subrc = 0.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    &quot;Consolidate the errors into the message body:</FPCLINE>
      <FPCLINE>    LOOP AT li_lines ASSIGNING &lt;lfs_lines&gt;.</FPCLINE>
      <FPCLINE>      lwa_lines-tdline = &lt;lfs_lines&gt;-tdline.</FPCLINE>
      <FPCLINE>      APPEND lwa_lines TO fp_i_lines.</FPCLINE>
      <FPCLINE>    ENDLOOP. &quot; LOOP AT li_lines ASSIGNING &lt;lfs_lines&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc = 0</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  UNASSIGN &lt;lfs_lines&gt;.</FPCLINE>
      <FPCLINE>  CLEAR li_lines.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_POPULATE_TEXT_VAL2</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_GET_ADVANCE_PAYMENT</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Determine the paid down payments based of FI documents.        *</FPCLINE>
      <FPCLINE>*       This documents are down payments assigned to the sales         *</FPCLINE>
      <FPCLINE>*       document.                                                      *</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_INVOICE   Invoice header details</FPCLINE>
      <FPCLINE>*      --&gt;FP_VGBEL     Reference document number</FPCLINE>
      <FPCLINE>*      &lt;--FP_ADVPMT    Advance payment amount</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_get_advance_payment  USING fp_invoice TYPE vbdkr  &quot;Invoice details</FPCLINE>
      <FPCLINE>                                  fp_vgbel   TYPE vgbel  &quot;Document number of the reference document</FPCLINE>
      <FPCLINE>                         CHANGING fp_advpmt  TYPE wrbtr. &quot;Rate (condition amount or percentage)</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local constant declarations</FPCLINE>
      <FPCLINE>  CONSTANTS :</FPCLINE>
      <FPCLINE>    lc_debit  TYPE shkzg  VALUE &apos;S&apos;. &quot;Value is +ve</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declarations</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    li_bsid TYPE trty_bsid, &quot;Accounting: Secondary Index for Customers</FPCLINE>
      <FPCLINE>    li_bsad TYPE tt_bsad.   &quot;Accounting: Secondary Index for Customers (Cleared Items)</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lfs_bsad&gt; TYPE bsad. &quot;Payments to be cleared</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>  IF fp_invoice-bukrs IS NOT INITIAL AND &quot; Company Code</FPCLINE>
      <FPCLINE>     fp_invoice-kunrg IS NOT INITIAL AND &quot; Payer</FPCLINE>
      <FPCLINE>     fp_vgbel         IS NOT INITIAL.    &quot; Reference Document number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Read the payment transactions for a sales order</FPCLINE>
      <FPCLINE>    CALL FUNCTION &apos;SD_ACC_DOWNPAYMENT_READ&apos;</FPCLINE>
      <FPCLINE>      EXPORTING</FPCLINE>
      <FPCLINE>        i_bukrs  = fp_invoice-bukrs</FPCLINE>
      <FPCLINE>        i_kunnr  = fp_invoice-kunrg</FPCLINE>
      <FPCLINE>        i_vbel2  = fp_vgbel</FPCLINE>
      <FPCLINE>      TABLES</FPCLINE>
      <FPCLINE>        t_bsid   = li_bsid</FPCLINE>
      <FPCLINE>        t_bsad   = li_bsad</FPCLINE>
      <FPCLINE>      EXCEPTIONS</FPCLINE>
      <FPCLINE>        no_entry = 1</FPCLINE>
      <FPCLINE>        OTHERS   = 2.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    IF sy-subrc = 0 AND</FPCLINE>
      <FPCLINE>       li_bsad[] IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      LOOP AT li_bsad ASSIGNING &lt;lfs_bsad&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Calculation will be based on the Debit/Credit Indicator</FPCLINE>
      <FPCLINE>        IF &lt;lfs_bsad&gt;-shkzg EQ lc_debit. &quot;Value - &apos;S&apos;</FPCLINE>
      <FPCLINE>          fp_advpmt = fp_advpmt + &lt;lfs_bsad&gt;-wrbtr.</FPCLINE>
      <FPCLINE>        ELSE. &quot; ELSE -&gt; IF sy-subrc = 0 AND</FPCLINE>
      <FPCLINE>          fp_advpmt = fp_advpmt - &lt;lfs_bsad&gt;-wrbtr.</FPCLINE>
      <FPCLINE>        ENDIF. &quot; LOOP AT li_bsad ASSIGNING &lt;lfs_bsad&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      ENDLOOP. &quot; IF sy-subrc = 0 AND</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDIF. &quot; IF sy-subrc = 0 AND</FPCLINE>
      <FPCLINE>  ENDIF. &quot; Check Company code, Payer and Sales Order number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_GET_ADVANCE_PAYMENT</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* ---&gt; Begin of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*&amp;      Form  F_BILLING_PLAN_DATES</FPCLINE>
      <FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*       Populate the Billing plan dates</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>*      --&gt;FP_ITEM_DETAIL  Item Detail for Print</FPCLINE>
      <FPCLINE>*      --&gt;FP_HEAD_DETAIL  Header Details for Print</FPCLINE>
      <FPCLINE>*      --&gt;FP_MTPOS        Item category group from material master</FPCLINE>
      <FPCLINE>*      &lt;--FP_I_FPLT       Billing plan dates</FPCLINE>
      <FPCLINE>*----------------------------------------------------------------------*</FPCLINE>
      <FPCLINE>FORM f_billing_plan_dates    USING fp_item_detail</FPCLINE>
      <FPCLINE>                              TYPE invoice_t_prt_item_detail      &quot; Item Detail for Print</FPCLINE>
      <FPCLINE>                                   fp_head_detail</FPCLINE>
      <FPCLINE>                              TYPE invoice_s_prt_head_detail      &quot; Header Details for Print</FPCLINE>
      <FPCLINE>                                   fp_mtpos       TYPE mtpos      &quot; Item category group from material master</FPCLINE>
      <FPCLINE>                          CHANGING fp_i_fplt      TYPE ty_t_fplt. &quot;Billing plan dates</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local data declarations</FPCLINE>
      <FPCLINE>  DATA :</FPCLINE>
      <FPCLINE>    li_mvke TYPE ty_t_mvke                , &quot;Sales Data for Material</FPCLINE>
      <FPCLINE>    li_item TYPE invoice_t_prt_item_detail. &quot;Item Detail for Print</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Local field symbols</FPCLINE>
      <FPCLINE>  FIELD-SYMBOLS :</FPCLINE>
      <FPCLINE>    &lt;lwa_item_detail&gt; TYPE invoice_s_prt_item_detail. &quot;Items Detail for PDF Print</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>* Fetch the Sales Data for Material</FPCLINE>
      <FPCLINE>  SELECT matnr                              &quot;Material Number</FPCLINE>
      <FPCLINE>    FROM mvke                               &quot;Sales Data for Material</FPCLINE>
      <FPCLINE>    INTO TABLE li_mvke</FPCLINE>
      <FPCLINE>     FOR ALL ENTRIES IN fp_item_detail</FPCLINE>
      <FPCLINE>   WHERE matnr = fp_item_detail-vbdpr-matnr &quot;Material Number</FPCLINE>
      <FPCLINE>     AND vkorg = fp_head_detail-vbdkr-vkorg &quot;Sales Organization</FPCLINE>
      <FPCLINE>     AND vtweg = fp_head_detail-vbdkr-vtweg &quot;Distribution Channel</FPCLINE>
      <FPCLINE>     AND mtpos = fp_mtpos.                  &quot;Item category group - &apos;ZPLN&apos;</FPCLINE>
      <FPCLINE/>
      <FPCLINE>  IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Sort and delete duplicate records</FPCLINE>
      <FPCLINE>    SORT li_mvke BY matnr. &quot; Material Number</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    LOOP AT fp_item_detail ASSIGNING &lt;lwa_item_detail&gt;.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the value for Material number with Item category as &apos;ZPLN&apos;</FPCLINE>
      <FPCLINE>      READ TABLE li_mvke</FPCLINE>
      <FPCLINE>        WITH KEY matnr = &lt;lwa_item_detail&gt;-vbdpr-matnr &quot;Material Number</FPCLINE>
      <FPCLINE>                 TRANSPORTING NO FIELDS.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE>        APPEND &lt;lwa_item_detail&gt; TO li_item.</FPCLINE>
      <FPCLINE>      ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>    ENDLOOP. &quot; LOOP AT fp_item_detail ASSIGNING &lt;lwa_item_detail&gt;</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>    IF li_item[] IS NOT INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Fetch the Billing Plan: Dates</FPCLINE>
      <FPCLINE>      SELECT fplnr                        &quot; Billing plan number / invoicing plan number</FPCLINE>
      <FPCLINE>             fpltr                        &quot; Item for billing plan/invoice plan/payment cards</FPCLINE>
      <FPCLINE>             fkdat                        &quot; Settlement date for deadline</FPCLINE>
      <FPCLINE>             nfdat                        &quot; Settlement date for deadline</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        FROM fplt                         &quot; Billing Plan: Dates</FPCLINE>
      <FPCLINE>        INTO TABLE fp_i_fplt</FPCLINE>
      <FPCLINE>         FOR ALL ENTRIES IN li_item</FPCLINE>
      <FPCLINE>       WHERE fplnr = li_item-vbdpr-fplnr  &quot; Billing plan number / invoicing plan number</FPCLINE>
      <FPCLINE>         AND fpltr = li_item-vbdpr-fpltr. &quot; Item for billing plan/invoice plan/payment cards</FPCLINE>
      <FPCLINE/>
      <FPCLINE>      IF sy-subrc IS INITIAL.</FPCLINE>
      <FPCLINE/>
      <FPCLINE>* Sort and delete duplicate records</FPCLINE>
      <FPCLINE>        SORT fp_i_fplt BY fplnr  &quot; Billing plan number / invoicing plan number</FPCLINE>
      <FPCLINE>                          fpltr. &quot; Item for billing plan/invoice plan/payment cards</FPCLINE>
      <FPCLINE/>
      <FPCLINE>        DELETE ADJACENT DUPLICATES FROM fp_i_fplt</FPCLINE>
      <FPCLINE>                              COMPARING fplnr  &quot; Billing plan number / invoicing plan number</FPCLINE>
      <FPCLINE>                                        fpltr. &quot; Item for billing plan/invoice plan/payment cards</FPCLINE>
      <FPCLINE/>
      <FPCLINE/>
      <FPCLINE>      ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE>    ENDIF. &quot; IF li_item[] IS NOT INITIAL</FPCLINE>
      <FPCLINE>  ENDIF. &quot; IF sy-subrc IS INITIAL</FPCLINE>
      <FPCLINE/>
      <FPCLINE>ENDFORM. &quot; F_BILLING_PLAN_DATES</FPCLINE>
      <FPCLINE>* &lt;--- End of Change for D2_OTC_FDD_0014_Defect#2022/CR_337 by ADEY</FPCLINE>
     </FORMS>
    </CL_FP_CODING>
   </cls:CL_FP_CODING>
  </asx:heap>
 </asx:abap>
</abapGit>
